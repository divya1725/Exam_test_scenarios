<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="07519c4d-db1b-4ebd-a267-3a49cfcbcc73" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="ReadMe" searchProperties="true" timeout="0" disabled="true" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="94ac8a4c-da84-43fa-8c2a-12275842a0bafileName">ReadMe</con:setting>
    <con:setting id="c23db17d-e291-43c1-8b9b-d4494f693406fileName">ReadMe</con:setting>
    <con:setting id="6bd0cb77-d574-4ff0-a4b6-f858c2d3661dfileName">ReadMe</con:setting>
    <con:setting id="07519c4d-db1b-4ebd-a267-3a49cfcbcc73fileName">ReadMe</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="groovy" name="Set_Environment" id="640bebaa-f910-4035-bb09-8020afd7f62a">
    <con:settings/>
    <con:config>
      <script>import groovy.sql.Sql;
import groovy.transform.Field;
//def array =activeEnviroment.sizeOfDatabaseConnectionArray()
//log.info(array)
def DbConnections = testRunner.getTestCase().getTestSuite().getProject().getDatabaseConnectionContainer().getConfig()
//def arr =    activeEnviroment.getDatabaseConnectionList()
def DbConnectionsarr = DbConnections.getDatabaseConnectionList()
log.info(  DbConnectionsarr.connectionString)
log.info(DbConnectionsarr)
def ActiveEnvName= testRunner.getTestCase().getTestSuite().getProject().getActiveEnvironmentName()
log.info(ActiveEnvName)
//@Field   activeDbConnection
if (ActiveEnvName== "G-D4 Functional")
{
activeDbConnection = Sql.newInstance("jdbc:oracle:thin:@//10.246.89.97:1530/pen_g_functional", "pendata", "pen", "oracle.jdbc.driver.OracleDriver");
def ConnectionString = "jdbc:oracle:thin:pendata/pen@//10.246.89.97:1530/pen_g_functional";
 ConnectionString = testRunner.testCase.setPropertyValue('ConnectionString', ConnectionString)
}
if (ActiveEnvName=="G-S1 System Test")
{
activeDbConnection = Sql.newInstance("jdbc:oracle:thin:@//10.246.89.97:1530/pwh_g_st", "pwhdata", "pwh", "oracle.jdbc.driver.OracleDriver");
def ConnectionString = "jdbc:oracle:thin:PWHDATA/pwh@//10.246.89.97:1530/pwh_g_st";
 ConnectionString = testRunner.testCase.setPropertyValue('ConnectionString', ConnectionString)
}
if (ActiveEnvName=="G-D6 Sprint")
{
activeDbConnection = Sql.newInstance("jdbc:oracle:thin:@10.246.89.97:1530/pwh_g_d6", "pwhdata", "pwh", "oracle.jdbc.driver.OracleDriver");
def ConnectionString = "jdbc:oracle:thin:pwhdata/pwh@10.246.89.97:1530/pwh_g_d6";
 ConnectionString = testRunner.testCase.setPropertyValue('ConnectionString', ConnectionString)
}
if (ActiveEnvName=="G-D2 Sprint")
{
activeDbConnection = Sql.newInstance("jdbc:oracle:thin:@10.246.89.97:1530/pen_g_sprint", "pendata", "pen", "oracle.jdbc.driver.OracleDriver");
def ConnectionString = "jdbc:oracle:thin:pendata/pen@10.246.89.97:1530/pen_g_sprint";
 ConnectionString = testRunner.testCase.setPropertyValue('ConnectionString', ConnectionString)
}</script>
    </con:config>
  </con:testStep>
  <con:testStep type="manualTestStep" name="Help" id="b3dd0c37-9a0e-4782-8939-669e9777936a">
    <con:description>1. This test suite is designed to test all ISPC,
- Create, Confirm, Read,Approve,Search, Update,
2. Test cases name should be ispc name, against which assertions are written in Create/update.
3. File payment are created from SOAP look at charge engine cases, when payment cannot be created from SOAP service.
4. At the end there are disabled test cases where some ISPCs are future ,
5. Prepaid ispc - Has to be modified to work in restricted with correct data, Test case "PAYCTDOMOUPREP_prepaid_restricted"
6. If you are adding new account for any reason, Make sure you added in Auth request as well.
7. Each date field must be not be hard coded, It should take value from GenerateDate script, For more info see requestedexecutiondate property on test suite level.

How to test : {Test suite designed for BM}
- Change envs endpoint on project level,
- Set all properties at test suite level, Very important!!, as per your test env data, PBD agreement,
- Create all payment, Keep eye on requested execution date, Ideally it should be next day, else in some cases, PIN will call online reservaiton from status update which 
makes test case failure..
- Run duedate batch, Make sure that payment gets completed in value chain.
- Run historic search if needed(not included as part of this suite)

How to change test suite to bank employee or PM?.
- Just change header items with proper values. Run test suite.

Adding new case/ISPC: 
Clone one of the test case, Change name and test case description.. Modify test steps.</con:description>
    <con:settings/>
    <con:config xsi:type="con:ManualTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
  </con:testStep>
  <con:testStep type="request" id="402e3be2-5971-4e69-ad9f-954ff8cc3027" name="ReservationCreate">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PCASReservationCreate_V1_0ServiceSoapBinding</con:interface>
      <con:operation>pCASReservationCreate_V1_0</con:operation>
      <con:request name="ReservationCreate" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="b1f2a28b-5353-4340-a648-c23c261391f8">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://10.246.89.245:13610/fts/services/PCASReservationCreate_V1_0Service</con:endpoint>
        <con:request><![CDATA[<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Header>
      <ns2:AutHeader xmlns:ns2="http://edb.com/ws/WSCommon_v21" xmlns="http://reservations.ws.pca.finance.edb.com">
         <ns2:SourceApplication>PAY</ns2:SourceApplication>
         <ns2:DestinationApplication>PCL</ns2:DestinationApplication>
         <ns2:Function/>
         <ns2:Version/>
         <ns2:ClientContext>
            <ns2:userid>SYSTEM</ns2:userid>
            <ns2:credentials/>
            <ns2:channel>BRA</ns2:channel>
            <ns2:orgid>4201</ns2:orgid>
            <ns2:orgunit xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <ns2:customerid xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <ns2:locale xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <ns2:ip>123.123.123.123</ns2:ip>
            <ns2:item key="ContextInitializedBy" value="MANUALLY"/>
         </ns2:ClientContext>
      </ns2:AutHeader>
   </soap:Header>
   <soap:Body>
      <PCASReservationCreate_V1_0InputArgs xmlns="http://reservations.ws.pca.finance.edb.com" xmlns:ns2="http://edb.com/ws/WSCommon_v21">
         <ReservationCreateQualification_V1_0>
            <AccountNo>${#TestSuite#debitAccount}</AccountNo>
            <CounterAccountNo xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <Amount>100000</Amount>
            <AmountCurrency>NOK</AmountCurrency>
            <AuthRef>36669</AuthRef>
            <TextCode>950</TextCode>
            <FinInst xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <Force>true</Force>
            <CheckDuplicate>true</CheckDuplicate>
         </ReservationCreateQualification_V1_0>
      </PCASReservationCreate_V1_0InputArgs>
   </soap:Body>
</soap:Envelope>]]></con:request>
        <con:assertion type="Valid HTTP Status Codes" id="a31462ef-abc5-4d85-b48e-20c1b5f7382a" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="SOAP Fault Assertion" id="f25fd96c-670a-493e-a367-2a250ba630d2" name="Not SOAP Fault"/>
        <con:assertion type="Schema Compliance" id="249f2f34-5ada-4935-bacf-e3472439ba40" name="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508" action="pCASReservationCreate_V1_0"/>
        <con:wsrmConfig version="1.2"/>
        <con:environmentSpec>
          <con:entry environmentId="b08c868c-3907-4c57-ab25-2cc60fb2b3af">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:request>
    </con:config>
  </con:testStep>
  <con:properties>
    <con:property>
      <con:name>ConnectionString</con:name>
      <con:value>jdbc:oracle:thin:pendata/pen@//10.246.89.97:1530/pen_g_functional</con:value>
    </con:property>
  </con:properties>
  <con:reportParameters/>
  <con:environmentSpec>
    <con:entry environmentId="0dc5b557-c01a-409a-8032-9893427fc50d">
      <con:authProfile>Inherit From Parent</con:authProfile>
    </con:entry>
  </con:environmentSpec>
</con:testCase>
