<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="f92607c7-e730-407f-9a2f-7758c7bdb838" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="BankUser_PIDOM-7270_PINSPaymentSearch_V2_0" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="f92607c7-e730-407f-9a2f-7758c7bdb838fileName">BankUser_PIDOM-7270_PINSPaymentSearch_V2_0</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="request" id="8d501eec-8e3e-47d1-af2e-c97520a64ff4" name="AccountSearch">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentSearch_V2_0PortTypeSoap11</con:interface>
      <con:operation>PaymentAccountSearch</con:operation>
      <con:request name="AccountSearch" id="c2f93451-462b-4e2b-ab6e-b298057aac19">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://ald-eos-g-app02.man.cosng.net:22411/pin/services/PINSPaymentSearch_V2_0</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentsearch:v2_0" xmlns:urn1="urn:pins.payment.evry.com:domain:search:v2_0" xmlns:urn2="urn:pins.payment.evry.com:domain:common:v2_0" xmlns:urn3="urn:pins.payment.evry.com:domain:complex-types:v2_0">
   <soapenv:Header>
     <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SorceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PaymentCreate</wsc:Function>
         <wsc:Version>1.9</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#UserID}</wsc:userid>
            <wsc:credentials>03110012010400425kglPboRi3h1Z4YUjUpQ0UB65Ta2kPKj1KWwkWemtrL+SoWqMxx/KuqxUVbNyTu6DsSaabKNt2t+xJppso23a37EmmmyjbdrffJeRiGWfHDGwxCWOpDYc2jgSxAz1+8eEsSaabKNt2t/XzlyjxYnxhcG46wcbIKp/sSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu2xJppso23a37Emmmyjbdrf8wP73CNrvpw=apG4tU0NraPbbqKUp39erKDFa7xy6z+r4VDMr/6qBlkFniGaNeDXv4cZcZZQQI6JtwB3JYQk6WqLA7oyp1FWRM6n46ehgNmHVNly8fTnQbIuGJSF2LUyGI7aE92/dgtp8jv9bsGpNe58K+xb4LeIHwjb2nVVvt4/2oLtDQ8IPJE=</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#BankID}</wsc:orgid>
            <!--Optional:-->
            <wsc:orgunit>${#TestSuite#BankID}</wsc:orgunit>
            <!--Optional:-->
            <wsc:customerid xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <!--Optional:-->
            <wsc:locale>NO</wsc:locale>
            <wsc:ip>${#TestSuite#Fraud_IP}</wsc:ip>
            <!--Zero or more repetitions:-->
            <wsc:item key="${#TestSuite#Item1}" value="${#TestSuite#Value1}"/>
            <wsc:item key="${#TestSuite#Item2}" value="${#TestSuite#Value2}"/>
            <wsc:item key="${#TestSuite#Item3}" value="${#TestSuite#Value3}"/>
            <wsc:item key="${#TestSuite#Item4}" value="${#TestSuite#Value4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:PaymentAccountSearchRequest>
         <urn:searchCriteria>
            <urn1:commonCriteria>
               <urn1:elementControl>
                  <urn2:StartIndex>0</urn2:StartIndex>
                  <urn2:MaximumNumberOfElements>100</urn2:MaximumNumberOfElements>
               </urn1:elementControl>
               <urn1:debtorAccount>44760170973</urn1:debtorAccount>
               <!--Zero or more repetitions:-->
               <!--Optional:-->
               <!--Optional:-->
            </urn1:commonCriteria>
            <urn1:accountCriteria>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn1:showHidden>false</urn1:showHidden>
               <!--Zero or more repetitions:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn1:paymentStatus>TO_BE_APPROVED</urn1:paymentStatus>
               <urn1:paymentStatus>READY_FOR_DUE_DATE</urn1:paymentStatus>
               <urn1:paymentStatus>PROCESSING</urn1:paymentStatus>
               <urn1:paymentStatus>STOPPED</urn1:paymentStatus>
               <urn1:paymentStatus>REJECTED</urn1:paymentStatus>
               <urn1:paymentStatus>TO_BE_VERIFIED</urn1:paymentStatus>
               <urn1:sourceRegister>PWH</urn1:sourceRegister>
               <!--Optional:-->
            </urn1:accountCriteria>
         </urn:searchCriteria>
      </urn:PaymentAccountSearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="SOAP Fault Assertion" id="17e86818-a787-4b08-82d2-4685c6634250" name="Not SOAP Fault"/>
        <con:assertion type="GroovyScriptAssertion" id="360e0c50-9b5f-4644-a749-0a6100ec0d88" name="Script Assertion">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig action="urn:pins.payment.evry.com:ws:paymentsearch:v2_0/PINSPaymentSearch_V2_0PortType/PaymentAccountSearchRequest" mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="8673675b-077f-4af9-8526-b1c41e4245cf" name="MessageSearch">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentSearch_V2_0PortTypeSoap11</con:interface>
      <con:operation>PaymentMessageSearch</con:operation>
      <con:request name="MessageSearch" id="42d6d574-b473-40c1-a310-e6264b45c2de">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://ald-eos-g-app02.man.cosng.net:22411/pin/services/PINSPaymentSearch_V2_0</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentsearch:v2_0" xmlns:urn1="urn:pins.payment.evry.com:domain:search:v2_0" xmlns:urn2="urn:pins.payment.evry.com:domain:common:v2_0" xmlns:urn3="urn:pins.payment.evry.com:domain:complex-types:v2_0">
   <soapenv:Header>
     <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SorceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PaymentCreate</wsc:Function>
         <wsc:Version>1.9</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#UserID}</wsc:userid>
            <wsc:credentials>03110012010400425kglPboRi3h1Z4YUjUpQ0UB65Ta2kPKj1KWwkWemtrL+SoWqMxx/KuqxUVbNyTu6DsSaabKNt2t+xJppso23a37EmmmyjbdrffJeRiGWfHDGwxCWOpDYc2jgSxAz1+8eEsSaabKNt2t/XzlyjxYnxhcG46wcbIKp/sSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu2xJppso23a37Emmmyjbdrf8wP73CNrvpw=apG4tU0NraPbbqKUp39erKDFa7xy6z+r4VDMr/6qBlkFniGaNeDXv4cZcZZQQI6JtwB3JYQk6WqLA7oyp1FWRM6n46ehgNmHVNly8fTnQbIuGJSF2LUyGI7aE92/dgtp8jv9bsGpNe58K+xb4LeIHwjb2nVVvt4/2oLtDQ8IPJE=</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#BankID}</wsc:orgid>
            <!--Optional:-->
            <wsc:orgunit>${#TestSuite#BankID}</wsc:orgunit>
            <!--Optional:-->
            <wsc:customerid xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <!--Optional:-->
            <wsc:locale>NO</wsc:locale>
            <wsc:ip>${#TestSuite#Fraud_IP}</wsc:ip>
            <!--Zero or more repetitions:-->
            <wsc:item key="${#TestSuite#Item1}" value="${#TestSuite#Value1}"/>
            <wsc:item key="${#TestSuite#Item2}" value="${#TestSuite#Value2}"/>
            <wsc:item key="${#TestSuite#Item3}" value="${#TestSuite#Value3}"/>
            <wsc:item key="${#TestSuite#Item4}" value="${#TestSuite#Value4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:PaymentMessageSearchRequest>
         <urn:searchCriteria>
            <urn1:commonCriteria>
               <urn1:elementControl>
                  <urn2:StartIndex>0</urn2:StartIndex>
                  <urn2:MaximumNumberOfElements>100</urn2:MaximumNumberOfElements>
               </urn1:elementControl>
               <!--Zero or more repetitions:-->
               <!--Optional:-->
               <urn1:debtorAccount>44760170973</urn1:debtorAccount>
               <!--Optional:-->
            </urn1:commonCriteria>
            <urn1:messageCriteria>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn1:showHidden>false</urn1:showHidden>
               <!--Zero or more repetitions:-->
               <!--Zero or more repetitions:-->
               <!--Optional:-->
               <urn1:paymentStatus>TO_BE_APPROVED</urn1:paymentStatus>
               <urn1:paymentStatus>READY_FOR_DUE_DATE</urn1:paymentStatus>
               <urn1:paymentStatus>PROCESSING</urn1:paymentStatus>
               <urn1:paymentStatus>STOPPED</urn1:paymentStatus>
               <urn1:paymentStatus>REJECTED</urn1:paymentStatus>
               <urn1:paymentStatus>TO_BE_VERIFIED</urn1:paymentStatus>
               <urn1:requestedExecutionDate>
                  <!--You have a CHOICE of the next 2 items at this level-->
                  <!--Optional:-->
                  <!--Optional:-->
               </urn1:requestedExecutionDate>
               <!--Optional:-->
               <!--Optional:-->
               <urn1:sourceRegister>PWH</urn1:sourceRegister>
               <!--Optional:-->
            </urn1:messageCriteria>
         </urn:searchCriteria>
      </urn:PaymentMessageSearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="SOAP Fault Assertion" id="197819a2-ff5b-4441-a52e-c78df7d13959" name="Not SOAP Fault"/>
        <con:assertion type="GroovyScriptAssertion" id="6b0918ff-02e4-4470-b2d5-d67ff8fb4b8b" name="Script Assertion">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig action="urn:pins.payment.evry.com:ws:paymentsearch:v2_0/PINSPaymentSearch_V2_0PortType/PaymentMessageSearchRequest" mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="d5bea9c3-fb9e-49dd-927d-cba26eaec832" name="PaymentInfoSearch">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentSearch_V2_0PortTypeSoap11</con:interface>
      <con:operation>PaymentPaymentInfoSearch</con:operation>
      <con:request name="PaymentInfoSearch" id="da11c349-2190-4f2e-afdb-45fcb43f855e">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://ald-eos-g-app02.man.cosng.net:22411/pin/services/PINSPaymentSearch_V2_0</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentsearch:v2_0" xmlns:urn1="urn:pins.payment.evry.com:domain:search:v2_0" xmlns:urn2="urn:pins.payment.evry.com:domain:common:v2_0" xmlns:urn3="urn:pins.payment.evry.com:domain:complex-types:v2_0">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SorceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PaymentCreate</wsc:Function>
         <wsc:Version>1.9</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#UserID}</wsc:userid>
            <wsc:credentials>03110012010400425kglPboRi3h1Z4YUjUpQ0UB65Ta2kPKj1KWwkWemtrL+SoWqMxx/KuqxUVbNyTu6DsSaabKNt2t+xJppso23a37EmmmyjbdrffJeRiGWfHDGwxCWOpDYc2jgSxAz1+8eEsSaabKNt2t/XzlyjxYnxhcG46wcbIKp/sSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu2xJppso23a37Emmmyjbdrf8wP73CNrvpw=apG4tU0NraPbbqKUp39erKDFa7xy6z+r4VDMr/6qBlkFniGaNeDXv4cZcZZQQI6JtwB3JYQk6WqLA7oyp1FWRM6n46ehgNmHVNly8fTnQbIuGJSF2LUyGI7aE92/dgtp8jv9bsGpNe58K+xb4LeIHwjb2nVVvt4/2oLtDQ8IPJE=</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#BankID}</wsc:orgid>
            <!--Optional:-->
            <wsc:orgunit>${#TestSuite#BankID}</wsc:orgunit>
            <!--Optional:-->
            <wsc:customerid xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <!--Optional:-->
            <wsc:locale>NO</wsc:locale>
            <wsc:ip>${#TestSuite#Fraud_IP}</wsc:ip>
            <!--Zero or more repetitions:-->
            <wsc:item key="${#TestSuite#Item1}" value="${#TestSuite#Value1}"/>
            <wsc:item key="${#TestSuite#Item2}" value="${#TestSuite#Value2}"/>
            <wsc:item key="${#TestSuite#Item3}" value="${#TestSuite#Value3}"/>
            <wsc:item key="${#TestSuite#Item4}" value="${#TestSuite#Value4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:PaymentPaymentInfoSearchRequest>
         <urn:searchCriteria>
            <urn1:commonCriteria>
               <urn1:elementControl>
                  <urn2:StartIndex>0</urn2:StartIndex>
                  <urn2:MaximumNumberOfElements>100</urn2:MaximumNumberOfElements>
               </urn1:elementControl>
               <urn1:debtorAccount>44760170973</urn1:debtorAccount>
               <!--Zero or more repetitions:-->
               <!--Optional:-->
               <!--Optional:-->
            </urn1:commonCriteria>
            <urn1:paymentInfoCriteria>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn1:showHidden>false</urn1:showHidden>
               <!--Zero or more repetitions:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn1:paymentStatus>TO_BE_APPROVED</urn1:paymentStatus>
               <urn1:paymentStatus>READY_FOR_DUE_DATE</urn1:paymentStatus>
               <urn1:paymentStatus>PROCESSING</urn1:paymentStatus>
               <urn1:sourceRegister>PWH</urn1:sourceRegister>
               <!--Optional:-->
            </urn1:paymentInfoCriteria>
         </urn:searchCriteria>
      </urn:PaymentPaymentInfoSearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="SOAP Fault Assertion" id="e909ce6b-4ac9-4f60-99dc-723c0a357e97" name="Not SOAP Fault"/>
        <con:assertion type="GroovyScriptAssertion" id="1e19c9c4-4d4b-410a-ac26-20a5385847bc" name="Script Assertion">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig action="urn:pins.payment.evry.com:ws:paymentsearch:v2_0/PINSPaymentSearch_V2_0PortType/PaymentPaymentInfoSearchRequest" mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="0ad03ac2-36f2-4072-87d3-09e9ba247ab1" name="TransactionSearch">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentSearch_V2_0PortTypeSoap11</con:interface>
      <con:operation>PaymentTransactionSearch</con:operation>
      <con:request name="TransactionSearch" id="f11dd465-e273-4b92-a7dc-ae96bd78aead">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://ald-eos-g-app02.man.cosng.net:22411/pin/services/PINSPaymentSearch_V2_0</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentsearch:v2_0" xmlns:urn1="urn:pins.payment.evry.com:domain:search:v2_0" xmlns:urn2="urn:pins.payment.evry.com:domain:common:v2_0" xmlns:urn3="urn:pins.payment.evry.com:domain:complex-types:v2_0">
   <soapenv:Header>
     <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SorceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PaymentCreate</wsc:Function>
         <wsc:Version>1.9</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#UserID}</wsc:userid>
            <wsc:credentials>03110012010400425kglPboRi3h1Z4YUjUpQ0UB65Ta2kPKj1KWwkWemtrL+SoWqMxx/KuqxUVbNyTu6DsSaabKNt2t+xJppso23a37EmmmyjbdrffJeRiGWfHDGwxCWOpDYc2jgSxAz1+8eEsSaabKNt2t/XzlyjxYnxhcG46wcbIKp/sSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu2xJppso23a37Emmmyjbdrf8wP73CNrvpw=apG4tU0NraPbbqKUp39erKDFa7xy6z+r4VDMr/6qBlkFniGaNeDXv4cZcZZQQI6JtwB3JYQk6WqLA7oyp1FWRM6n46ehgNmHVNly8fTnQbIuGJSF2LUyGI7aE92/dgtp8jv9bsGpNe58K+xb4LeIHwjb2nVVvt4/2oLtDQ8IPJE=</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#BankID}</wsc:orgid>
            <!--Optional:-->
            <wsc:orgunit>${#TestSuite#BankID}</wsc:orgunit>
            <!--Optional:-->
            <wsc:customerid xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <!--Optional:-->
            <wsc:locale>NO</wsc:locale>
            <wsc:ip>${#TestSuite#Fraud_IP}</wsc:ip>
            <!--Zero or more repetitions:-->
            <wsc:item key="${#TestSuite#Item1}" value="${#TestSuite#Value1}"/>
            <wsc:item key="${#TestSuite#Item2}" value="${#TestSuite#Value2}"/>
            <wsc:item key="${#TestSuite#Item3}" value="${#TestSuite#Value3}"/>
            <wsc:item key="${#TestSuite#Item4}" value="${#TestSuite#Value4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:PaymentTransactionSearchRequest>
         <urn:searchCriteria>
            <urn1:commonCriteria>
               <urn1:elementControl>
                  <urn2:StartIndex>0</urn2:StartIndex>
                  <urn2:MaximumNumberOfElements>100</urn2:MaximumNumberOfElements>
               </urn1:elementControl>
               <!--Zero or more repetitions:-->
               <!--Optional:-->
               <urn1:debtorAccount>44760170973</urn1:debtorAccount>
               <!--Optional:-->
            </urn1:commonCriteria>
            <urn1:transactionCriteria>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn1:showHidden>false</urn1:showHidden>
               <!--Optional:-->
               <!--Optional:-->
               <urn1:bankEmployeeInitiated>false</urn1:bankEmployeeInitiated>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn1:filterByOrgUnit>false</urn1:filterByOrgUnit>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Zero or more repetitions:-->
               <!--Zero or more repetitions:-->
               <urn1:paymentStatus>TO_BE_APPROVED</urn1:paymentStatus>
               <urn1:paymentStatus>READY_FOR_DUE_DATE</urn1:paymentStatus>
               <urn1:paymentStatus>PROCESSING</urn1:paymentStatus>
               <!--Optional:-->
               <!--Optional:-->
               <urn1:sourceRegister>PWH</urn1:sourceRegister>
               <!--Optional:-->
            </urn1:transactionCriteria>
         </urn:searchCriteria>
      </urn:PaymentTransactionSearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="SOAP Fault Assertion" id="ef366ad4-24de-4e55-8792-d37de67711d7" name="Not SOAP Fault"/>
        <con:assertion type="GroovyScriptAssertion" id="d3d1b9ea-1f86-4f5e-8d4c-775682b4b4e7" name="Script Assertion">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig action="urn:pins.payment.evry.com:ws:paymentsearch:v2_0/PINSPaymentSearch_V2_0PortType/PaymentTransactionSearchRequest" mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:properties>
    <con:property>
      <con:name>PaymentId</con:name>
      <con:value>64915</con:value>
    </con:property>
    <con:property>
      <con:name>SourceApplication</con:name>
      <con:value>PaymentClient</con:value>
    </con:property>
    <con:property>
      <con:name>userid</con:name>
      <con:value>12105315374</con:value>
    </con:property>
    <con:property>
      <con:name>credentials</con:name>
      <con:value>03110012010400425kglPboRi3h16OVtVL1neI9CfuAtjCBO603eS0IgWm1WWIO7EfpSL4DE%2FlDFi69n1sSaabKNt2t%2BxJppso23a37EmmmyjbdrfutbV53%2FUXGOxjDkLmirISLEmmmyjbdrfsSaabKNt2t%2FXzlyjxYnxhcG46wcbIKp%2FsSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu2xJppso23a37Emmmyjbdrf8wP73CNrvpw%3DH5LS2JD%2BVebr3PytlKAocCy8%2FCcrl7tRSepyb0jhKW8A8k07nuvorl7Xoscy%2BybGjXIr2Zj%2Fvprt%2BD1IueT5rqEcvxyyr%2FYELRuLkDS94SfjVw%2FszcGGYfeWnI2Z1NwXorQAZPvT5U6Edafp2sbvWiNKkrzCmFJ4YcuHbGSJCYk%3D</con:value>
    </con:property>
    <con:property>
      <con:name>orgid</con:name>
      <con:value>4201</con:value>
    </con:property>
    <con:property>
      <con:name>customerid</con:name>
      <con:value>12105315374</con:value>
    </con:property>
    <con:property>
      <con:name>debitAccount</con:name>
      <con:value>42000921909</con:value>
    </con:property>
    <con:property>
      <con:name>DebitAcntccy</con:name>
      <con:value>NOK</con:value>
    </con:property>
    <con:property>
      <con:name>CreditAccount</con:name>
      <con:value>42022973201</con:value>
    </con:property>
    <con:property>
      <con:name>item1</con:name>
      <con:value>PaymentChannel</con:value>
    </con:property>
    <con:property>
      <con:name>value1</con:name>
      <con:value>ITR</con:value>
    </con:property>
    <con:property>
      <con:name>item2</con:name>
      <con:value>Employee</con:value>
    </con:property>
    <con:property>
      <con:name>value2</con:name>
      <con:value>TESTUSERPI27</con:value>
    </con:property>
    <con:property>
      <con:name>item3</con:name>
      <con:value>SelfService</con:value>
    </con:property>
    <con:property>
      <con:name>value3</con:name>
      <con:value>true</con:value>
    </con:property>
    <con:property>
      <con:name>item4</con:name>
      <con:value>LogRef</con:value>
    </con:property>
    <con:property>
      <con:name>value4</con:name>
      <con:value>${=new Date().format("ddMMyyyy_HHmmss")}-${=context.getCurrentStep().getTestCase().getLabel()}</con:value>
    </con:property>
    <con:property>
      <con:name>ReqExnDate</con:name>
      <con:value>${=new Date().format("yyyy-MM-dd")}</con:value>
    </con:property>
    <con:property>
      <con:name>debitResId</con:name>
      <con:value>02606370000</con:value>
    </con:property>
    <con:property>
      <con:name>AgreeementId</con:name>
      <con:value>12105315374</con:value>
    </con:property>
    <con:property>
      <con:name>orignalMessageid</con:name>
      <con:value>20190624-PI1</con:value>
    </con:property>
    <con:property>
      <con:name>transactiosId</con:name>
      <con:value>782621</con:value>
    </con:property>
  </con:properties>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>6b984b45-87f7-4c28-b2fa-90eabc40d956</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
