<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="5ea2b641-46e8-4285-9fc4-a5461414ac71" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="DBProperties" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="5ea2b641-46e8-4285-9fc4-a5461414ac71fileName">DBProperties</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="properties" name="Properties" id="a5935ce4-e0fc-4dea-a8ed-8e2c9569c795">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>UserID</con:name>
          <con:value>${#TestSuite#UserID}</con:value>
        </con:property>
        <con:property>
          <con:name>credentials</con:name>
          <con:value>03111012010400425kglPboRi3h16OVtVL1neI9CfuAtjCBO603eS0IgWm1WWIO7EfpSL4DE%2FlDFi69n1sSaabKNt2t%2BxJppso23a37Emmmyjbdrflpq4f56YEcTwqPbJGRxTVbEmmmyjbdrfsSaabKNt2t%2FXzlyjxYnxhcG46wcbIKp%2FsSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu3EfQIWD5xMfpd8V90wfJqE%2FrpIdBWOZCg%3DWlPV5eZ4diuCWN8n8MioYhhi5y3ry7ocUG557FkHElWUtZW5y2o9bV4kNOBI2eIvhnMNNl4KZzZiP60aZOtzU6qC7h54%2FjtOS9LP2XwPBSwC3jUA00HIe25%2FFBsLnNciYlYLbkWKiTZCji3sjsSuUS8K0sIEsS3qoAJRWadlGrE%3D</con:value>
        </con:property>
        <con:property>
          <con:name>channel</con:name>
          <con:value>NBA</con:value>
        </con:property>
        <con:property>
          <con:name>orgid</con:name>
          <con:value>4201</con:value>
        </con:property>
        <con:property>
          <con:name>PaymentChannel_PM</con:name>
          <con:value>INT</con:value>
        </con:property>
        <con:property>
          <con:name>customerid</con:name>
          <con:value>${#TestSuite#customerid}</con:value>
        </con:property>
        <con:property>
          <con:name>AgreementId</con:name>
          <con:value>${#TestSuite#AgreementId}</con:value>
        </con:property>
        <con:property>
          <con:name>bankId</con:name>
          <con:value>4201</con:value>
        </con:property>
        <con:property>
          <con:name>accountNumber</con:name>
          <con:value>${#TestSuite#accountNumber}</con:value>
        </con:property>
        <con:property>
          <con:name>accountOwnerIdentifier</con:name>
          <con:value>00956027993</con:value>
        </con:property>
        <con:property>
          <con:name>currencyCode</con:name>
          <con:value>${#TestSuite#currencyCode}</con:value>
        </con:property>
        <con:property>
          <con:name>accountType</con:name>
          <con:value>CoreAccount</con:value>
        </con:property>
        <con:property>
          <con:name>approvalLimit</con:name>
          <con:value>500000</con:value>
        </con:property>
        <con:property>
          <con:name>registerLimit</con:name>
          <con:value>500000</con:value>
        </con:property>
        <con:property>
          <con:name>numberOfVerifiers</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>numberOfApprovers</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>bookingLevel</con:name>
          <con:value>D</con:value>
        </con:property>
        <con:property>
          <con:name>CreditorAgent</con:name>
          <con:value>DAAEDEDDXXX</con:value>
        </con:property>
        <con:property>
          <con:name>CreditorCountry</con:name>
          <con:value>DE</con:value>
        </con:property>
        <con:property>
          <con:name>CreditorCurrency</con:name>
          <con:value>NOK</con:value>
        </con:property>
        <con:property>
          <con:name>PaymentChannel_BM</con:name>
          <con:value>BES</con:value>
        </con:property>
        <con:property>
          <con:name>CreditAccountNumber</con:name>
          <con:value>${#TestSuite#CreditAccountNumber}</con:value>
        </con:property>
        <con:property>
          <con:name>Amount</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>BalanceLimitAmount_Above</con:name>
          <con:value>5</con:value>
        </con:property>
        <con:property>
          <con:name>DebitCurrency</con:name>
          <con:value>NOK</con:value>
        </con:property>
        <con:property>
          <con:name>soAgreementId</con:name>
          <con:value>39480</con:value>
        </con:property>
        <con:property>
          <con:name>soAgreementVersion</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>firstTransactionDate</con:name>
          <con:value>2020-09-21</con:value>
        </con:property>
        <con:property>
          <con:name>recurrenceType</con:name>
          <con:value>DAILY</con:value>
        </con:property>
        <con:property>
          <con:name>internalId</con:name>
          <con:value>75395</con:value>
        </con:property>
        <con:property>
          <con:name>fullBalanceAvailable</con:name>
          <con:value>93788.17</con:value>
        </con:property>
        <con:property>
          <con:name>DueDate</con:name>
          <con:value>${= java.time.LocalDateTime.now().format(java.time.format.DateTimeFormatter.ofPattern('yyyy-MM-dd'))}</con:value>
        </con:property>
        <con:property>
          <con:name>AvailableBalance</con:name>
          <con:value>2216.02</con:value>
        </con:property>
        <con:property>
          <con:name>SourceApplicationDeps</con:name>
          <con:value>PIN</con:value>
        </con:property>
        <con:property>
          <con:name>userIdDeps</con:name>
          <con:value>D210PAY</con:value>
        </con:property>
        <con:property>
          <con:name>destinationApplicationDeps</con:name>
          <con:value>CWSJ5</con:value>
        </con:property>
        <con:property>
          <con:name>credentialsDeps</con:name>
          <con:value>03111012010400425kglPboRi3h16OVtVL1neI9CfuAtjCBO603eS0IgWm1WWIO7EfpSL4DE%2FlDFi69n1sSaabKNt2t%2BxJppso23a37EmmmyjbdrfkkqxxhMk30WewZFnEDBXjbEmmmyjbdrfsSaabKNt2t%2FXzlyjxYnxhcG46wcbIKp%2FsSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu3EfQIWD5xMfokmgZRGVVmx5Sj3%2Fl0ONFk%3DNEDNSxp9dSZrTgTc8FQZH2%2BcCJH2i6JVeQujJsOFspnZLIrJ%2FuKwomqnqBEUfwp16lFG7oNme1nGipyowyfruYRWpd%2FshZpSAsnaArB%2B54u6Czd6k8LQ9TprK1E3RG6YggyW9FDg58it2antT1iUPbCr7fc9RkGMxwJwGZ8h0vU%3D</con:value>
        </con:property>
        <con:property>
          <con:name>addAmount</con:name>
          <con:value>10000</con:value>
        </con:property>
        <con:property>
          <con:name>transactionId</con:name>
          <con:value>260197808</con:value>
        </con:property>
        <con:property>
          <con:name>BalanceCheckvalue</con:name>
          <con:value>INT</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="FetchAccount" id="9bfa2eb1-c33f-49d2-b4d5-32d93537b6bd">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWHDATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:PWHDATA/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_s1_19c)))</con:connectionString>
      <con:password/>
      <con:connectionProperties/>
      <con:query>SELECT CUSTOMERID,ACCOUNTNUMBER
FROM V_AUTHORISATION WHERE ROLETYPE='EIER' AND CUSTOMERID IN
  ( SELECT CUSTOMERID FROM V_AUTHORISATION WHERE CUSTBANKID='4201' AND LENGTH(CUSTOMERID) =11 and ROLETYPE='EIER'
    AND CUSTOMERID NOT IN (SELECT CUSTOMERID FROM STO_AGREEMENT)
    GROUP BY CUSTOMERID
    HAVING COUNT(CUSTOMERID) > 1
  ) ORDER BY CUSTOMERID
FETCH FIRST 10 ROW ONLY</con:query>
      <con:assertion type="Simple Contains" id="952cf5c6-64ff-49d3-99f0-21e3165b92ac" name="Contains">
        <con:configuration>
          <token>${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}</token>
          <ignoreCase>false</ignoreCase>
          <useRegEx>false</useRegEx>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="SetAccount" id="e3adaa7d-666b-4c60-8db4-f7706f1a1748">
    <con:settings/>
    <con:config>
      <script>def customerID = context.expand( '${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CUSTOMERID[1]}' )
def debtorAccountNumber = context.expand( '${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}' )
def CreditAccountNumber = context.expand( '${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[2]/ACCOUNTNUMBER[1]}' )

customerID= customerID.toString().replaceAll("[^a-zA-Z0-9]+","")
debtorAccountNumber= debtorAccountNumber.toString().replaceAll("[^a-zA-Z0-9]+","")
CreditAccountNumber=CreditAccountNumber.toString().replaceAll("[^a-zA-Z0-9]+","")


def UserID = customerID.substring(5) as int
UserID = UserID.toString().replaceAll("[^a-zA-Z0-9]+","")
testRunner.testCase.testSuite.setPropertyValue("customerid",customerID)
testRunner.testCase.testSuite.setPropertyValue("UserID",UserID)
testRunner.testCase.testSuite.setPropertyValue("AgreementId",UserID)
testRunner.testCase.testSuite.setPropertyValue("accountNumber",debtorAccountNumber)
testRunner.testCase.testSuite.setPropertyValue("CreditAccountNumber",CreditAccountNumber)</script>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="7dd1275d-ecdb-4474-a046-d7edc5da6b64" name="BalanceCheck">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>DEPSAccountService_V15_3PortTypeSoap11</con:interface>
      <con:operation>accountReadBalanceInformation</con:operation>
      <con:request name="BalanceCheck" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="6427ddda-2392-4171-b568-eee922f931ba">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://10.246.89.245:10710/corewsdpgensrv/services/DEPSAccountService_V15_3</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v21" xmlns:urn="urn:srv.dep.savings.fs.edb.com:ws:account:v15_3" xmlns:urn1="urn:srv.dep.savings.fs.edb.com:domain:account:v15_3">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${Properties#SourceApplicationDeps}</wsc:SourceApplication>
         <wsc:DestinationApplication>${Properties#destinationApplicationDeps}</wsc:DestinationApplication>
         <wsc:Function>DEPSAccountService_V15_3.accountReadBalanceInformation</wsc:Function>
         <wsc:Version>15_3</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${Properties#userIdDeps}</wsc:userid>
            <wsc:credentials>${Properties#credentials}</wsc:credentials>
            <wsc:channel>${Properties#channel}</wsc:channel>
            <wsc:orgid>${Properties#orgId}</wsc:orgid>
            <wsc:orgunit xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <wsc:customerid>${Properties#customerId}</wsc:customerid>
            <wsc:locale xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <wsc:ip>10.246.89.108</wsc:ip>
            <wsc:item key="${Properties#item1}" value="${Properties#BalanceCheckvalue}"/>
            <wsc:item key="${Properties#item2}" value="${Properties#value2}"/>
            <wsc:item key="${Properties#item3}" value="${Properties#value3}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:accountReadBalanceInformationRequest>
         <urn:qualification>
            <urn1:accountNumber>${Properties#CreditAccountNumber}</urn1:accountNumber>
         </urn:qualification>
      </urn:accountReadBalanceInformationRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Valid HTTP Status Codes" id="856d8d22-f506-41c6-8154-f200e13608b7" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="SOAP Fault Assertion" id="f27ec154-745f-4f67-a091-2346402e6d4a" name="Not SOAP Fault"/>
        <con:assertion type="Schema Compliance" id="ff22f967-0a57-4f11-a840-da2b78cda933" name="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="MessageContentAssertion" id="943d356b-2b2b-4a47-8cd6-26a9ee714378" name="Message Content Assertion">
          <con:configuration xsi:type="con:MessageContentAssertion">
            <con:elements>
              <con:xpath>declare namespace ns3='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='urn:enterprise.fs.edb.com:domain:common:v1';
//ns3:accountReadBalanceInformationResponse[1]/ns2:ResponseState[1]/ns1:ErrorCode[1]</con:xpath>
              <con:element>ErrorCode</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns3='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='urn:enterprise.fs.edb.com:domain:common:v1';
//ns3:accountReadBalanceInformationResponse[1]/ns2:ResponseState[1]/ns1:Severity[1]</con:xpath>
              <con:element>Severity</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns3='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='urn:enterprise.fs.edb.com:domain:common:v1';
//ns3:accountReadBalanceInformationResponse[1]/ns2:ResponseState[1]/ns1:ComponentId[1]</con:xpath>
              <con:element>ComponentId</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>520</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns3='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='urn:enterprise.fs.edb.com:domain:common:v1';
//ns3:accountReadBalanceInformationResponse[1]/ns2:ResponseState[1]/ns1:StrErrorCode[1]</con:xpath>
              <con:element>StrErrorCode</con:element>
              <con:type>XmlString</con:type>
              <con:operator>exists</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue xsi:nil="true"/>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns4='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns2='http://edb.com/ws/WSCommon_v21';
declare namespace ns1='http://www.w3.org/2001/XMLSchema-instance';
declare namespace ns3='urn:enterprise.fs.edb.com:domain:common:v1';
//ns4:accountReadBalanceInformationResponse[1]/ns3:ResponseState[1]/ns2:StrErrorCode[1]/@ns1:nil</con:xpath>
              <con:element>@xsi:nil</con:element>
              <con:type/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>true</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns3='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='urn:enterprise.fs.edb.com:domain:common:v1';
//ns3:accountReadBalanceInformationResponse[1]/ns2:ResponseState[1]/ns1:Message[1]</con:xpath>
              <con:element>Message</con:element>
              <con:type>XmlString</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>OK</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns3='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='urn:enterprise.fs.edb.com:domain:common:v1';
//ns3:accountReadBalanceInformationResponse[1]/ns2:ResponseState[1]/ns1:NativeError[1]</con:xpath>
              <con:element>NativeError</con:element>
              <con:type>XmlString</con:type>
              <con:operator>exists</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue xsi:nil="true"/>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns4='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns2='http://edb.com/ws/WSCommon_v21';
declare namespace ns1='http://www.w3.org/2001/XMLSchema-instance';
declare namespace ns3='urn:enterprise.fs.edb.com:domain:common:v1';
//ns4:accountReadBalanceInformationResponse[1]/ns3:ResponseState[1]/ns2:NativeError[1]/@ns1:nil</con:xpath>
              <con:element>@xsi:nil</con:element>
              <con:type/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>true</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns3='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='urn:enterprise.fs.edb.com:domain:common:v1';
//ns3:accountReadBalanceInformationResponse[1]/ns2:ResponseState[1]/ns1:LogSequence[1]</con:xpath>
              <con:element>LogSequence</con:element>
              <con:type>XmlLong</con:type>
              <con:operator>exists</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue xsi:nil="true"/>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns4='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns2='http://edb.com/ws/WSCommon_v21';
declare namespace ns1='http://www.w3.org/2001/XMLSchema-instance';
declare namespace ns3='urn:enterprise.fs.edb.com:domain:common:v1';
//ns4:accountReadBalanceInformationResponse[1]/ns3:ResponseState[1]/ns2:LogSequence[1]/@ns1:nil</con:xpath>
              <con:element>@xsi:nil</con:element>
              <con:type/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>true</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:accountProduct[1]</con:xpath>
              <con:element>ns2:accountProduct</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>LOCDEPOSIT</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:disposalText[1]</con:xpath>
              <con:element>ns2:disposalText</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>DISPONERES IKKE AV KONTOEIER</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:balance[1]</con:xpath>
              <con:element>ns2:balance</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>exists</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>492548.00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:availableBalance[1]</con:xpath>
              <con:element>ns2:availableBalance</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>exists</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>492246.00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:creditLine[1]</con:xpath>
              <con:element>ns2:creditLine</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:additionalAgreementsExist[1]</con:xpath>
              <con:element>ns2:additionalAgreementsExist</con:element>
              <con:type>XmlBoolean</con:type>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>true</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:confirmedAmount[1]</con:xpath>
              <con:element>ns2:confirmedAmount</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>-302.00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:coverageControlExist[1]</con:xpath>
              <con:element>ns2:coverageControlExist</con:element>
              <con:type>XmlBoolean</con:type>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>true</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:directDebitingExist[1]</con:xpath>
              <con:element>ns2:directDebitingExist</con:element>
              <con:type>XmlBoolean</con:type>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>true</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:lastTransactionDate[1]</con:xpath>
              <con:element>ns2:lastTransactionDate</con:element>
              <con:type>XmlDate</con:type>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>2017-08-10+02:00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:accountDescription[1]</con:xpath>
              <con:element>ns2:accountDescription</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>VERGE P1 U/BINDING</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:maxOverdraft[1]</con:xpath>
              <con:element>ns2:maxOverdraft</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>0.00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:savingsBalance[1]</con:xpath>
              <con:element>ns2:savingsBalance</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>0.00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:blockedAmount[1]</con:xpath>
              <con:element>ns2:blockedAmount</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>0.00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:statementFrequency[1]</con:xpath>
              <con:element>ns2:statementFrequency</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>ANNUALY</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:noticeLimit[1]</con:xpath>
              <con:element>ns2:noticeLimit</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:cashpoolExist[1]</con:xpath>
              <con:element>ns2:cashpoolExist</con:element>
              <con:type>XmlBoolean</con:type>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>false</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:coverageAccountNumberCP[1]</con:xpath>
              <con:element>ns2:coverageAccountNumberCP</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>00000000000</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns2:accountReadBalanceInformationResponse[1]/ns2:result[1]/ns1:detailsBalanceInformation[1]/ns1:availableBalanceCP[1]</con:xpath>
              <con:element>ns2:availableBalanceCP</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>0.00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:corews.enterprise.fs.edb.com:domain:common:v1';
//ns2:accountReadBalanceInformationResponse[1]/ns2:customerInformation[1]/ns1:customerNumber[1]</con:xpath>
              <con:element>ns6:customerNumber</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>01010077571</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:corews.enterprise.fs.edb.com:domain:common:v1';
//ns2:accountReadBalanceInformationResponse[1]/ns2:customerInformation[1]/ns1:shortName[1]</con:xpath>
              <con:element>ns6:shortName</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>ANONYM5184814</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:corews.enterprise.fs.edb.com:domain:common:v1';
//ns2:accountReadBalanceInformationResponse[1]/ns2:customerInformation[1]/ns1:profitCenter[1]</con:xpath>
              <con:element>ns6:profitCenter</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>32004</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:corews.enterprise.fs.edb.com:domain:common:v1';
//ns2:accountReadBalanceInformationResponse[1]/ns2:customerInformation[1]/ns1:productId[1]</con:xpath>
              <con:element>ns6:productId</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>4002/01 /00 /00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns1='urn:corews.enterprise.fs.edb.com:domain:common:v1';
//ns2:accountReadBalanceInformationResponse[1]/ns2:customerInformation[1]/ns1:productShortName[1]</con:xpath>
              <con:element>ns6:productShortName</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>VEP1UB</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:originalMessage><![CDATA[<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <ns3:accountReadBalanceInformationResponse xmlns:ns13="urn:srv.dep.savings.fs.edb.com:domain:account:v14_1" xmlns:ns12="urn:srv.dep.savings.fs.edb.com:domain:account:v13_1" xmlns:ns11="urn:srv.dep.savings.fs.edb.com:domain:account:v15_2" xmlns:ns10="urn:srv.dep.savings.fs.edb.com:domain:account:v15_1" xmlns:ns9="urn:corews.enterprise.fs.edb.com:domain:common:v2" xmlns:ns8="urn:srv.agr.enterprise.fs.edb.com:ws:role:v17_1" xmlns:ns7="urn:srv.agr.enterprise.fs.edb.com:domain:role:v17_1" xmlns:ns6="urn:corews.enterprise.fs.edb.com:domain:common:v1" xmlns:ns5="urn:srv.dep.savings.fs.edb.com:domain:alertcodes:v2" xmlns:ns4="urn:enterprise.fs.edb.com:domain:common:v1" xmlns:ns3="urn:srv.dep.savings.fs.edb.com:ws:account:v15_3" xmlns:ns2="urn:srv.dep.savings.fs.edb.com:domain:account:v15_3" xmlns="http://edb.com/ws/WSCommon_v21">
         <ns4:ResponseState>
            <ErrorCode>0</ErrorCode>
            <Severity>0</Severity>
            <ComponentId>520</ComponentId>
            <StrErrorCode xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <Message>OK</Message>
            <NativeError xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <LogSequence xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </ns4:ResponseState>
         <ns3:result>
            <ns2:detailsBalanceInformation>
               <ns2:accountProduct>LOCDEPOSIT</ns2:accountProduct>
               <ns2:disposalText>DISPONERES IKKE AV KONTOEIER</ns2:disposalText>
               <ns2:balance>492548.00</ns2:balance>
               <ns2:availableBalance>492246.00</ns2:availableBalance>
               <ns2:creditLine>0</ns2:creditLine>
               <ns2:additionalAgreementsExist>true</ns2:additionalAgreementsExist>
               <ns2:confirmedAmount>-302.00</ns2:confirmedAmount>
               <ns2:coverageControlExist>true</ns2:coverageControlExist>
               <ns2:directDebitingExist>true</ns2:directDebitingExist>
               <ns2:lastTransactionDate>2017-08-10+02:00</ns2:lastTransactionDate>
               <ns2:accountDescription>VERGE P1 U/BINDING</ns2:accountDescription>
               <ns2:maxOverdraft>0.00</ns2:maxOverdraft>
               <ns2:savingsBalance>0.00</ns2:savingsBalance>
               <ns2:blockedAmount>0.00</ns2:blockedAmount>
               <ns2:statementFrequency>ANNUALY</ns2:statementFrequency>
               <ns2:noticeLimit>0</ns2:noticeLimit>
               <ns2:cashpoolExist>false</ns2:cashpoolExist>
               <ns2:coverageAccountNumberCP>00000000000</ns2:coverageAccountNumberCP>
               <ns2:availableBalanceCP>0.00</ns2:availableBalanceCP>
            </ns2:detailsBalanceInformation>
         </ns3:result>
         <ns3:customerInformation>
            <ns6:customerNumber>01010077571</ns6:customerNumber>
            <ns6:shortName>ANONYM5184814</ns6:shortName>
            <ns6:profitCenter>32004</ns6:profitCenter>
            <ns6:productId>4002/01 /00 /00</ns6:productId>
            <ns6:productShortName>VEP1UB</ns6:productShortName>
         </ns3:customerInformation>
      </ns3:accountReadBalanceInformationResponse>
   </soap:Body>
</soap:Envelope>]]></con:originalMessage>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig mustUnderstand="NONE" version="200508" action="urn:srv.dep.savings.fs.edb.com:ws:account:v15_3/DEPSAccountService_V15_3PortType/accountReadBalanceInformationRequest"/>
        <con:wsrmConfig version="1.2"/>
        <con:environmentSpec>
          <con:entry environmentId="ab02220b-4eec-4859-800d-d5d1f5a10707">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="transfer" name="balanceTransfer" id="6addcaa1-f45f-4c1e-92a8-bf10a5bea04b">
    <con:settings/>
    <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>avaiableBalance</con:name>
        <con:sourceType>Response</con:sourceType>
        <con:sourceStep>BalanceCheck</con:sourceStep>
        <con:sourcePath>declare namespace ns3='urn:srv.dep.savings.fs.edb.com:ws:account:v15_3';
declare namespace ns2='urn:srv.dep.savings.fs.edb.com:domain:account:v15_3';
//ns3:accountReadBalanceInformationResponse[1]/ns3:result[1]/ns2:detailsBalanceInformation[1]/ns2:availableBalance[1]</con:sourcePath>
        <con:targetType>AvailableBalance</con:targetType>
        <con:targetStep>Properties</con:targetStep>
        <con:targetPath/>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="setBalance" id="47eae81a-6566-4f5f-ab9e-b85c68d5b738">
    <con:settings/>
    <con:config>
      <script>def debitAmount = context.expand( '${Properties#Amount}' )
def availableBalance = context.expand( '${Properties#availableBalance}' )

int debitAmountInt = Double.parseDouble(debitAmount)
int availableBalanceInt = Double.parseDouble(availableBalance)

if (availableBalanceInt > (debitAmountInt*20)){
	testRunner.gotoStep(context.getCurrentStepIndex() +2)
}else {
	def addAmount = debitAmountInt * 100
	testRunner.getTestCase().getTestStepByName("Properties").setPropertyValue("addAmount", addAmount.toString())	
}</script>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="f5165c4e-d557-4025-93bf-809422b2170d" name="AddAmount">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PCASReservationCreate_V1_1ServiceSoapBinding</con:interface>
      <con:operation>pCASReservationCreate_V1_1</con:operation>
      <con:request name="AddAmount" id="4b71e9b4-40c4-4628-b491-d64d84d4f9b2">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://ilt-lbx-g-c01.man.cosng.net:13610/fts/services/PCASReservationCreate_V1_1Service</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v21" xmlns:res="http://reservations.ws.pca.finance.edb.com">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${Properties#SourceApplicationDeps}</wsc:SourceApplication>
         <wsc:DestinationApplication>${Properties#destinationApplicationDeps}</wsc:DestinationApplication>
         <wsc:Function>DEPSAccountService_V15_3.accountReadBalanceInformation</wsc:Function>
         <wsc:Version>15_3</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${Properties#userIdDeps}</wsc:userid>
            <wsc:credentials>${Properties#credentials}</wsc:credentials>
            <wsc:channel>${Properties#channel}</wsc:channel>
            <wsc:orgid>${Properties#orgId}</wsc:orgid>
            <wsc:orgunit xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <wsc:customerid>${Properties#customerId}</wsc:customerid>
            <wsc:locale xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <wsc:ip>10.246.89.108</wsc:ip>
            <wsc:item key="${Properties#item1}" value="${Properties#value1}"/>
            <wsc:item key="${Properties#item2}" value="${Properties#value2}"/>
            <wsc:item key="${Properties#item3}" value="${Properties#value3}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <res:PCASReservationCreate_V1_1InputArgs>
         <res:ReservationCreateQualification_V1_1>
            <res:AccountNo>${Properties#accountNumber}</res:AccountNo>
            <!--Optional:-->
            <res:CounterAccountNo xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <res:Amount>${Properties#addAmount}</res:Amount>
            <!--Optional:-->
            <res:AmountCurrency>${Properties#currencyCode}</res:AmountCurrency>
            <res:AuthRef>${=Math.abs(new Random().nextInt() % 6000000) + 1}</res:AuthRef>
            <!--Optional:-->
            <res:TextCode>950</res:TextCode>
            <!--Optional:-->
            <res:FinInst xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <!--Optional:-->
            <res:DtExpiry xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <!--Optional:-->
            <res:Force>false</res:Force>
            <!--Optional:-->
            <res:CheckDuplicate>false</res:CheckDuplicate>
            <!--Optional:-->
            <res:DoCounterAcctRes>false</res:DoCounterAcctRes>
         </res:ReservationCreateQualification_V1_1>
      </res:PCASReservationCreate_V1_1InputArgs>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Valid HTTP Status Codes" id="ecf8380b-630e-4810-9ac6-5fbef105979f" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="SOAP Fault Assertion" id="5e8a048d-92c3-4f46-95e9-df65d40ca6e0" name="Not SOAP Fault"/>
        <con:assertion type="Schema Compliance" id="1f32a0eb-2552-4690-b36c-f0ac8b355a11" name="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="MessageContentAssertion" name="Message Content Assertion" id="91666bb4-2b19-46aa-8dc5-30453ea074b3">
          <con:configuration xsi:type="con:MessageContentAssertion">
            <con:elements>
              <con:xpath>declare namespace ns1='http://reservations.ws.pca.finance.edb.com';
//ns1:PCASReservationCreate_V1_1OutputArgs[1]/ns1:ReservationCreateResult_V1_1[1]/ns1:AvailableBalance[1]</con:xpath>
              <con:element>AvailableBalance</con:element>
              <con:type>XmlDecimal</con:type>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>80190.00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='http://reservations.ws.pca.finance.edb.com';
//ns2:PCASReservationCreate_V1_1OutputArgs[1]/ns2:ResponseState[1]/ns1:ErrorCode[1]</con:xpath>
              <con:element>ns2:ErrorCode</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='http://reservations.ws.pca.finance.edb.com';
//ns2:PCASReservationCreate_V1_1OutputArgs[1]/ns2:ResponseState[1]/ns1:Severity[1]</con:xpath>
              <con:element>ns2:Severity</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='http://reservations.ws.pca.finance.edb.com';
//ns2:PCASReservationCreate_V1_1OutputArgs[1]/ns2:ResponseState[1]/ns1:ComponentId[1]</con:xpath>
              <con:element>ns2:ComponentId</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='http://reservations.ws.pca.finance.edb.com';
//ns2:PCASReservationCreate_V1_1OutputArgs[1]/ns2:ResponseState[1]/ns1:StrErrorCode[1]</con:xpath>
              <con:element>ns2:StrErrorCode</con:element>
              <con:type>XmlString</con:type>
              <con:operator>exists</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue xsi:nil="true"/>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='http://edb.com/ws/WSCommon_v21';
declare namespace ns1='http://www.w3.org/2001/XMLSchema-instance';
declare namespace ns3='http://reservations.ws.pca.finance.edb.com';
//ns3:PCASReservationCreate_V1_1OutputArgs[1]/ns3:ResponseState[1]/ns2:StrErrorCode[1]/@ns1:nil</con:xpath>
              <con:element>@xsi:nil</con:element>
              <con:type/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>true</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='http://reservations.ws.pca.finance.edb.com';
//ns2:PCASReservationCreate_V1_1OutputArgs[1]/ns2:ResponseState[1]/ns1:Message[1]</con:xpath>
              <con:element>ns2:Message</con:element>
              <con:type>XmlString</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>SUCCESS</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='http://reservations.ws.pca.finance.edb.com';
//ns2:PCASReservationCreate_V1_1OutputArgs[1]/ns2:ResponseState[1]/ns1:NativeError[1]</con:xpath>
              <con:element>ns2:NativeError</con:element>
              <con:type>XmlString</con:type>
              <con:operator>exists</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue xsi:nil="true"/>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v21';
declare namespace ns2='http://reservations.ws.pca.finance.edb.com';
//ns2:PCASReservationCreate_V1_1OutputArgs[1]/ns2:ResponseState[1]/ns1:LogSequence[1]</con:xpath>
              <con:element>ns2:LogSequence</con:element>
              <con:type>XmlLong</con:type>
              <con:operator>exists</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue xsi:nil="true"/>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='http://edb.com/ws/WSCommon_v21';
declare namespace ns1='http://www.w3.org/2001/XMLSchema-instance';
declare namespace ns3='http://reservations.ws.pca.finance.edb.com';
//ns3:PCASReservationCreate_V1_1OutputArgs[1]/ns3:ResponseState[1]/ns2:LogSequence[1]/@ns1:nil</con:xpath>
              <con:element>@xsi:nil</con:element>
              <con:type/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>true</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:originalMessage><![CDATA[<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <PCASReservationCreate_V1_1OutputArgs xmlns="http://reservations.ws.pca.finance.edb.com" xmlns:ns2="http://edb.com/ws/WSCommon_v21">
         <ReservationCreateResult_V1_1>
            <AvailableBalance>80190.00</AvailableBalance>
         </ReservationCreateResult_V1_1>
         <ResponseState>
            <ns2:ErrorCode>0</ns2:ErrorCode>
            <ns2:Severity>0</ns2:Severity>
            <ns2:ComponentId>0</ns2:ComponentId>
            <ns2:StrErrorCode xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <ns2:Message>SUCCESS</ns2:Message>
            <ns2:NativeError/>
            <ns2:LogSequence xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </ResponseState>
      </PCASReservationCreate_V1_1OutputArgs>
   </soap:Body>
</soap:Envelope>]]></con:originalMessage>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig action="pCASReservationCreate_V1_1" mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
        <con:environmentSpec>
          <con:entry environmentId="ab02220b-4eec-4859-800d-d5d1f5a10707">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="FetchAccount_USD" id="71f3724e-1308-4129-b48f-4a4e21d08a94" disabled="true">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWHDATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:PWHDATA/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_s1_19c)))</con:connectionString>
      <con:password/>
      <con:connectionProperties/>
      <con:query>select AGREEMENTID,UserID,ACCOUNTNUMBER,currencycode from v_auth_userinfo where  currencycode='USD' and bankorgID='4201' and Markettype='PM' 
and  userid NOT IN(SELECT STO_AGREEMENT.customerid FROM STO_AGREEMENT)
FETCH FIRST 1 ROW ONLY</con:query>
      <con:assertion type="Simple Contains" id="952cf5c6-64ff-49d3-99f0-21e3165b92ac" name="Contains">
        <con:configuration>
          <token>${FetchAccount_USD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}</token>
          <ignoreCase>false</ignoreCase>
          <useRegEx>false</useRegEx>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="SetAccount_USD" id="7f592e0b-c054-4d3a-ae95-5bd48c1769aa" disabled="true">
    <con:settings/>
    <con:config>
      <script>def customerID = context.expand( '${FetchAccount_USD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/AGREEMENTID[1]}' )

def debtorAccountNumber = context.expand( '${FetchAccount_USD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}' )

def debtorAccountCcy = context.expand( '${FetchAccount_USD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CURRENCYCODE[1]}' )
//def CreditAccountNumber = context.expand( '${FetchAccount_USD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[2]/ACCOUNTNUMBER[1]}' )


customerID= customerID.toString().replaceAll("[^a-zA-Z0-9]+","")
debtorAccountNumber= debtorAccountNumber.toString().replaceAll("[^a-zA-Z0-9]+","")
debtorAccountCcy=  debtorAccountCcy.toString().replaceAll("[^a-zA-Z0-9]+","")
//CreditAccountNumber=CreditAccountNumber.toString().replaceAll("[^a-zA-Z0-9]+","")

def UserID = customerID.substring(5) as int
UserID = UserID.toString().replaceAll("[^a-zA-Z0-9]+","")
log.info "UserID : "+ UserID
testRunner.testCase.testSuite.setPropertyValue("customerid_USD",customerID)
testRunner.testCase.testSuite.setPropertyValue("UserID_USD",UserID)
testRunner.testCase.testSuite.setPropertyValue("AgreementId_USD",UserID)
testRunner.testCase.testSuite.setPropertyValue("accountNumber_USD",debtorAccountNumber)
testRunner.testCase.testSuite.setPropertyValue("currencyCode_USD",debtorAccountCcy)
//testRunner.testCase.testSuite.setPropertyValue("CreditAccountNumber_EUR",CreditAccountNumber)
log.info (testRunner.testCase.testSuite.getPropertyValue("accountNumber_USD"))
log.info (testRunner.testCase.testSuite.getPropertyValue("currencycode_USD"))</script>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="STOAGREEMENT" id="fbba5036-c2e8-495f-a060-5d72b4f9b247">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWHDATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:PWHDATA/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_s1_19c)))</con:connectionString>
      <con:password/>
      <con:connectionProperties/>
      <con:query>select AGREEMENTID,VERSIONNR,STATUS from STO_AGREEMENT where AGREEMENTACCOUNTNUMBER = '${#TestSuite#accountNumber}' 
and STATUS = 'ACTIVE' and AGREEMENTTYPE = 'BALANCE'</con:query>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="goto" name="IF ACTIVE" id="79218dd6-ff3c-4173-bfc6-0c59abbc85ad">
    <con:settings/>
    <con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:condition>
        <con:name>STATUS</con:name>
        <con:type>XPATH</con:type>
        <con:expression>//Results[1]/ResultSet[1]/Row[1]/STATUS[1]='ACTIVE'</con:expression>
        <con:targetStep>SO Close</con:targetStep>
      </con:condition>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="d5d33239-7f62-4d90-a1b1-5e3f07862d05" name="SO Close">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSStandingOrder_V2_0ServicePortTypeSoap11</con:interface>
      <con:operation>standingOrderStatusUpdate</con:operation>
      <con:request name="SO Close" id="de4900eb-0f92-4728-a326-4902cd6f9dfa">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://10.246.89.107:23621/pin/services/PINSStandingOrder_V2_0Service</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:srv.stord.fs.evry.com:ws:standingorder:v2_0" xmlns:urn1="urn:srv.stord.fs.evry.com:domain:standingorder:v2_0">
   <soapenv:Header>
    <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>paymentAuthorizationCreate</wsc:Function>
         <wsc:Version>1.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${Properties#UserID}</wsc:userid>
            <wsc:credentials>${Properties#credentials}</wsc:credentials>
            <wsc:channel>${Properties#channel}</wsc:channel>
            <wsc:orgid>${Properties#orgid}</wsc:orgid>
            <wsc:customerid>${Properties#customerid}</wsc:customerid>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item key="AgreementId" value="${Properties#AgreementId}"/>
            <wsc:item key="PaymentChannel" value="${Properties#PaymentChannel_BM}"/>
            <wsc:item key="LogRef" value="${=java.util.UUID.randomUUID()}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:standingOrderStatusUpdateRequest>
         <urn:standingOrderKey>
            <urn1:agreementId>${STOAGREEMENT#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/AGREEMENTID[1]}</urn1:agreementId><urn1:agreementVersion>${STOAGREEMENT#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/VERSIONNR[1]}</urn1:agreementVersion>
            <!--Optional:-->
            
         </urn:standingOrderKey>
         <urn:standingOrderAction>CLOSE</urn:standingOrderAction>
      </urn:standingOrderStatusUpdateRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig action="urn:srv.stord.fs.evry.com:ws:standingorder:v2_0/PINSStandingOrder_V2_0ServicePortType/standingOrderStatusUpdateRequest" mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
        <con:environmentSpec>
          <con:entry environmentId="ab02220b-4eec-4859-800d-d5d1f5a10707">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Groovy Script" id="64958d06-a480-4746-817d-6ac0b93b91e8" disabled="true">
    <con:settings/>
    <con:config>
      <script>testRunner.testCase.testSuite.testCaseList.each{ tcase ->
log.info tcase.name
	tcase.getTestStepByName("Properties").setPropertyValue("BalanceLimitAmount_Above","5")
	tcase.getTestStepByName("Properties").setPropertyValue("Amount","10")
}</script>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>9d7eb366-c3dc-4ef8-93d6-d6fa4ad61825</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>069cecc6-6e2f-4e84-b12a-d54be0489b5a</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>0404f5f8-1631-494a-ba4c-4098512c370f</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>ef1b33d6-3c5a-413a-ba31-307bbf152211</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>36c750c4-8dce-4937-b879-6dcad0dbf594</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>fa7b4e4f-7e7c-4dbb-b32e-5e892f50865a</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>6fb05fa4-6191-4e9a-b710-54be21596d6c</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
