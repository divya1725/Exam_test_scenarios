<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="84bf9be8-066f-48d9-9517-e93e63b7274e" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="AC14-INTCDebtCredNotInSameBank" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:description>TC will create Error Codes for AC14-INTCDebtCredNotInSameBank</con:description>
  <con:settings>
    <con:setting id="10c2e35e-f34f-40f9-b419-bbaf22a12ef4fileName">AC14-INTCDebtCredNotInSameBank</con:setting>
    <con:setting id="84bf9be8-066f-48d9-9517-e93e63b7274efileName">AC14-INTCDebtCredNotInSameBank</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="jdbc" name="DB Account" id="d24c5b12-74d7-4a19-a235-038400d8fb79">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWH-DATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_s1_19c)))</con:connectionString>
      <con:password>1</con:password>
      <con:connectionProperties/>
      <con:query>select CUSTOMERID,ACCOUNTNUMBER  from V_authorisation 
where CUSTBANKID='${Properties#bankId}' 
and length(customerID)='11' 
and ROWNUM = 1</con:query>
      <con:storedProcedure>false</con:storedProcedure>
      <con:assertion type="MessageContentAssertion" id="8e97c887-32b1-4c89-8f5a-4e8a7d8c4bc2" name="Message Content Assertion">
        <con:configuration xsi:type="con:MessageContentAssertion">
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/@fetchSize</con:xpath>
            <con:element>@fetchSize</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>10</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:originalMessage><![CDATA[<Results>
   <ResultSet fetchSize="10">
      <Row rowNumber="1">
         <CUSTOMERID>01010077571</CUSTOMERID>
         <ACCOUNTNUMBER>42125748338</ACCOUNTNUMBER>
      </Row>
   </ResultSet>
</Results>]]></con:originalMessage>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="SetProperties" id="4e23a8a7-64cf-4428-9665-6ab0dd171cb9">
    <con:settings/>
    <con:config>
      <script>import java.text.SimpleDateFormat

def customerID = context.expand( '${DB Account#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CUSTOMERID[1]}' )
def debtorAccountNumber = context.expand( '${DB Account#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}' )

testRunner.testCase.getTestStepByName("Properties").setPropertyValue("customerid",customerID)
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("accountNumber",debtorAccountNumber)

Date date = new Date();
SimpleDateFormat fn = new SimpleDateFormat("ddMyyhhmmss");
def datetime = fn.format(date)


def EndtoEndID = "Err_"+datetime;
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("MsgID",EndtoEndID );</script>
    </con:config>
  </con:testStep>
  <con:testStep type="properties" name="Properties" id="f928a88f-2f0a-4277-88c3-27d47f7494c0">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>customerid</con:name>
          <con:value>01016003499</con:value>
        </con:property>
        <con:property>
          <con:name>bankId</con:name>
          <con:value>4201</con:value>
        </con:property>
        <con:property>
          <con:name>accountNumber</con:name>
          <con:value>96550145224</con:value>
        </con:property>
        <con:property>
          <con:name>MessageToSendFormat</con:name>
          <con:value><![CDATA[<Wrapper xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="urn:pin.payment.edb.com:authpain001wrapper:v1_0"><auth><![CDATA[<?xml version="1.0" encoding="UTF-8"?><AgreementAuthorizationRequest><authRequest><agreementData><agreementId>CUSTOMERID</agreementId><bankId>4201</bankId><userId>CUSTOMERID</userId><userFirstName>Ext.Telepay</userFirstName><userLastName>EvryFileArchive</userLastName><userIdType>EXTU</userIdType><productID>0</productID><organizationId>CUSTOMERID</organizationId><preapproved>true</preapproved><rejectionLevel>TRANSACTION</rejectionLevel><origin>PAYMUL</origin></agreementData><agreementAccount><accountNumber>ACCOUNTID</accountNumber><swiftAdress>SPTRNO22XXX</swiftAdress><currencyCode>NOK</currencyCode><accountType>CoreAccount</accountType><access>CREDIT_AND_DEBIT</access><bookingLevel>T</bookingLevel><approvalLimit>10000000</approvalLimit><registerLimit>10000000</registerLimit><numberOfVerifiers>0</numberOfVerifiers><numberOfApprovers>0</numberOfApprovers></agreementAccount><metaInformation><receivedTimestamp>DATET00:05:37</receivedTimestamp></metaInformation></authRequest></AgreementAuthorizationRequest>]]]]>><![CDATA[</auth><content><![CDATA[<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Document xmlns="urn:iso:std:iso:20022:tech:xsd:pain.001.001.03"><CstmrCdtTrfInitn><GrpHdr><MsgId>TIMESTAMP</MsgId><CreDtTm>2020-08-25T00:00:00</CreDtTm><Authstn><Prtry>Private_market</Prtry></Authstn><NbOfTxs>4</NbOfTxs><InitgPty><Id><OrgId><BICOrBEI>SPTRNO22XXX</BICOrBEI><Othr><Id>4201</Id><SchmeNm><Cd>CHID</Cd></SchmeNm></Othr></OrgId></Id></InitgPty></GrpHdr><PmtInf><PmtInfId>TIMESTAMP.P1</PmtInfId><PmtMtd>TRF</PmtMtd><ReqdExctnDt>2020-12-04</ReqdExctnDt><Dbtr/><DbtrAcct><Id><IBAN>NO68ACCOUNTID</IBAN></Id></DbtrAcct><DbtrAgt><FinInstnId/></DbtrAgt><CdtTrfTxInf><PmtId><EndToEndId>TIMESTAMP.P1T1</EndToEndId></PmtId><PmtTpInf><SvcLvl><Cd>CHRG</Cd></SvcLvl><CtgyPurp><Cd>FCOL</Cd></CtgyPurp></PmtTpInf><Amt><InstdAmt Ccy="NOK">1</InstdAmt></Amt><CdtrAcct><Id><IBAN>NO0442121895336</IBAN></Id></CdtrAcct></CdtTrfTxInf></PmtInf><PmtInf><PmtInfId>TIMESTAMP.P2</PmtInfId><PmtMtd>TRF</PmtMtd><ReqdExctnDt>2020-12-04</ReqdExctnDt><Dbtr/><DbtrAcct><Id><IBAN>NO18ACCOUNTID</IBAN></Id></DbtrAcct><DbtrAgt><FinInstnId/></DbtrAgt><CdtTrfTxInf><PmtId><EndToEndId>TIMESTAMP.P2T1</EndToEndId></PmtId><PmtTpInf><SvcLvl><Cd>CHRG</Cd></SvcLvl><CtgyPurp><Cd>FCOL</Cd></CtgyPurp></PmtTpInf><Amt><InstdAmt Ccy="NOK">1</InstdAmt></Amt><CdtrAcct><Id><IBAN>NO4642244000120</IBAN></Id></CdtrAcct></CdtTrfTxInf></PmtInf><PmtInf><PmtInfId>TIMESTAMP.P3</PmtInfId><PmtMtd>TRF</PmtMtd><ReqdExctnDt>2020-07-14</ReqdExctnDt><Dbtr/><DbtrAcct><Id><IBAN>NO18ACCOUNTID</IBAN></Id></DbtrAcct><DbtrAgt><FinInstnId/></DbtrAgt><CdtTrfTxInf><PmtId><EndToEndId>TIMESTAMP.P3T1</EndToEndId></PmtId><PmtTpInf><SvcLvl><Cd>INTR</Cd></SvcLvl><CtgyPurp><Cd>INTE</Cd></CtgyPurp></PmtTpInf><Amt><InstdAmt Ccy="NOK">1</InstdAmt></Amt><CdtrAcct><Id><IBAN>NO5436241533276</IBAN></Id></CdtrAcct></CdtTrfTxInf></PmtInf><PmtInf><PmtInfId>TIMESTAMP.P4</PmtInfId><PmtMtd>TRF</PmtMtd><ReqdExctnDt>2020-07-14</ReqdExctnDt><Dbtr/><DbtrAcct><Id><IBAN>NO17ACCOUNTID</IBAN></Id></DbtrAcct><DbtrAgt><FinInstnId/></DbtrAgt><CdtTrfTxInf><PmtId><EndToEndId>TIMESTAMP.P4T1</EndToEndId></PmtId><PmtTpInf><SvcLvl><Cd>INTR</Cd></SvcLvl><CtgyPurp><Cd>INTE</Cd></CtgyPurp></PmtTpInf><Amt><InstdAmt Ccy="NOK">1</InstdAmt></Amt><CdtrAcct><Id><IBAN>NO5436241533276</IBAN></Id></CdtrAcct></CdtTrfTxInf></PmtInf></CstmrCdtTrfInitn></Document>]]]]>><![CDATA[</content></Wrapper>]]></con:value>
        </con:property>
        <con:property>
          <con:name>DueDate</con:name>
          <con:value>${= java.time.LocalDateTime.now().format(java.time.format.DateTimeFormatter.ofPattern('yyyy-MM-dd'))}</con:value>
        </con:property>
        <con:property>
          <con:name>MsgID</con:name>
          <con:value>Err_06622071408</con:value>
        </con:property>
        <con:property>
          <con:name>messagetoSend</con:name>
          <con:value><![CDATA[<Wrapper xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="urn:pin.payment.edb.com:authpain001wrapper:v1_0"><auth><![CDATA[<?xml version="1.0" encoding="UTF-8"?><AgreementAuthorizationRequest><authRequest><agreementData><agreementId>01016003499</agreementId><bankId>4201</bankId><userId>01016003499</userId><userFirstName>Ext.Telepay</userFirstName><userLastName>EvryFileArchive</userLastName><userIdType>EXTU</userIdType><productID>0</productID><organizationId>01016003499</organizationId><preapproved>true</preapproved><rejectionLevel>TRANSACTION</rejectionLevel><origin>PAYMUL</origin></agreementData><agreementAccount><accountNumber>96550145224</accountNumber><swiftAdress>SPTRNO22XXX</swiftAdress><currencyCode>NOK</currencyCode><accountType>CoreAccount</accountType><access>CREDIT_AND_DEBIT</access><bookingLevel>T</bookingLevel><approvalLimit>10000000</approvalLimit><registerLimit>10000000</registerLimit><numberOfVerifiers>0</numberOfVerifiers><numberOfApprovers>0</numberOfApprovers></agreementAccount><metaInformation><receivedTimestamp>2022-06-06T00:05:37</receivedTimestamp></metaInformation></authRequest></AgreementAuthorizationRequest>]]]]>><![CDATA[</auth><content><![CDATA[<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Document xmlns="urn:iso:std:iso:20022:tech:xsd:pain.001.001.03"><CstmrCdtTrfInitn><GrpHdr><MsgId>Err_06622071408</MsgId><CreDtTm>2020-08-25T00:00:00</CreDtTm><Authstn><Prtry>Private_market</Prtry></Authstn><NbOfTxs>4</NbOfTxs><InitgPty><Id><OrgId><BICOrBEI>SPTRNO22XXX</BICOrBEI><Othr><Id>4201</Id><SchmeNm><Cd>CHID</Cd></SchmeNm></Othr></OrgId></Id></InitgPty></GrpHdr><PmtInf><PmtInfId>Err_06622071408.P1</PmtInfId><PmtMtd>TRF</PmtMtd><ReqdExctnDt>2020-12-04</ReqdExctnDt><Dbtr/><DbtrAcct><Id><IBAN>NO6896550145224</IBAN></Id></DbtrAcct><DbtrAgt><FinInstnId/></DbtrAgt><CdtTrfTxInf><PmtId><EndToEndId>Err_06622071408.P1T1</EndToEndId></PmtId><PmtTpInf><SvcLvl><Cd>CHRG</Cd></SvcLvl><CtgyPurp><Cd>FCOL</Cd></CtgyPurp></PmtTpInf><Amt><InstdAmt Ccy="NOK">1</InstdAmt></Amt><CdtrAcct><Id><IBAN>NO0442121895336</IBAN></Id></CdtrAcct></CdtTrfTxInf></PmtInf><PmtInf><PmtInfId>Err_06622071408.P2</PmtInfId><PmtMtd>TRF</PmtMtd><ReqdExctnDt>2020-12-04</ReqdExctnDt><Dbtr/><DbtrAcct><Id><IBAN>NO1896550145224</IBAN></Id></DbtrAcct><DbtrAgt><FinInstnId/></DbtrAgt><CdtTrfTxInf><PmtId><EndToEndId>Err_06622071408.P2T1</EndToEndId></PmtId><PmtTpInf><SvcLvl><Cd>CHRG</Cd></SvcLvl><CtgyPurp><Cd>FCOL</Cd></CtgyPurp></PmtTpInf><Amt><InstdAmt Ccy="NOK">1</InstdAmt></Amt><CdtrAcct><Id><IBAN>NO4642244000120</IBAN></Id></CdtrAcct></CdtTrfTxInf></PmtInf><PmtInf><PmtInfId>Err_06622071408.P3</PmtInfId><PmtMtd>TRF</PmtMtd><ReqdExctnDt>2020-07-14</ReqdExctnDt><Dbtr/><DbtrAcct><Id><IBAN>NO1896550145224</IBAN></Id></DbtrAcct><DbtrAgt><FinInstnId/></DbtrAgt><CdtTrfTxInf><PmtId><EndToEndId>Err_06622071408.P3T1</EndToEndId></PmtId><PmtTpInf><SvcLvl><Cd>INTR</Cd></SvcLvl><CtgyPurp><Cd>INTE</Cd></CtgyPurp></PmtTpInf><Amt><InstdAmt Ccy="NOK">1</InstdAmt></Amt><CdtrAcct><Id><IBAN>NO5436241533276</IBAN></Id></CdtrAcct></CdtTrfTxInf></PmtInf><PmtInf><PmtInfId>Err_06622071408.P4</PmtInfId><PmtMtd>TRF</PmtMtd><ReqdExctnDt>2020-07-14</ReqdExctnDt><Dbtr/><DbtrAcct><Id><IBAN>NO1796550145224</IBAN></Id></DbtrAcct><DbtrAgt><FinInstnId/></DbtrAgt><CdtTrfTxInf><PmtId><EndToEndId>Err_06622071408.P4T1</EndToEndId></PmtId><PmtTpInf><SvcLvl><Cd>INTR</Cd></SvcLvl><CtgyPurp><Cd>INTE</Cd></CtgyPurp></PmtTpInf><Amt><InstdAmt Ccy="NOK">1</InstdAmt></Amt><CdtrAcct><Id><IBAN>NO5436241533276</IBAN></Id></CdtrAcct></CdtTrfTxInf></PmtInf></CstmrCdtTrfInitn></Document>]]]]>><![CDATA[</content></Wrapper>]]></con:value>
        </con:property>
        <con:property>
          <con:name>receiveMessagePain002</con:name>
          <con:value><![CDATA[<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Document xmlns="urn:iso:std:iso:20022:tech:xsd:pain.002.001.04">
    <CstmrPmtStsRpt>
        <GrpHdr>
            <MsgId>600685.38307.437224</MsgId>
            <CreDtTm>2020-09-21T06:02:05.959+02:00</CreDtTm>
            <InitgPty>
                <Nm>Førde Varehus AS</Nm>
                <Id>
                    <OrgId>
                        <AnyBIC>SPTRNO22XXX</AnyBIC>
                        <Othr>
                            <Id>3001</Id>
                            <SchmeNm>
                                <Cd>BANK</Cd>
                            </SchmeNm>
                        </Othr>
                    </OrgId>
                </Id>
            </InitgPty>
        </GrpHdr>
        <OrgnlGrpInfAndSts>
            <OrgnlMsgId>Err_21920093203</OrgnlMsgId>
            <OrgnlMsgNmId>pain.001.001.04</OrgnlMsgNmId>
        </OrgnlGrpInfAndSts>
        <OrgnlPmtInfAndSts>
            <OrgnlPmtInfId>Err_21920093203.P1</OrgnlPmtInfId>
            <TxInfAndSts>
                <OrgnlInstrId>Err_21920093203.I1</OrgnlInstrId>
                <OrgnlEndToEndId>Err_21920093203.E1</OrgnlEndToEndId>
                <TxSts>RJCT</TxSts>
                <StsRsnInf>
                    <AddtlInf>260227784</AddtlInf>
                </StsRsnInf>
                <StsRsnInf>
                    <Rsn>
                        <Cd>RR05</Cd>
                    </Rsn>
                    <AddtlInf>Regulatory reporting information is required</AddtlInf>
                </StsRsnInf>
            </TxInfAndSts>
        </OrgnlPmtInfAndSts>
    </CstmrPmtStsRpt>
</Document>]]></con:value>
        </con:property>
        <con:property>
          <con:name>txsExpectedStatus</con:name>
          <con:value>RJCT</con:value>
        </con:property>
        <con:property>
          <con:name>txsActualStatus</con:name>
          <con:value>RJCT</con:value>
        </con:property>
        <con:property>
          <con:name>actualStatus</con:name>
          <con:value>RR05</con:value>
        </con:property>
        <con:property>
          <con:name>expectedStatus</con:name>
          <con:value>RR05</con:value>
        </con:property>
        <con:property>
          <con:name>expectedStatusReason</con:name>
          <con:value>Regulatory reporting information is required</con:value>
        </con:property>
        <con:property>
          <con:name>actualStatusReason</con:name>
          <con:value>Regulatory reporting information is required</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Set_Queue_Details_And_File" id="af82fbc8-d5f4-4b52-864e-5a1cb7cebd58">
    <con:settings/>
    <con:config>
      <script>import com.eviware.soapui.support.GroovyUtils.*
import java.io.File 
import java.io.Reader

//MsgID
def MsgID = testRunner.testCase.getTestStepByName("Properties").getPropertyValue('MsgID');


//Initial Message to send
def messageToSend = context.expand( '${Properties#MessageToSendFormat}' )


//Parmeters needed in message
def Account = context.expand( '${Properties#accountNumber}' )
def customerid = context.expand( '${Properties#customerid}' )
def dueDate = context.expand( '${Properties#DueDate}' )
def BANKID = context.expand( '${Properties#bankId}' )


//Replace parmaeters in message by respective values
messageToSend = messageToSend.replaceAll("TIMESTAMP",MsgID) ;
messageToSend = messageToSend.replaceAll("CUSTOMERID",customerid) ;
messageToSend = messageToSend.replaceAll("ACCOUNTID",Account) ;
messageToSend = messageToSend.replaceAll("DATE",dueDate) ;
messageToSend = messageToSend.replaceAll("BANKID",BANKID) ;


//Set 'messagetoSend_currentTC  property value with updated message
def update = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("messagetoSend",messageToSend);</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="PreparePAIN001File" id="80768dde-fb50-4eab-9c3c-f6a5cbdaf6db">
    <con:settings/>
    <con:config>
      <script>// File payment content property
import MQMessageUtils;

def filecontent = context.expand( '${Properties#messagetoSend#declare namespace ns1=\'urn:pin.payment.edb.com:authpain001wrapper:v1_0\'; //ns1:Wrapper[1]}' )


//def filecontent = context.expand( '${TestCase#messagetoSend}' )

// Set MQ properties
def mQHostName = context.expand( '${#Project#mqHostname}' )
def int mQPort = context.expand( '${#Project#mqPort}' ) as Integer
def mQQueuemanager = context.expand( '${#Project#mqManager}' )
def mQChannelAuth = context.expand( '${#Project#mqChannelAuth}' )
def mQMessageQueueSend = context.expand( '${#Project#sendQueuePAIN001}' )
def mQMessageQueueRecieve = context.expand( '${#Project#receiveQueuePAIN001}' )
def msgId = context.expand( '${Properties#MsgId}' )


// Create utility class object, Create MQ connection
MQMessageUtils mqMessageUtils = new MQMessageUtils(mQQueuemanager,mQHostName,mQPort,mQChannelAuth,log);
// Send Message to MQ
mqMessageUtils.sendMessage(mQMessageQueueSend,filecontent)
//// Receive message from MQ
//String receiveMessage = mqMessageUtils.browseMessage(mQMessageQueueRecieve,msgId);
//log.info "receiveMessage : " + receiveMessage
//def receivepain001 = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("receiveMessagePain002",receiveMessage);
//log.info msgId
//if (!(("No messsage").equals(receiveMessage))){
//	def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
//	def response = groovyUtils.getXmlHolder(receiveMessage)
//	log.info  response.getNodeValue("//*:OrgnlMsgId");
//	ArrayList&lt;String> txsStatus= response.getNodeValues("//*:TxSts");
//	ArrayList&lt;String> status= response.getNodeValues("//*:Cd");
//	ArrayList&lt;String> statusreason= response.getNodeValues("//*:AddtlInf");
//	log.info status;
//	log.info statusreason;
//	testRunner.testCase.getTestStepByName("Properties").setPropertyValue("txsActualStatus",txsStatus[0]);
//	testRunner.testCase.getTestStepByName("Properties").setPropertyValue("actualStatus",status[1]);
//	testRunner.testCase.getTestStepByName("Properties").setPropertyValue("actualStatusReason",statusreason[1]);
//// TO DO : Add more things here, Based on subsequest test steps, Take MessageIdentification sent and received message and give input to seaches.
//}
//// No message
//else log.info "No message received"</script>
    </con:config>
  </con:testStep>
  <con:testStep type="delay" name="Delay" id="af56a19a-26d8-4bc9-aa0f-47aa5886b95f">
    <con:settings/>
    <con:config>
      <delay>10000</delay>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="TRANSACTIONS" id="dde67f65-d6c4-492b-a4eb-9302f27cc32c">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWH-DATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_s1_19c)))</con:connectionString>
      <con:password>1</con:password>
      <con:connectionProperties/>
      <con:query>select m.MESSAGEID , p.paymentinfoid,t.transactionsid ,
t.ENDTOENDID ,
  t.PAYMENTTYPE,
  t.PAYMENTSTATUS,
  t.ISPC ,
t.FK_PROCESSINGLINEID from message m , paymentinfo p , transactions t where 
m.messageid = p.fk_messageid and 
p.paymentinfoid = t.fk_paymentinfoid and
t.ENDTOENDID LIKE '%${Properties#MsgID}%' ORDER by TRANSACTIONSID desc</con:query>
      <con:storedProcedure>false</con:storedProcedure>
      <con:assertion type="MessageContentAssertion" id="8e97c887-32b1-4c89-8f5a-4e8a7d8c4bc2" name="Message Content Assertion">
        <con:configuration xsi:type="con:MessageContentAssertion">
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/@fetchSize</con:xpath>
            <con:element>@fetchSize</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>10</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/TRANSACTIONSID[1]</con:xpath>
            <con:element>TRANSACTIONSID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>167195</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/ENDTOENDID[1]</con:xpath>
            <con:element>ENDTOENDID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>ETE_20200706MSG50</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/PAYMENTTYPE[1]</con:xpath>
            <con:element>PAYMENTTYPE</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>DOMS</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/PAYMENTSTATUS[1]</con:xpath>
            <con:element>PAYMENTSTATUS</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>REJC</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/ISPC[1]</con:xpath>
            <con:element>ISPC</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>PAYCTDOMOUPSME</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/FK_PROCESSINGLINEID[1]</con:xpath>
            <con:element>FK_PROCESSINGLINEID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>50</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:originalMessage><![CDATA[<Results>
   <ResultSet fetchSize="10">
      <Row rowNumber="1">
         <TRANSACTIONSID>167195</TRANSACTIONSID>
         <ENDTOENDID>ETE_20200706MSG50</ENDTOENDID>
         <PAYMENTTYPE>DOMS</PAYMENTTYPE>
         <PAYMENTSTATUS>REJC</PAYMENTSTATUS>
         <ISPC>PAYCTDOMOUPSME</ISPC>
         <FK_PROCESSINGLINEID>50</FK_PROCESSINGLINEID>
      </Row>
   </ResultSet>
</Results>]]></con:originalMessage>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="STATUSREASON_ADDT_INF" id="45bfa3e0-35df-41fc-97f2-9c80a04e81ed">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWH-DATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_s1_19c)))</con:connectionString>
      <con:password>1</con:password>
      <con:connectionProperties/>
      <con:query>select * from statusreason S, STATUSREASON_ADDT_INF SI where S.STATUSREASONID = SI.FK_STATUSREASONID and 
(S.FK_TRANSACTIONID = '${TRANSACTIONS#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/TRANSACTIONSID[1]}' 
OR S.FK_Paymentinfoid = '${TRANSACTIONS#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/PAYMENTINFOID[1]}' 
or s.FK_messageid = '${TRANSACTIONS#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/MESSAGEID[1]}') order by CODE desc</con:query>
      <con:storedProcedure>false</con:storedProcedure>
      <con:assertion type="Simple Contains" id="6029d52b-b4be-433d-b003-a199218341e9" name="Regulatory reporting information is required">
        <con:configuration>
          <token>&lt;ADDITIONALINFORMATION>Internal transfers require the debtor and creditor accounts to be within the same bank&lt;/ADDITIONALINFORMATION></token>
          <ignoreCase>false</ignoreCase>
          <useRegEx>false</useRegEx>
        </con:configuration>
      </con:assertion>
      <con:assertion type="MessageContentAssertion" id="bdf1e9af-1bff-4fa6-9fc2-15a049898eab" name="Message Content Assertion">
        <con:configuration xsi:type="con:MessageContentAssertion">
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/@fetchSize</con:xpath>
            <con:element>@fetchSize</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>10</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/STATUSREASONID[1]</con:xpath>
            <con:element>STATUSREASONID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>235786</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/CODE[1]</con:xpath>
            <con:element>CODE</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>AC14</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/SOURCESYSTEM[1]</con:xpath>
            <con:element>SOURCESYSTEM</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>PAIN</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/FK_MESSAGEID[1]</con:xpath>
            <con:element>FK_MESSAGEID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>exists</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue xsi:nil="true"/>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/FK_PAYMENTINFOID[1]</con:xpath>
            <con:element>FK_PAYMENTINFOID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>exists</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue xsi:nil="true"/>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/FK_TRANSACTIONID[1]</con:xpath>
            <con:element>FK_TRANSACTIONID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>437267</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/STATUSREASONADDTINFID[1]</con:xpath>
            <con:element>STATUSREASONADDTINFID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>128937</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/FK_STATUSREASONID[1]</con:xpath>
            <con:element>FK_STATUSREASONID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>235786</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/ADDITIONALINFORMATION[1]</con:xpath>
            <con:element>ADDITIONALINFORMATION</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>Internal transfers require the debtor and creditor accounts to be within the same bank</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>2</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/STATUSREASONID[1]</con:xpath>
            <con:element>STATUSREASONID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>235785</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/CODE[1]</con:xpath>
            <con:element>CODE</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>AC03</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/SOURCESYSTEM[1]</con:xpath>
            <con:element>SOURCESYSTEM</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>PAIN</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/FK_MESSAGEID[1]</con:xpath>
            <con:element>FK_MESSAGEID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>exists</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue xsi:nil="true"/>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/FK_PAYMENTINFOID[1]</con:xpath>
            <con:element>FK_PAYMENTINFOID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>exists</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue xsi:nil="true"/>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/FK_TRANSACTIONID[1]</con:xpath>
            <con:element>FK_TRANSACTIONID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>437267</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/STATUSREASONADDTINFID[1]</con:xpath>
            <con:element>STATUSREASONADDTINFID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>128936</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/FK_STATUSREASONID[1]</con:xpath>
            <con:element>FK_STATUSREASONID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>235785</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/ADDITIONALINFORMATION[1]</con:xpath>
            <con:element>ADDITIONALINFORMATION</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>Invalid creditor account number</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:originalMessage><![CDATA[<Results>
   <ResultSet fetchSize="10">
      <Row rowNumber="1">
         <STATUSREASONID>235786</STATUSREASONID>
         <CODE>AC14</CODE>
         <SOURCESYSTEM>PAIN</SOURCESYSTEM>
         <FK_MESSAGEID/>
         <FK_PAYMENTINFOID/>
         <FK_TRANSACTIONID>437267</FK_TRANSACTIONID>
         <STATUSREASONADDTINFID>128937</STATUSREASONADDTINFID>
         <FK_STATUSREASONID>235786</FK_STATUSREASONID>
         <ADDITIONALINFORMATION>Internal transfers require the debtor and creditor accounts to be within the same bank</ADDITIONALINFORMATION>
      </Row>
      <Row rowNumber="2">
         <STATUSREASONID>235785</STATUSREASONID>
         <CODE>AC03</CODE>
         <SOURCESYSTEM>PAIN</SOURCESYSTEM>
         <FK_MESSAGEID/>
         <FK_PAYMENTINFOID/>
         <FK_TRANSACTIONID>437267</FK_TRANSACTIONID>
         <STATUSREASONADDTINFID>128936</STATUSREASONADDTINFID>
         <FK_STATUSREASONID>235785</FK_STATUSREASONID>
         <ADDITIONALINFORMATION>Invalid creditor account number</ADDITIONALINFORMATION>
      </Row>
   </ResultSet>
</Results>]]></con:originalMessage>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:properties>
    <con:property>
      <con:name>ConnectionString</con:name>
      <con:value>jdbc:oracle:thin:pendata/pen@//10.246.89.97:1530/pen_g_functional</con:value>
    </con:property>
  </con:properties>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>7ac37089-fb5d-4637-a84a-61afd3ee482d</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>f888a32b-2993-46b3-b104-5404a38eccf3</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:environmentSpec>
    <con:entry environmentId="657a20b2-d63b-4bf3-808e-2c92b686c769">
      <con:authProfile>Inherit From Parent</con:authProfile>
    </con:entry>
  </con:environmentSpec>
</con:testCase>
