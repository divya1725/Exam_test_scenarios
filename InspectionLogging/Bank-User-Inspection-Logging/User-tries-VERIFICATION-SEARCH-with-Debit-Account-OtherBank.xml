<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="bda7e871-0369-4e9b-af5c-4614522f743b" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="User tries VERIFICATION SEARCH with Debit Account OtherBank" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:description>Verifies Inspection Log when Bank employee tries VERIFICATION search the payment by Debit Account Number  from other bank    </con:description>
  <con:settings>
    <con:setting id="bda7e871-0369-4e9b-af5c-4614522f743bfileName">User-tries-VERIFICATION-SEARCH-with-Debit-Account-OtherBank</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="properties" name="Properties" id="3270bcfa-a0da-4b81-965c-2b327ac36acf">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>SourceApplication</con:name>
          <con:value>PaymentClient</con:value>
        </con:property>
        <con:property>
          <con:name>UserID</con:name>
          <con:value>E212777</con:value>
        </con:property>
        <con:property>
          <con:name>credentials</con:name>
          <con:value>03111012010400425MqYdUf7Fa%2Bp6OVtVL1neI9CfuAtjCBO603eS0IgWm1WWIO7EfpSL4DE%2FlDFi69n1sSaabKNt2t%2BxJppso23a37EmmmyjbdrfF3M0FKxtlD%2FXuWLQyp%2BdabEmmmyjbdrfsSaabKNt2t%2FXzlyjxYnxhcG46wcbIKp%2FsSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu3EfQIWD5xMfsCCxt4O4gzUg%2F1jTq5A6P4%3DkelV7Nmqmkh3QFfLSbAhgxlQ3ww6vUSDMC93dYlb%2BtUC0ntFIMCnl6VBTAwtTskyT%2FiyApfrK0e2DS%2FA1GcD%2FZQSuK6GR8XA7SdnT%2BYzFGYqNdtX1MYoC5yWvqyFS%2F9TtRqqAdkzQT4P8BiTDuHACXrUBfleU2q4rPiK5KRoYsc%3D</con:value>
        </con:property>
        <con:property>
          <con:name>channel</con:name>
          <con:value>NBA</con:value>
        </con:property>
        <con:property>
          <con:name>orgid</con:name>
          <con:value>2544</con:value>
        </con:property>
        <con:property>
          <con:name>customerid</con:name>
          <con:value>09010306350</con:value>
        </con:property>
        <con:property>
          <con:name>item1</con:name>
          <con:value>PaymentChannel</con:value>
        </con:property>
        <con:property>
          <con:name>value1</con:name>
          <con:value>ITR</con:value>
        </con:property>
        <con:property>
          <con:name>item2</con:name>
          <con:value>LogRef</con:value>
        </con:property>
        <con:property>
          <con:name>value2</con:name>
          <con:value>${= CommonLibrary.getNorwayTime('HHmm')}</con:value>
        </con:property>
        <con:property>
          <con:name>item3</con:name>
          <con:value>AgreementId</con:value>
        </con:property>
        <con:property>
          <con:name>value3</con:name>
          <con:value>${Properties#customerid}</con:value>
        </con:property>
        <con:property>
          <con:name>item4</con:name>
          <con:value>Employee</con:value>
        </con:property>
        <con:property>
          <con:name>value4</con:name>
          <con:value>${Properties#UserID}</con:value>
        </con:property>
        <con:property>
          <con:name>item5</con:name>
          <con:value>SelfService</con:value>
        </con:property>
        <con:property>
          <con:name>value5</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>ReqExnDate</con:name>
          <con:value>${=CommonLibrary.getDate(1,'yyyy-MM-dd')}</con:value>
        </con:property>
        <con:property>
          <con:name>accountNumber</con:name>
          <con:value>24803883129</con:value>
        </con:property>
        <con:property>
          <con:name>currencyCode</con:name>
          <con:value>NOK</con:value>
        </con:property>
        <con:property>
          <con:name>CreditorAgent</con:name>
          <con:value>SPTRNO22XXX</con:value>
        </con:property>
        <con:property>
          <con:name>CreditorCountry</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>CreditorCurrency</con:name>
          <con:value>NOK</con:value>
        </con:property>
        <con:property>
          <con:name>CreditAccountNumber</con:name>
          <con:value>42021341821</con:value>
        </con:property>
        <con:property>
          <con:name>Amount</con:name>
          <con:value>20</con:value>
        </con:property>
        <con:property>
          <con:name>AgreementId</con:name>
          <con:value>${Properties#customerid}</con:value>
        </con:property>
        <con:property>
          <con:name>messageId</con:name>
          <con:value>385821</con:value>
        </con:property>
        <con:property>
          <con:name>transactionId</con:name>
          <con:value>260175082</con:value>
        </con:property>
        <con:property>
          <con:name>paymentinfoId</con:name>
          <con:value>432813</con:value>
        </con:property>
        <con:property>
          <con:name>paymentReference</con:name>
          <con:value>260175082</con:value>
        </con:property>
        <con:property>
          <con:name>LogRef</con:name>
          <con:value>1318</con:value>
        </con:property>
        <con:property>
          <con:name>serviceFunction</con:name>
          <con:value>paymentverificationList</con:value>
        </con:property>
        <con:property>
          <con:name>serviceDescription</con:name>
          <con:value>list payment verification</con:value>
        </con:property>
        <con:property>
          <con:name>GrepString</con:name>
          <con:value>grep -i -E '2544.*09010306350.*24803883129.*EVRY.*PCL.*E212777.*paymentverificationList.*(1317|1318|1319|1320).*list payment verification' inspection.log | tail -1</con:value>
        </con:property>
        <con:property>
          <con:name>InspectionLog</con:name>
          <con:value><![CDATA[<AccessLogRecord><InstitutionID>2544</InstitutionID><CustomerID>09010306350</CustomerID><AccountID>24803883129</AccountID><Source>EVRY</Source><System>PCL</System><UserID>E212777</UserID><Function>paymentverificationList</Function><DateTime>20200907131816</DateTime><Description>list payment verification</Description></AccessLogRecord>]]></con:value>
        </con:property>
        <con:property>
          <con:name>InspectionSource</con:name>
          <con:value>EVRY</con:value>
        </con:property>
        <con:property>
          <con:name>InspectionSystem</con:name>
          <con:value>PCL</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="Fetch Active Payments" id="c4f3164f-6e7d-41ad-944f-7b1bff75f326">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWH</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:PWHDATA/pwh@//10.246.89.97:1530/pwh_g_st</con:connectionString>
      <con:password>sad</con:password>
      <con:connectionProperties/>
      <con:query>select C.TRANSACTIONSID,C.PAYMENT_REF,B.PAYMENTINFOID,A.MESSAGEID,A.CUSTOMERID,C.DEBETACCOUNTNO,C.PAYMENTTYPE,C.PAYMENTSTATUS,C.INITIATORBANKID, C.DEBITAMOUNTCCY,AC.OTHER_ID,AC.IBAN,A.INITIATORID
from MESSAGE A,PAYMENTINFO B, TRANSACTIONS C,ACCOUNT_CREDITOR AC where 
A.MESSAGEID = B.FK_MESSAGEID and B.PAYMENTINFOID = C.FK_PAYMENTINFOID and 
AC.FK_TRANSACTIONSID = C.TRANSACTIONSID   and 
C.PAYMENTSTATUS = 'TBVE' and A.INITIATORID != '${Properties#UserID}' and 
C.INITIATORBANKID = '2544'  order by C.TRANSACTIONSID  desc fetch first row only</con:query>
      <con:assertion type="JDBC Status" id="6328a988-1e28-4718-9a78-4d0a3da788a3" name="JDBC Status"/>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="transfer" name="dataTransfer" id="2eef081f-11f9-475b-8d4f-f25f6c226f22">
    <con:settings/>
    <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>transactionId</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>Fetch Active Payments</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/TRANSACTIONSID[1]</con:sourcePath>
        <con:targetType>transactionId</con:targetType>
        <con:targetStep>Properties</con:targetStep>
        <con:targetPath/>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>messageId</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>Fetch Active Payments</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/MESSAGEID[1]</con:sourcePath>
        <con:targetType>messageId</con:targetType>
        <con:targetStep>Properties</con:targetStep>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>paymentInfoId</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>Fetch Active Payments</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/PAYMENTINFOID[1]</con:sourcePath>
        <con:targetType>paymentinfoId</con:targetType>
        <con:targetStep>Properties</con:targetStep>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>accountNum</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>Fetch Active Payments</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/DEBETACCOUNTNO[1]</con:sourcePath>
        <con:targetType>accountNumber</con:targetType>
        <con:targetStep>Properties</con:targetStep>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>customerId</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>Fetch Active Payments</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/CUSTOMERID[1]</con:sourcePath>
        <con:targetType>customerid</con:targetType>
        <con:targetStep>Properties</con:targetStep>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>currency</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>Fetch Active Payments</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/DEBITAMOUNTCCY[1]</con:sourcePath>
        <con:targetType>currencyCode</con:targetType>
        <con:targetStep>Properties</con:targetStep>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>paymentRef</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>Fetch Active Payments</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/PAYMENT_REF[1]</con:sourcePath>
        <con:targetType>paymentReference</con:targetType>
        <con:targetStep>Properties</con:targetStep>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="Authorization" id="338a673f-7e27-45ef-8c3f-0b44cec52a4c">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PAYSPaymentAuthorization_V1_2PortTypeSoap11</con:interface>
      <con:operation>PaymentAuthorizationCreate</con:operation>
      <con:request name="Authorization" id="d64b9349-5868-490f-99d4-49b641d7356b">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#pays.url}/pin/services/PAYSPaymentAuthorization_V1_2Service</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v21" xmlns:urn="urn:pays.payment.edb.com:ws:paymentauthorization:v1_2" xmlns:urn1="urn:pays.payment.edb.com:domain:paymentauthorization:v1_2" xmlns:urn2="urn:pays.payment.edb.com:domain:authorization:v1_2" xmlns:urn3="urn:pays.payment.edb.com:domain:authorization:v1_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${Properties#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PAYS</wsc:DestinationApplication>
         <wsc:Function>paymentAuthorizationCreate</wsc:Function>
         <wsc:Version>1.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${Properties#UserID}</wsc:userid>
            <wsc:credentials>${Properties#credentials}</wsc:credentials>
            <wsc:channel>${Properties#channel}</wsc:channel>
            <wsc:orgid>${Properties#orgid}</wsc:orgid>
            <!--Optional:-->
            <wsc:orgunit xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <!--Optional:-->
            <wsc:customerid>${Properties#customerid}</wsc:customerid>
            <!--Optional:-->
            <wsc:locale xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <wsc:ip>1.1.1.1</wsc:ip>
            <!--Zero or more repetitions:-->
            <wsc:item key="${Properties#item1}" value="${Properties#value1}"/>
            <wsc:item key="${Properties#item2}" value="${Properties#value2}"/>
            <wsc:item key="${Properties#item3}" value="${Properties#value3}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:PaymentAuthorizationCreateRequest>
         <urn:cpsAuthorizationMessage>
            <urn1:cpsUserAuthorizationData>
               <urn2:agreementData>
                  <urn3:agreementId>${Properties#AgreementId}</urn3:agreementId>
                  <urn3:bankId>${Properties#orgid}</urn3:bankId>
                  <urn3:customerID>${Properties#customerid}</urn3:customerID>
                  <urn3:productID>1234</urn3:productID>
                  <urn3:migrationDate>2019-02-03+05:00</urn3:migrationDate>
               </urn2:agreementData>
               <urn2:userId>${Properties#UserID}</urn2:userId>
               <urn2:sessionID>qw24213</urn2:sessionID>
               <urn2:firstName>Fname</urn2:firstName>
               <urn2:lastName>Lname</urn2:lastName>
               <urn2:userAccount>
                  <urn2:accountNumber>${Properties#accountNumber}</urn2:accountNumber>
                  <urn2:accountOwnerIdentifier>991144013</urn2:accountOwnerIdentifier>
                  <urn2:currencyCode>${Properties#currencyCode}</urn2:currencyCode>
                  <urn2:accountType>CoreAccount</urn2:accountType>
                  <urn2:role>View</urn2:role>
                  <urn2:role>Register</urn2:role>
                  <urn2:role>Appprove</urn2:role>
                  <urn2:role>Transfer</urn2:role>
                  <urn2:role>Salary</urn2:role>
                  <urn2:approvalLimit>99999</urn2:approvalLimit>
                  <urn2:registerLimit>99999</urn2:registerLimit>
                  <urn2:numberOfVerifiers>1</urn2:numberOfVerifiers>
                  <urn2:numberOfApprovers>1</urn2:numberOfApprovers>
                  <urn2:bookingLevel>D</urn2:bookingLevel>
               </urn2:userAccount>
            </urn1:cpsUserAuthorizationData>
         </urn:cpsAuthorizationMessage>
      </urn:PaymentAuthorizationCreateRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="SOAP Response" id="74ab129a-6510-4943-911c-930ea74e373e"/>
        <con:credentials>
          <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
        <con:environmentSpec>
          <con:entry environmentId="bab00d5a-ca3b-4a45-9b61-6d643ac5ab87">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="71b4f24c-5706-4f06-88d6-a4d2fde0fe4b">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="ca264e55-9942-4681-a7bb-84d8e92fbb36">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="0d2a83b1-0b94-4ddb-a3b8-2b6d39688af8">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="b7ee27fc-11cc-479a-908d-0464b4ef8931">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="88d50a84-f41a-4a39-ba5f-8b1fb1069302">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="4c71e673-5dd7-462e-86e7-316510af0b4b">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="c05d7630-7a50-443b-a3ae-c915912d2fc2">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="000a42ad-b2ac-4dbd-a9d8-fb77d94ff95e">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="23ec9ac6-fa12-442e-abea-92ed4afbc2c0">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="912e725c-0af7-47b9-98c1-63202f718438">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="83180fcb-9ca1-4f1d-8de7-8f78a367f80b">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="bb72e457-8659-41a8-b968-fca7845456a3">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="81de96df-6d43-4c0d-858f-3654e1a4a45f">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="bbf112eb-3cdd-4b64-a488-c03a5ec8871e">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="1966934d-f07b-431a-90ab-d87dbdfee2b9">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="18f02722-5716-4f94-85de-dd472eae0e1a" name="VerificationSearch_V_2_0">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentSearch_V2_0PortTypeSoap11</con:interface>
      <con:operation>PaymentVerificationSearch</con:operation>
      <con:request name="VerificationSearch_V_2_0" id="bc1ec820-0d5d-4d68-a5a8-484f02b9a992">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://10.246.89.107:23621/pin/services/PINSPaymentSearch_V2_0</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentsearch:v2_0" xmlns:urn1="urn:pins.payment.evry.com:domain:search:v2_0" xmlns:urn2="urn:pins.payment.evry.com:domain:common:v2_0" xmlns:urn3="urn:pins.payment.evry.com:domain:complex-types:v2_0">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${Properties#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PAYS</wsc:DestinationApplication>
         <wsc:Function>paymentAuthorizationCreate</wsc:Function>
         <wsc:Version>1.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${Properties#UserID}</wsc:userid>
            <wsc:credentials>${Properties#credentials}</wsc:credentials>
            <wsc:channel>${Properties#channel}</wsc:channel>
            <wsc:orgid>${Properties#orgid}</wsc:orgid>
            <!--Optional:-->
            <wsc:orgunit xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <!--Optional:-->
            <wsc:customerid>${Properties#customerid}</wsc:customerid>
            <!--Optional:-->
            <wsc:locale xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <wsc:ip>1.1.1.1</wsc:ip>
            <!--Zero or more repetitions:-->
            <wsc:item key="${Properties#item1}" value="${Properties#value1}"/>
            <wsc:item key="${Properties#item2}" value="${Properties#value2}"/>
            <wsc:item key="${Properties#item3}" value="${Properties#value3}"/>
            <wsc:item key="${Properties#item4}" value="${Properties#value4}"/>
            <wsc:item key="${Properties#item5}" value="${Properties#value5}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:PaymentVerificationSearchRequest>
         <urn:searchCriteria>
            <urn1:verificationSearchCriteria>
               <urn1:elementControl>
                  <urn2:StartIndex>0</urn2:StartIndex>
                  <urn2:MaximumNumberOfElements>25</urn2:MaximumNumberOfElements>
               </urn1:elementControl>
               <!--Zero or more repetitions:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               
               <urn1:debtorAccount>${Properties#accountNumber}</urn1:debtorAccount><urn1:sortingField>TRANSACTION_ID</urn1:sortingField><urn1:sortingDirection>DESCENDING</urn1:sortingDirection><urn1:requestedExecutionDate>
                  <!--You have a CHOICE of the next 2 items at this level-->
                  <!--Optional:-->
                  
                  <!--Optional:-->
                  
               </urn1:requestedExecutionDate>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn1:amount>
                  <!--You have a CHOICE of the next 4 items at this level-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <urn3:amountMaxMin>
                     <!--Optional:-->
                     <!--Optional:-->
                  </urn3:amountMaxMin>
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
               </urn1:amount>
               <!--Optional:-->
            </urn1:verificationSearchCriteria>
         </urn:searchCriteria>
      </urn:PaymentVerificationSearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Valid HTTP Status Codes" id="9acf6ec3-3226-4c41-8207-bafb2fd11d8a" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="SOAP Fault Assertion" id="de99696f-393d-4329-990c-c8c7d69d3c1e" name="Not SOAP Fault"/>
        <con:assertion type="Schema Compliance" id="f36ae156-e68e-4f30-b941-1f3debd075ec" name="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" id="6c0294e4-683c-4ecd-8763-2e1274bdfdbd" name="Match content of [ErrorCode]">
          <con:configuration>
            <path>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns5='urn:pins.payment.evry.com:ws:paymentsearch:v2_0';
//ns5:PaymentVerificationSearchResponse[1]/ns2:ResponseState[1]/ns1:ErrorCode[1]/text()</path>
            <content>0</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig action="urn:pins.payment.evry.com:ws:paymentsearch:v2_0/PINSPaymentSearch_V2_0PortType/PaymentVerificationSearchRequest" mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="transfer" name="logRefTransfer" id="699abb59-5211-4fd8-88fa-6d9495ca4658">
    <con:settings/>
    <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>logRef</con:name>
        <con:sourceType>RawRequest</con:sourceType>
        <con:sourceStep>VerificationSearch_V_2_0</con:sourceStep>
        <con:sourcePath>declare namespace wsc='http://edb.com/ws/WSCommon_v22';
//wsc:AutHeader[1]/wsc:ClientContext[1]/wsc:item[2]/@value</con:sourcePath>
        <con:targetType>LogRef</con:targetType>
        <con:targetStep>Properties</con:targetStep>
        <con:targetPath/>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
    </con:config>
  </con:testStep>
  <con:testStep type="delay" name="WaitForInspectionLog" id="e9fcddba-5206-4ec1-855c-c4dadfb76938">
    <con:settings/>
    <con:config>
      <delay>${#TestSuite#waitForLog}</delay>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="CreateGrepString" id="96e65a95-d5f7-475c-8e73-bada6ab9fb16">
    <con:settings/>
    <con:config>
      <script>def orgid = context.expand( '${Properties#orgid}' )
def customerid = context.expand( '${Properties#customerid}' )
def accountNumber = context.expand( '${Properties#accountNumber}' )
def userID = context.expand( '${Properties#UserID}' )
def serviceFunction = context.expand( '${Properties#serviceFunction}' )
def serviceDescription = context.expand( '${Properties#serviceDescription}' )
def inspectionSource = context.expand( '${Properties#InspectionSource}' )
def inspectionSystem = context.expand( '${Properties#InspectionSystem}' )

def logRef = context.expand( '${Properties#LogRef}' )
try{System.sleep(200)}catch(Exception ex){}
def nextTime = CommonLibrary.getNextTime(logRef)
try{System.sleep(200)}catch(Exception ex){}

def grepString = "grep -i -E '${orgid}.*${customerid}.*${accountNumber}.*${inspectionSource}.*${inspectionSystem}.*${userID}.*${serviceFunction}.*(${nextTime}).*${serviceDescription}' inspection.log | tail -1"
log.info "Grep String:" + grepString
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("GrepString", grepString)</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Fetch Inspection Log" id="cb9e316f-a9b6-4fe2-b362-f2e608058248">
    <con:settings/>
    <con:config>
      <script>import groovy.json.JsonSlurper

def strHost = context.expand( '${#Project#EOSHost}' )
def strUsername = context.expand( '${#Project#UserName}' )
def strPassword = context.expand( '${#Project#Password}' )
def  intPort = context.expand( '${#Project#Port}' )

def env = testRunner.testCase.testSuite.project.getActiveEnvironmentName().toLowerCase()
env = env.substring(2)
def strFileDirectory = '/eos/' + env + '/pin/i1/logs/pin'

def strLogRef = context.expand( '${Properties#LogRef}' )
 
if (!(ServerConnect.Connect(strHost ,strUsername, strPassword, Integer.parseInt(intPort)) == "PASS"))
	assert false," Failed to conenct to linux server!!"
else
 log.info "Connected to the server successfully!!"

def grepString = context.expand( '${Properties#GrepString}' )
 grepString = 'cd ' + strFileDirectory + ';' + grepString

def InspectionLog = ServerConnect.execCommand(grepString)
log.info "InspectionLog is :" + InspectionLog
ServerConnect.closeConnection()

assert InspectionLog.trim() != "", "Inspection log not found in Inspection.log!!, Grep Command:" + grepString
log.info "Verified Inspection log successfully!!"
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("InspectionLog", InspectionLog)</script>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>232997f6-864f-4682-951a-6904fd2d89ec</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>367a09f7-5ca2-4453-982f-0222345a48b3</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>236b4125-d511-4402-a4ee-74e12c5ecbb4</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>ba3188b6-5bad-4c55-bed0-a5a82a0303c6</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>00adb91e-ec47-4c8c-ae9e-740f3001a9d6</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>31a1c436-577b-4fb5-b9f5-8bd1fe8ecb5e</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
