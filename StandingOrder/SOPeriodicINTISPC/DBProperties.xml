<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="0a4cb67e-a45d-481c-af19-615e289ac87e" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="DBProperties" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="3175b877-d802-4aef-86c4-cbe9c1d5013ffileName">DB_Properties</con:setting>
    <con:setting id="7dd87b31-40d6-422a-8c46-fe7458cb22befileName">DB_Properties</con:setting>
    <con:setting id="0a4cb67e-a45d-481c-af19-615e289ac87efileName">DBProperties</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="jdbc" name="FetchAccount" id="76fad83d-b032-471c-8062-07f7ea7b74a3">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWHDATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP) (HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_d6)))</con:connectionString>
      <con:password/>
      <con:connectionProperties/>
      <con:query>select CUSTOMERID,ACCOUNTNUMBER,FIRSTNAME,CURRENCY  from V_authorisation where CUSTBANKID='4201' and CURRENCY = 'NOK' and length(customerID)='11' and CLOSED != 'Y' and ROWNUM=1</con:query>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="FetchAccount_USD" id="b5a4b55b-c673-4661-ba5b-2434e693e38f" disabled="true">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWHDATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP) (HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_d6)))</con:connectionString>
      <con:password/>
      <con:connectionProperties/>
      <con:query>select CUSTOMERID,ACCOUNTNUMBER,FIRSTNAME,CURRENCY  from V_authorisation where CUSTBANKID='4201' and CURRENCY = 'USD' and length(customerID)='11' and ROWNUM=1</con:query>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="SetAccount" id="03e0f48b-7d74-4cb6-bd07-729f5e271442">
    <con:settings/>
    <con:config>
      <script>def customerID = context.expand( '${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CUSTOMERID[1]}' )
def debtorAccountNumber = context.expand( '${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}' )
def debtorAccountCcy = context.expand( '${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CURRENCY[1]}' )

customerID= customerID.toString().replaceAll("[^a-zA-Z0-9]+","")
debtorAccountNumber= debtorAccountNumber.toString().replaceAll("[^a-zA-Z0-9]+","")
debtorAccountCcy=  debtorAccountCcy.toString().replaceAll("[^a-zA-Z0-9]+","")

def UserID = customerID.substring(5) as int
UserID = UserID.toString().replaceAll("[^a-zA-Z0-9]+","")
testRunner.testCase.testSuite.setPropertyValue("customerid",customerID)
testRunner.testCase.testSuite.setPropertyValue("UserID",UserID)
testRunner.testCase.testSuite.setPropertyValue("AgreementId",UserID)
testRunner.testCase.testSuite.setPropertyValue("accountNumber",debtorAccountNumber)
testRunner.testCase.testSuite.setPropertyValue("currencyCode",debtorAccountCcy)</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="SetAccount_USD" id="42d7e8db-ea15-4b54-9ae5-fa0c1174ba25" disabled="true">
    <con:settings/>
    <con:config>
      <script>def customerID = context.expand( '${FetchAccount_USD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CUSTOMERID[1]}' )

def debtorAccountNumber = context.expand( '${FetchAccount_USD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}' )

def debtorAccountCcy = context.expand( '${FetchAccount_USD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CURRENCY[1]}' )


customerID= customerID.toString().replaceAll("[^a-zA-Z0-9]+","")
debtorAccountNumber= debtorAccountNumber.toString().replaceAll("[^a-zA-Z0-9]+","")
debtorAccountCcy=  debtorAccountCcy.toString().replaceAll("[^a-zA-Z0-9]+","")

def UserID = customerID.substring(5) as int
UserID = UserID.toString().replaceAll("[^a-zA-Z0-9]+","")
log.info "UserID : "+ UserID
testRunner.testCase.testSuite.setPropertyValue("customerid_USD",customerID)
testRunner.testCase.testSuite.setPropertyValue("UserID_USD",UserID)
testRunner.testCase.testSuite.setPropertyValue("AgreementId_USD",UserID)
testRunner.testCase.testSuite.setPropertyValue("accountNumber_USD",debtorAccountNumber)
testRunner.testCase.testSuite.setPropertyValue("currencyCode_USD",debtorAccountCcy)
log.info (testRunner.testCase.testSuite.getPropertyValue("accountNumber_USD"))</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Groovy Script" id="8a32c782-edbd-4009-a1d4-f375ce1747a0">
    <con:settings/>
    <con:config>
      <script>def Delay = '2000' as String
log.info Delay
int j = testRunner.testCase.testSuite.testCaseCount
log.info(j)
for (int i =1 ; i&lt;j ;i++)
{
testRunner.testCase.testSuite.getTestCaseAt(i).getTestStepByName("Properties").setPropertyValue("Delay",Delay)
}</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="1Groovy Script" id="13d8ee8c-5e32-407a-b9ca-3fae36dbd305">
    <con:settings/>
    <con:config>
      <script>//def Delay = '2000' as String
//log.info Delay
int j = testRunner.testCase.testSuite.testCaseCount
log.info(j)
for (int i =2 ; i&lt;j ;i++)
{
def originalTestStep = testRunner.testCase.testSuite.project
        .getTestSuiteByName("SOPeriodicINTISPC").getTestCaseByName("SOPeriodicPAYCTINTOUPHP_V2_0")
        .getTestStepByName("Delay")

testRunner.testCase.testSuite.project
        .getTestSuiteByName("SOPeriodicINTISPC").getTestCaseAt(i)
        .cloneStep(originalTestStep, "Delay")
}</script>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>183b998d-aa14-4d0a-9f81-6123c4b0caa6</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>0428fa36-16c5-4905-ac8c-f384048b3f33</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>