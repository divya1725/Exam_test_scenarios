<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="1c615f79-5536-4742-ae03-57426cca4f0b" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="DBProperties" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="1c615f79-5536-4742-ae03-57426cca4f0bfileName">DBProperties</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="properties" name="Properties" id="a6d5adb6-ae4d-4505-8063-b2ff355e0cc3">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>SourceApplication</con:name>
          <con:value>EVRYCPS</con:value>
        </con:property>
        <con:property>
          <con:name>userid</con:name>
          <con:value>${DataSource#customerId}</con:value>
        </con:property>
        <con:property>
          <con:name>credentials</con:name>
          <con:value>03110012010400425kglPboRi3h1Z4YUjUpQ0UB65Ta2kPKj1KWwkWemtrL+SoWqMxx/KuqxUVbNyTu6DsSaabKNt2t+xJppso23a37EmmmyjbdrffJeRiGWfHDGwxCWOpDYc2jgSxAz1+8eEsSaabKNt2t/XzlyjxYnxhcG46wcbIKp/sSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu2xJppso23a37Emmmyjbdrf8wP73CNrvpw=apG4tU0NraPbbqKUp39erKDFa7xy6z+r4VDMr/6qBlkFniGaNeDXv4cZcZZQQI6JtwB3JYQk6WqLA7oyp1FWRM6n46ehgNmHVNly8fTnQbIuGJSF2LUyGI7aE92/dgtp8jv9bsGpNe58K+xb4LeIHwjb2nVVvt4/2oLtDQ8IPJE=</con:value>
        </con:property>
        <con:property>
          <con:name>orgid</con:name>
          <con:value>4201</con:value>
        </con:property>
        <con:property>
          <con:name>customerid</con:name>
          <con:value>${DataSource#customerId}</con:value>
        </con:property>
        <con:property>
          <con:name>debitAccount</con:name>
          <con:value>${DataSource#debitAccount}</con:value>
        </con:property>
        <con:property>
          <con:name>DebitAcntccy</con:name>
          <con:value>${DataSource#currency}</con:value>
        </con:property>
        <con:property>
          <con:name>CreditAccount</con:name>
          <con:value>42010308121</con:value>
        </con:property>
        <con:property>
          <con:name>item1</con:name>
          <con:value>PaymentChannel</con:value>
        </con:property>
        <con:property>
          <con:name>value1</con:name>
          <con:value>BES</con:value>
        </con:property>
        <con:property>
          <con:name>item2</con:name>
          <con:value>AgreementId</con:value>
        </con:property>
        <con:property>
          <con:name>value2</con:name>
          <con:value>${DataSource#customerId}</con:value>
        </con:property>
        <con:property>
          <con:name>item3</con:name>
          <con:value>LogRef</con:value>
        </con:property>
        <con:property>
          <con:name>value3</con:name>
          <con:value>${=java.util.UUID.randomUUID().toString()}</con:value>
        </con:property>
        <con:property>
          <con:name>item4</con:name>
          <con:value>SelfService</con:value>
        </con:property>
        <con:property>
          <con:name>value4</con:name>
          <con:value>true</con:value>
        </con:property>
        <con:property>
          <con:name>ReqExnDate</con:name>
          <con:value>${= java.time.LocalDateTime.now().plusDays(1).format(java.time.format.DateTimeFormatter.ofPattern('yyyy-MM-dd'))}</con:value>
        </con:property>
        <con:property>
          <con:name>UpdateDate</con:name>
          <con:value>${= java.time.LocalDateTime.now().format(java.time.format.DateTimeFormatter.ofPattern('dd-MMM-yy'))}</con:value>
        </con:property>
        <con:property>
          <con:name>amount</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>SourceApplicationDeps</con:name>
          <con:value>PIN</con:value>
        </con:property>
        <con:property>
          <con:name>userIdDeps</con:name>
          <con:value>D210PAY</con:value>
        </con:property>
        <con:property>
          <con:name>destinationApplicationDeps</con:name>
          <con:value>CWSJ5</con:value>
        </con:property>
        <con:property>
          <con:name>credentialsDeps</con:name>
          <con:value>03111012010400425kglPboRi3h16OVtVL1neI9CfuAtjCBO603eS0IgWm1WWIO7EfpSL4DE%2FlDFi69n1sSaabKNt2t%2BxJppso23a37EmmmyjbdrfkkqxxhMk30WewZFnEDBXjbEmmmyjbdrfsSaabKNt2t%2FXzlyjxYnxhcG46wcbIKp%2FsSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu3EfQIWD5xMfokmgZRGVVmx5Sj3%2Fl0ONFk%3DNEDNSxp9dSZrTgTc8FQZH2%2BcCJH2i6JVeQujJsOFspnZLIrJ%2FuKwomqnqBEUfwp16lFG7oNme1nGipyowyfruYRWpd%2FshZpSAsnaArB%2B54u6Czd6k8LQ9TprK1E3RG6YggyW9FDg58it2antT1iUPbCr7fc9RkGMxwJwGZ8h0vU%3D</con:value>
        </con:property>
        <con:property>
          <con:name>addAmount</con:name>
          <con:value>8.599168E7</con:value>
        </con:property>
        <con:property>
          <con:name>channel</con:name>
          <con:value>NBA</con:value>
        </con:property>
        <con:property>
          <con:name>transactionId</con:name>
          <con:value>260197808</con:value>
        </con:property>
        <con:property>
          <con:name>BalanceCheckvalue</con:name>
          <con:value>INT</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="FetchAccount" id="00c4335f-5e66-4d14-9118-93cb550f0425">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWHDATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_d6)))</con:connectionString>
      <con:password>dgfd</con:password>
      <con:connectionProperties/>
      <con:query>select CUSTOMERID,ACCOUNTNUMBER,CURRENCY  from V_authorisation 
where CUSTBANKID='${#TestSuite#orgid}' 
and currency = 'NOK'
and length(customerID)='11' AND ACCOUNTNUMBER not like '4068%'
and ROWNUM =1</con:query>
      <con:assertion type="JDBC Status" id="97a7eb42-d4d6-4ba5-b5b5-f3d726739cd8" name="JDBC Status"/>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="FetchAccount_4701" id="c4423f57-5a5a-4198-9868-a54d844d538d">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>PWHDATA</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_d6)))</con:connectionString>
      <con:password>dgfd</con:password>
      <con:connectionProperties/>
      <con:query>select CUSTOMERID,ACCOUNTNUMBER,CURRENCY  from V_authorisation 
where CUSTBANKID='4701' 
and length(customerID)='11' AND ACCOUNTNUMBER not like '4068%'
and ROWNUM =1</con:query>
      <con:assertion type="JDBC Status" id="97a7eb42-d4d6-4ba5-b5b5-f3d726739cd8" name="JDBC Status"/>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="SetProperties" id="d70c87f1-04c0-4b23-befd-e3b03469af67">
    <con:settings/>
    <con:config>
      <script>import java.text.SimpleDateFormat

def customerID = context.expand( '${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CUSTOMERID[1]}' )
def debtorAccountNumber = context.expand( '${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}' )
def currency = context.expand( '${FetchAccount#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CURRENCY[1]}' )
def creditAccount = context.expand( '${FetchAccount_4701#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}' )

testRunner.testCase.testSuite.setPropertyValue("customerid",customerID)
testRunner.testCase.testSuite.setPropertyValue("userid",customerID)
testRunner.testCase.testSuite.setPropertyValue("value2",customerID)
testRunner.testCase.testSuite.setPropertyValue("agreementid",customerID)
testRunner.testCase.testSuite.setPropertyValue("debitAccount",debtorAccountNumber)
testRunner.testCase.testSuite.setPropertyValue("debitCurrency",currency)
testRunner.testCase.testSuite.setPropertyValue("creditAccount4701",creditAccount)


Date date = new Date();
SimpleDateFormat fn = new SimpleDateFormat("ddMyyhhmmss");
def datetime = fn.format(date)
log.info datetime

def EndtoEndID = "Search"+datetime;
log.info EndtoEndID
testRunner.testCase.testSuite.setPropertyValue("endtoendID",EndtoEndID );</script>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>a6d5adb6-ae4d-4505-8063-b2ff355e0cc3</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>c4423f57-5a5a-4198-9868-a54d844d538d</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>