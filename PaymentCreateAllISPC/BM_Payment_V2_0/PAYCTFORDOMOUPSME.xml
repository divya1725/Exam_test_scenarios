<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="74a08865-e793-4ba0-9973-bc21d7aafdfd" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="PAYCTFORDOMOUPSME" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="FlowLayout">false</con:setting>
    <con:setting id="56802dc7-75d7-46b4-ae05-e28727543fb0fileName">PAYCTFORDOMOUPSME</con:setting>
    <con:setting id="74a08865-e793-4ba0-9973-bc21d7aafdfdfileName">PAYCTFORDOMOUPSME</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="request" name="Auth" id="606a9697-bc5e-431d-96c1-9566ac863b7e">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PAYSPaymentAuthorization_V1_2PortTypeSoap11</con:interface>
      <con:operation>PaymentAuthorizationCreate</con:operation>
      <con:request name="Auth" id="d64b9349-5868-490f-99d4-49b641d7356b">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#pays.url}/pin/services/PAYSPaymentAuthorization_V1_2Service</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v21" xmlns:urn="urn:pays.payment.edb.com:ws:paymentauthorization:v1_2" xmlns:urn1="urn:pays.payment.edb.com:domain:paymentauthorization:v1_2" xmlns:urn2="urn:pays.payment.edb.com:domain:authorization:v1_2" xmlns:urn3="urn:pays.payment.edb.com:domain:authorization:v1_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>paymentAuthorizationCreate</wsc:Function>
         <wsc:Version>1.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>55057203187</wsc:userid>
            <wsc:credentials>03111012010400425kbKcJMZoMF56OVtVL1neI9CfuAtjCBO603eS0IgWm1WWIO7EfpSL4DE/lDFi69n1sSaabKNt2t+xJppso23a37EmmmyjbdrfF3M0FKxtlD/HJbEkbc46/BMCstNp869esSaabKNt2t/XzlyjxYnxhcG46wcbIKp/sSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu3EfQIWD5xMfslE2lt0gldZQIyIMvAwCMo=Owe13MJu4QRF5Vj5fdm42aK3nL6InZ7iUXQ2d3QvsDlp4SRrFo03WNE0BwBvlyk3Y5tHWP+DVGwZTtsKKiL4yr1VcsAzMmjub6dAdZ8J2NSTeOl14BcfV4hHDqgvdtQ6wTLSNlDSmdoQHUgDHgLgF/oRUnWDutHal9uw/ZEemPI=</wsc:credentials>
            <wsc:channel>BES</wsc:channel>
            <wsc:orgid>2544</wsc:orgid>
            <!--Optional:-->
            <wsc:orgunit>2544</wsc:orgunit>
            <!--Optional:-->
            <wsc:customerid>55057203187</wsc:customerid>
            <!--Optional:-->
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <!--Zero or more repetitions:-->
            
            
            <wsc:item key="PaymentChannel" value="BES"/>
            <wsc:item key="LogRef" value="2544bank"/>
            <wsc:item key="AgreementId" value="55057203187"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:PaymentAuthorizationCreateRequest>
         <urn:cpsAuthorizationMessage>
            <urn1:cpsUserAuthorizationData>
               <urn2:agreementData>
                  <urn3:agreementId>55057203187</urn3:agreementId>
                  <urn3:bankId>2544</urn3:bankId>
                  <urn3:customerID>55057203187</urn3:customerID>
                  <urn3:productID>1234</urn3:productID>
                  <urn3:migrationDate>2019-02-03+05:00</urn3:migrationDate>
               </urn2:agreementData>
               <urn2:userId>55057203187</urn2:userId>
               <urn2:sessionID>qw24213</urn2:sessionID>
               <urn2:firstName>Fname</urn2:firstName>
               <urn2:lastName>Lname</urn2:lastName>
               <urn2:userAccount>
                  <urn2:accountNumber>36281079039</urn2:accountNumber>
                  <urn2:accountOwnerIdentifier>55057203187</urn2:accountOwnerIdentifier>
                  <urn2:bic>SPAVNOBBXXX</urn2:bic><urn2:currencyCode>NOK</urn2:currencyCode>
                  <urn2:accountType>CoreAccount</urn2:accountType>
                  <urn2:role>View</urn2:role><urn2:role>Register</urn2:role><urn2:role>Appprove</urn2:role><urn2:role>Salary</urn2:role><urn2:role>Transfer</urn2:role><urn2:approvalLimit>99999</urn2:approvalLimit>
                  <urn2:registerLimit>99999</urn2:registerLimit>
                  <urn2:numberOfVerifiers>0</urn2:numberOfVerifiers>
                  <urn2:numberOfApprovers>1</urn2:numberOfApprovers>
               </urn2:userAccount>
            </urn1:cpsUserAuthorizationData>
         </urn:cpsAuthorizationMessage>
      </urn:PaymentAuthorizationCreateRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="SOAP Response" id="74ab129a-6510-4943-911c-930ea74e373e"/>
        <con:credentials>
          <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
        <con:environmentSpec>
          <con:entry environmentId="bab00d5a-ca3b-4a45-9b61-6d643ac5ab87">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="71b4f24c-5706-4f06-88d6-a4d2fde0fe4b">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="ca264e55-9942-4681-a7bb-84d8e92fbb36">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="0d2a83b1-0b94-4ddb-a3b8-2b6d39688af8">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="b7ee27fc-11cc-479a-908d-0464b4ef8931">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="88d50a84-f41a-4a39-ba5f-8b1fb1069302">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="4c71e673-5dd7-462e-86e7-316510af0b4b">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="c05d7630-7a50-443b-a3ae-c915912d2fc2">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="915ed5f3-ddc7-4ef3-9682-02c5d133f08a">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="6b2b23f8-6644-44f6-9927-94a78f2c0d2f">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="0f7f162e-4ba5-4580-83b9-b3009c02644c">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="10e021b5-003e-4a32-8696-bcbff8ff0a72">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="32f3cb92-2770-48c1-8141-ee901ac8f176">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="b932fe71-d995-46e4-b3d3-a68be0aa10db">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="4efa0d5a-6e21-4153-ad82-cb126899cb00">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="5d79d5a7-91a1-4c2b-b0f8-0d05609f1d17">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="1210f649-d535-4251-9341-f90db188ab86">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="baf0b73d-d5e4-4f35-99c2-f4c880adbeaa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="b9f42815-a17d-4447-9f96-07d455d6a705">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="Create" id="349fe58f-4b5a-48e1-b708-c7231ef33f3d">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPayment_V1_10PortTypeSoap11</con:interface>
      <con:operation>PaymentCreate</con:operation>
      <con:request name="Create" id="ec390d15-b05f-42a3-9b79-847960d498dd">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://10.246.89.107:23621/pin/services/PINSPayment_V1_10</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v21" xmlns:urn="urn:pins.payment.evry.com:ws:paymentinitiation:v1_10" xmlns:urn1="urn:pins.payment.evry.com:domain:paymentinitiation:v1_10" xmlns:urn2="urn:pins.payment.evry.com:domain:sepa-complex-types:v8" xmlns:urn3="urn:pins.payment.evry.com:domain:debtor:v1_8" xmlns:urn4="urn:pins.payment.evry.com:domain:creditor:v1_8">\r
   <soapenv:Header>\r
      <wsc:AutHeader>\r
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>\r
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>\r
         <wsc:Function>paymentAuthorizationCreate</wsc:Function>\r
         <wsc:Version>1.0</wsc:Version>\r
         <wsc:ClientContext>\r
            <wsc:userid>55057203187</wsc:userid>\r
            <wsc:credentials>03111012010400425kbKcJMZoMF56OVtVL1neI9CfuAtjCBO603eS0IgWm1WWIO7EfpSL4DE/lDFi69n1sSaabKNt2t+xJppso23a37EmmmyjbdrfF3M0FKxtlD/HJbEkbc46/BMCstNp869esSaabKNt2t/XzlyjxYnxhcG46wcbIKp/sSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu3EfQIWD5xMfslE2lt0gldZQIyIMvAwCMo=Owe13MJu4QRF5Vj5fdm42aK3nL6InZ7iUXQ2d3QvsDlp4SRrFo03WNE0BwBvlyk3Y5tHWP+DVGwZTtsKKiL4yr1VcsAzMmjub6dAdZ8J2NSTeOl14BcfV4hHDqgvdtQ6wTLSNlDSmdoQHUgDHgLgF/oRUnWDutHal9uw/ZEemPI=</wsc:credentials>\r
            <wsc:channel>BES</wsc:channel>\r
            <wsc:orgid>2544</wsc:orgid>\r
            <!--Optional:-->\r
            <wsc:orgunit>2544</wsc:orgunit>\r
            <!--Optional:-->\r
            <wsc:customerid>55057203187</wsc:customerid>\r
            <!--Optional:-->\r
            <wsc:locale>en</wsc:locale>\r
            <wsc:ip>1.1.1.1</wsc:ip>\r
            <!--Zero or more repetitions:-->\r
            <wsc:item key="TppId" value="1"/>\r
            <wsc:item key="TppName" value="ABC"/>\r
            <wsc:item key="PaymentChannel" value="BES"/>\r
            <wsc:item key="LogRef" value="2544bank"/>\r
            <wsc:item key="AgreementId" value="55057203187"/>\r
         </wsc:ClientContext>\r
      </wsc:AutHeader>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <urn:PaymentCreateRequest>\r
         <urn:paymentMessage>\r
            <urn1:paymentIdentification>\r
               <urn2:messageIdentification>${=Math.abs(new Random().nextInt() % 6000000) + 1}</urn2:messageIdentification>\r
               <urn2:endToEndIdentification>${#TestSuite#endtoendID}</urn2:endToEndIdentification>\r
               <!--Optional:-->\r
            </urn1:paymentIdentification>\r
            <urn1:paymentInfo>\r
               <urn3:paymentMethod>TRF</urn3:paymentMethod>\r
               <!--Optional:-->\r
               <urn3:paymentTypeInformation>\r
                  <!--Optional:-->\r
                  <!--Optional:-->\r
                  <!--Optional:-->\r
                  <!--Optional:-->\r
                  <urn3:instructionPriority>NORM</urn3:instructionPriority>\r
                  <urn3:categoryPurpose>SUPP</urn3:categoryPurpose>\r
               </urn3:paymentTypeInformation>\r
               <urn3:requestedExecutionDate>${#TestSuite#ReqExnDate}</urn3:requestedExecutionDate>\r
               <urn3:debtorAccount>\r
                  <urn2:identification>36281079039</urn2:identification>\r
                  <urn2:currency>NOK</urn2:currency>\r
                  <!--Optional:-->\r
               </urn3:debtorAccount>\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <urn3:debtorAgentBIC>SPAVNOBBXXX</urn3:debtorAgentBIC>\r
               <urn3:debtor>\r
                  <!--Optional:-->\r
                  <!--Optional:-->\r
                  <urn2:name>debt</urn2:name>\r
                  <urn2:postalAddress>\r
                     <!--Optional:-->\r
                     <!--Optional:-->\r
                     <!--Optional:-->\r
                     <!--Optional:-->\r
                     <!--Optional:-->\r
                     <!--Optional:-->\r
                     <!--Optional:-->\r
                     <!--Optional:-->\r
                     <urn2:addressType>ADDR</urn2:addressType>\r
                     <urn2:department>adfa</urn2:department>\r
                     <urn2:subDepartment>adfa</urn2:subDepartment>\r
                     <urn2:streetName>stret</urn2:streetName>\r
                     <urn2:buildingNumber>123</urn2:buildingNumber>\r
                     <urn2:postCode>7919</urn2:postCode>\r
                     <urn2:townName>teewne</urn2:townName>\r
                     <urn2:country>NO</urn2:country>\r
                     <!--0 to 7 repetitions:-->\r
                  </urn2:postalAddress>\r
                  <!--Optional:-->\r
                  <!--Optional:-->\r
                  <!--Optional:-->\r
               </urn3:debtor>\r
               <!--Optional:-->\r
               <!--Optional:-->\r
            </urn1:paymentInfo>\r
            <urn1:transaction>\r
               <urn4:amount>\r
                  <!--You have a CHOICE of the next 2 items at this level-->\r
                  <urn2:instructedAmount currency="NOK">\r
                     <urn2:amount>100</urn2:amount>\r
                  </urn2:instructedAmount>\r
               </urn4:amount>\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <urn4:chargeBearer>SHAR</urn4:chargeBearer>\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <urn4:creditorAgent>\r
                  <urn2:bic>VEFONO21XXX</urn2:bic>\r
                  <urn2:postalAddress>\r
                     <urn2:addressType>ADDR</urn2:addressType>\r
                     <urn2:postCode>1122</urn2:postCode>\r
                     <urn2:country>NO</urn2:country>\r
                  </urn2:postalAddress>\r
               </urn4:creditorAgent>\r
               <urn4:creditor>\r
                  <!--Optional:-->\r
                  <!--Optional:-->\r
                  <urn2:name>After name</urn2:name>\r
                  <urn2:postalAddress>\r
                     <urn2:addressType>PBOX</urn2:addressType>\r
                     <urn2:buildingNumber>jjj</urn2:buildingNumber>\r
                     <urn2:postCode>11</urn2:postCode>\r
                     <urn2:country>NO</urn2:country>\r
                  </urn2:postalAddress>\r
                  <!--Optional:-->\r
                  <!--Optional:-->\r
                  <!--Optional:-->\r
               </urn4:creditor>\r
               <!--Optional:-->\r
               <urn4:creditorAccount>\r
                  <urn2:identification>24801016517</urn2:identification>\r
                  <urn2:currency>NOK</urn2:currency>\r
                  <!--Optional:-->\r
               </urn4:creditorAccount>\r
               <!--Optional:-->\r
               <!--Zero or more repetitions:-->\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <!--Optional:-->\r
               <!--Zero or more repetitions:-->\r
               <!--Optional:-->\r
            </urn1:transaction>\r
            <urn1:referredDocumentInformation>\r
               <urn2:type>CINV</urn2:type>\r
               <urn2:issuer>check CINV</urn2:issuer>\r
               <urn2:relatedDate>${#TestSuite#ReqExnDateTmrw}</urn2:relatedDate>\r
               <urn2:invoiceeOtherId>2910</urn2:invoiceeOtherId>\r
            </urn1:referredDocumentInformation>\r
            <urn1:autoConfirm>true</urn1:autoConfirm>\r
            <!--Optional:-->\r
            <!--Optional:-->\r
         </urn:paymentMessage>\r
      </urn:PaymentCreateRequest>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request>
        <con:assertion type="SOAP Response" id="c24294e9-055a-47d0-8510-63a09fe10bcb"/>
        <con:assertion type="GroovyScriptAssertion" name="Script Assertion" id="75531187-6f15-441c-a273-65ed2d2e3454">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
        <con:environmentSpec>
          <con:entry environmentId="4c71e673-5dd7-462e-86e7-316510af0b4b">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="c05d7630-7a50-443b-a3ae-c915912d2fc2">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="915ed5f3-ddc7-4ef3-9682-02c5d133f08a">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="6b2b23f8-6644-44f6-9927-94a78f2c0d2f">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="0f7f162e-4ba5-4580-83b9-b3009c02644c">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="10e021b5-003e-4a32-8696-bcbff8ff0a72">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="32f3cb92-2770-48c1-8141-ee901ac8f176">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="b932fe71-d995-46e4-b3d3-a68be0aa10db">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="4efa0d5a-6e21-4153-ad82-cb126899cb00">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="5d79d5a7-91a1-4c2b-b0f8-0d05609f1d17">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="1210f649-d535-4251-9341-f90db188ab86">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="baf0b73d-d5e4-4f35-99c2-f4c880adbeaa">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="b9f42815-a17d-4447-9f96-07d455d6a705">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="Approve" id="e7b85e37-4e2a-4c9b-9483-35791dbd77d3">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentStatusUpdate_V1_5PortTypeSoap11</con:interface>
      <con:operation>PaymentApprove</con:operation>
      <con:request name="Approve" id="5bc5b5ef-157f-485b-8617-71c42cd4a061">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://10.246.89.107:23621/pin/services/PINSPaymentStatusUpdate_V1_5</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v21" xmlns:urn="urn:pins.payment.evry.com:ws:paymentstatusupdate:v1_5" xmlns:urn1="urn:pins.payment.evry.com:domain:payment-status-update:v1_5">\r
   <soapenv:Header>\r
      <wsc:AutHeader>\r
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>\r
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>\r
         <wsc:Function>paymentAuthorizationCreate</wsc:Function>\r
         <wsc:Version>1.0</wsc:Version>\r
         <wsc:ClientContext>\r
            <wsc:userid>55057203187</wsc:userid>\r
            <wsc:credentials>03111012010400425kbKcJMZoMF56OVtVL1neI9CfuAtjCBO603eS0IgWm1WWIO7EfpSL4DE/lDFi69n1sSaabKNt2t+xJppso23a37EmmmyjbdrfF3M0FKxtlD/HJbEkbc46/BMCstNp869esSaabKNt2t/XzlyjxYnxhcG46wcbIKp/sSaabKNt2t9wBUG0SyIoqFfig80Gq4uXVBtimDzTiu3EfQIWD5xMfslE2lt0gldZQIyIMvAwCMo=Owe13MJu4QRF5Vj5fdm42aK3nL6InZ7iUXQ2d3QvsDlp4SRrFo03WNE0BwBvlyk3Y5tHWP+DVGwZTtsKKiL4yr1VcsAzMmjub6dAdZ8J2NSTeOl14BcfV4hHDqgvdtQ6wTLSNlDSmdoQHUgDHgLgF/oRUnWDutHal9uw/ZEemPI=</wsc:credentials>\r
            <wsc:channel>BES</wsc:channel>\r
            <wsc:orgid>2544</wsc:orgid>\r
            <!--Optional:-->\r
            <wsc:orgunit>2544</wsc:orgunit>\r
            <!--Optional:-->\r
            <wsc:customerid>55057203187</wsc:customerid>\r
            <!--Optional:-->\r
            <wsc:locale>en</wsc:locale>\r
            <wsc:ip>1.1.1.1</wsc:ip>\r
            <!--Zero or more repetitions:-->\r
            <wsc:item key="TppId" value="1"/>\r
            <wsc:item key="TppName" value="ABC"/>\r
            <wsc:item key="PaymentChannel" value="BES"/>\r
            <wsc:item key="LogRef" value="2544bank"/>\r
            <wsc:item key="AgreementId" value="55057203187"/>\r
         </wsc:ClientContext>\r
      </wsc:AutHeader>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <urn:PaymentApproveRequest>\r
         <urn:transactionInput>\r
            <!--1 or more repetitions:-->\r
            <urn1:transactionId>${Create#Response#declare namespace ns4='urn:pins.payment.evry.com:domain:paymentinitiation:v1_10'; declare namespace ns2='urn:pins.payment.evry.com:ws:paymentinitiation:v1_10'; //ns2:PaymentCreateResponse[1]/ns2:paymentResult[1]/ns4:transactionId[1]}</urn1:transactionId>\r
         </urn:transactionInput>\r
      </urn:PaymentApproveRequest>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request>
        <con:assertion type="SOAP Response" id="39f01c13-fdc7-4992-a9b6-344b6a3e4645"/>
        <con:assertion type="Simple Contains" id="a6b4e20a-df01-4e37-a500-86cbe8d237eb" name="Contains">
          <con:configuration>
            <token>READY_FOR_DUE_DATE</token>
            <ignoreCase>false</ignoreCase>
            <useRegEx>false</useRegEx>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="Script Assertion" id="c65fdfa0-e130-48ee-be13-fca20c8a219a">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
        <con:environmentSpec>
          <con:entry environmentId="4c71e673-5dd7-462e-86e7-316510af0b4b">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="c05d7630-7a50-443b-a3ae-c915912d2fc2">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="915ed5f3-ddc7-4ef3-9682-02c5d133f08a">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="6b2b23f8-6644-44f6-9927-94a78f2c0d2f">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="0f7f162e-4ba5-4580-83b9-b3009c02644c">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="10e021b5-003e-4a32-8696-bcbff8ff0a72">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="32f3cb92-2770-48c1-8141-ee901ac8f176">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="b932fe71-d995-46e4-b3d3-a68be0aa10db">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="4efa0d5a-6e21-4153-ad82-cb126899cb00">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="5d79d5a7-91a1-4c2b-b0f8-0d05609f1d17">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="1210f649-d535-4251-9341-f90db188ab86">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="baf0b73d-d5e4-4f35-99c2-f4c880adbeaa">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="b9f42815-a17d-4447-9f96-07d455d6a705">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:request>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>96fe1224-ebb3-49fe-9fc9-9cafb9a3096e</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
