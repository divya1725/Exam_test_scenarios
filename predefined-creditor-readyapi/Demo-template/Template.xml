<?xml version="1.0" encoding="UTF-8"?>
<con:testCase zephyrTestName="" zephyrTestId="" wsrmVersion="1.0" wsrmEnabled="false" wsrmAckTo="" timeout="0" searchProperties="true" name="Template" keepSession="false" id="2a0bb92b-bd1b-4f35-9e3c-e3ce41115920" failTestCaseOnErrors="true" failOnError="true" discardOkResults="false" amfPassword="" amfLogin="" amfEndpoint="" amfAuthorisation="false" xmlns:con="http://eviware.com/soapui/config">
  <con:description>PRM-681-1 - Create BM SEPA payment template success with valid mandatory fields</con:description>
  <con:settings>
    <con:setting id="eae0970c-b4c1-433d-b44e-569b691cf8e5fileName">Template</con:setting>
    <con:setting id="2a0bb92b-bd1b-4f35-9e3c-e3ce41115920fileName">Template</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="request" name="CreditorCreate_v2_1" id="c05c9e5d-bffc-454b-91bb-84903b389bfb">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorCreate</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorCreate_v2_1" incomingWss="" id="523c9182-0dea-4cda-b183-750b1a4fee03">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:urn1="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns:urn2="urn:pins.payment.evry.com:domain:complex-types:v2_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorCreateRequest>
         <urn:creditorInformation>
            <urn1:alias>${=org.apache.commons.lang.RandomStringUtils.random(35, true, true)}</urn1:alias>
            <urn1:type>SEPA</urn1:type>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:instructionPriority>NORM</urn1:instructionPriority>
            <urn1:debtorAccount>
               <urn2:identification>${#TestSuite#debitAccount}</urn2:identification>
               <!--Optional:-->
            </urn1:debtorAccount>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:amount>
               <!--You have a CHOICE of the next 2 items at this level-->
               <urn2:instructedAmount currency="${#TestSuite#amountCurrency1}">
                  <urn2:amount>1</urn2:amount>
               </urn2:instructedAmount>
            </urn1:amount>
            <urn1:creditorAccount>
               <urn2:identification>${#TestSuite#sepaCreditAccount}</urn2:identification>
               <!--Optional:-->
            </urn1:creditorAccount>
            <!--Optional:-->
            <urn1:creditor>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn2:name>Emilia</urn2:name>
               <urn2:postalAddress>
                  <urn2:country>${#TestSuite#sepaCredAgentCountry}</urn2:country>
               </urn2:postalAddress>
            </urn1:creditor>
            <urn1:creditorAgent>
               <urn2:bic>${#TestSuite#sepaCredAgentBic}</urn2:bic>
               <urn2:postalAddress>
                  <urn2:country>${#TestSuite#sepaCredAgentCountry}</urn2:country><urn2:addressLine>Creditor_addrLine</urn2:addressLine>
               </urn2:postalAddress>
            </urn1:creditorAgent><urn1:chargeBearer>SHAR</urn1:chargeBearer><urn1:supplierNumber>${=org.apache.commons.lang.RandomStringUtils.random(35, true, true)}</urn1:supplierNumber><urn1:internalNote>internalNote</urn1:internalNote><urn1:remittanceInformationUnstructured>remittanceUnsrtuctured</urn1:remittanceInformationUnstructured><urn1:creditorScorReference>12323</urn1:creditorScorReference><urn1:emailAddress>creditor@tietoevry.com</urn1:emailAddress>
            <!--Optional:-->
         </urn:creditorInformation>
      </urn:CreditorCreateRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="MessageContentAssertion" name="Message Content Assertion" id="efbea737-ac52-4002-be3e-b5758d6debee">
          <con:configuration xsi:type="con:MessageContentAssertion">
            <con:elements>
              <con:xpath>declare namespace ns1='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns1:CreditorCreateResponse[1]/ns1:predefinedCreditorId[1]</con:xpath>
              <con:element>ns4:predefinedCreditorId</con:element>
              <con:type/>
              <con:operator>exists</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>1158</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='urn:pins.payment.evry.com:domain:complex-types:v2_1';
declare namespace ns2='urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns3:creditorInformation[1]/ns2:creditorAgent[1]/ns1:postalAddress[1]/ns1:country[1]</con:xpath>
              <con:element>ns5:country</con:element>
              <con:type/>
              <con:operator>exists</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>DE</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='urn:pins.payment.evry.com:domain:complex-types:v2_1';
declare namespace ns2='urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns3:creditorInformation[1]/ns2:creditorAgent[1]/ns1:bic[1]</con:xpath>
              <con:element>ns5:bic</con:element>
              <con:type/>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>${CreditorCreate_v2_1#Request#//*:creditorAgent//*:bic}</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='urn:pins.payment.evry.com:domain:complex-types:v2_1';
declare namespace ns2='urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns3:creditorInformation[1]/ns2:creditorAccount[1]/ns1:identification[1]</con:xpath>
              <con:element>ns5:identification</con:element>
              <con:type/>
              <con:operator>exists</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>DE89370400440532013000</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='urn:pins.payment.evry.com:domain:complex-types:v2_1';
declare namespace ns2='urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns3:creditorInformation[1]/ns2:amount[1]/ns1:instructedAmount[1]/ns1:amount[1]</con:xpath>
              <con:element>ns5:amount</con:element>
              <con:type/>
              <con:operator>exists</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>1.00</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='urn:pins.payment.evry.com:domain:complex-types:v2_1';
declare namespace ns2='urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns3:creditorInformation[1]/ns2:amount[1]/ns1:instructedAmount[1]/@currency</con:xpath>
              <con:element>@currency</con:element>
              <con:type/>
              <con:operator>exists</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>EUR</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1';
declare namespace ns2='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns2:CreditorCreateResponse[1]/ns2:creditorInformation[1]/ns1:alias[1]</con:xpath>
              <con:element>ns2:alias</con:element>
              <con:type/>
              <con:operator>exists</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>HKRRC5lEBFEbzDQ3mSBaatrGebE4orFZy9c</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1';
declare namespace ns2='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns2:CreditorCreateResponse[1]/ns2:creditorInformation[1]/ns1:type[1]</con:xpath>
              <con:element>ns2:type</con:element>
              <con:type/>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>${CreditorCreate_v2_1#Request#//*:creditorInformation//*:type}</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:Message[1]</con:xpath>
              <con:element>Message</con:element>
              <con:type>XmlString</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>OK</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:ComponentId[1]</con:xpath>
              <con:element>ComponentId</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>111</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:Severity[1]</con:xpath>
              <con:element>Severity</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:ErrorCode[1]</con:xpath>
              <con:element>ErrorCode</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:originalMessage><![CDATA[<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <ns4:CreditorCreateResponse xmlns:ns9="urn:pins.payment.evry.com:domain:nationalinformation-nor:v2_0" xmlns:ns8="urn:pins.payment.evry.com:ws:paymentutil:v2_0" xmlns:ns7="urn:pins.payment.evry.com:domain:complex-types:v2_0" xmlns:ns6="urn:pins.payment.evry.com:domain:paymentutil:v2_0" xmlns:ns5="urn:pins.payment.evry.com:domain:complex-types:v2_1" xmlns:ns4="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:ns3="urn:pins.payment.evry.com:domain:common:v2_0" xmlns:ns2="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns="http://edb.com/ws/WSCommon_v22">
         <ns3:ResponseState>
            <ErrorCode>0</ErrorCode>
            <Severity>0</Severity>
            <ComponentId>111</ComponentId>
            <Message>OK</Message>
            <LogSequence xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </ns3:ResponseState>
         <ns4:creditorInformation>
            <ns2:alias>HKRRC5lEBFEbzDQ3mSBaatrGebE4orFZy9c</ns2:alias>
            <ns2:type>SEPA</ns2:type>
            <ns2:instructionPriority>NORM</ns2:instructionPriority>
            <ns2:debtorAccount>
               <ns5:identification>FI2031512000004264</ns5:identification>
            </ns2:debtorAccount>
            <ns2:amount>
               <ns5:instructedAmount currency="EUR">
                  <ns5:amount>1.00</ns5:amount>
               </ns5:instructedAmount>
            </ns2:amount>
            <ns2:creditorAccount>
               <ns5:identification>DE89370400440532013000</ns5:identification>
            </ns2:creditorAccount>
            <ns2:creditor>
               <ns5:name>CredName</ns5:name>
               <ns5:postalAddress>
                  <ns5:country>DE</ns5:country>
               </ns5:postalAddress>
            </ns2:creditor>
            <ns2:creditorAgent>
               <ns5:bic>DAAEDEDDXXX</ns5:bic>
               <ns5:postalAddress>
                  <ns5:country>DE</ns5:country>
               </ns5:postalAddress>
            </ns2:creditorAgent>
            <ns2:chargeBearer>SHAR</ns2:chargeBearer>
         </ns4:creditorInformation>
         <ns4:predefinedCreditorId>1158</ns4:predefinedCreditorId>
      </ns4:CreditorCreateResponse>
   </soap:Body>
</soap:Envelope>]]></con:originalMessage>
          </con:configuration>
        </con:assertion>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="423f20ae-31e3-4900-b419-de366319ec63">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [ErrorCode]" id="1778142e-7bba-4adc-ac4a-d066ebfd25c5">
          <con:configuration>
            <path>${#Response#//*:ErrorCode}</path>
            <content>0</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="75d322cb-cd90-4406-8d1c-3fc58e4fc816">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorCreateRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorCreate_v2_1_notAuthorised" id="2489db7b-7b96-48d8-9dec-b3f1eb8bd9d8">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorCreate</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorCreate_v2_1_notAuthorised" incomingWss="" id="523c9182-0dea-4cda-b183-750b1a4fee03">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:urn1="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns:urn2="urn:pins.payment.evry.com:domain:complex-types:v2_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#useridUnauthorised}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customeridUnauthorised}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorCreateRequest>
         <urn:creditorInformation>
            <urn1:alias>${=org.apache.commons.lang.RandomStringUtils.random(35, true, true)}</urn1:alias>
            <urn1:type>SEPA</urn1:type>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:instructionPriority>NORM</urn1:instructionPriority>
            <urn1:debtorAccount>
               <urn2:identification>${#TestSuite#debitAccount}</urn2:identification>
               <!--Optional:-->
            </urn1:debtorAccount>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:amount>
               <!--You have a CHOICE of the next 2 items at this level-->
               <urn2:instructedAmount currency="${#TestSuite#amountCurrency1}">
                  <urn2:amount>1</urn2:amount>
               </urn2:instructedAmount>
            </urn1:amount>
            <urn1:creditorAccount>
               <urn2:identification>${#TestSuite#sepaCreditAccount}</urn2:identification>
               <!--Optional:-->
            </urn1:creditorAccount>
            <!--Optional:-->
            <urn1:creditor>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn2:name>CredName</urn2:name>
               <urn2:postalAddress>
                  <urn2:country>${#TestSuite#sepaCredAgentCountry}</urn2:country>
               </urn2:postalAddress>
            </urn1:creditor>
            <urn1:creditorAgent>
               <urn2:bic>${#TestSuite#sepaCredAgentBic}</urn2:bic>
               <urn2:postalAddress>
                  <urn2:country>${#TestSuite#sepaCredAgentCountry}</urn2:country>
               </urn2:postalAddress>
            </urn1:creditorAgent>
            <!--Optional:-->
         </urn:creditorInformation>
      </urn:CreditorCreateRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="MessageContentAssertion" name="Message Content Assertion" id="efbea737-ac52-4002-be3e-b5758d6debee">
          <con:configuration xsi:type="con:MessageContentAssertion">
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:ErrorCode[1]</con:xpath>
              <con:element>ErrorCode</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>6485</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:Severity[1]</con:xpath>
              <con:element>Severity</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>2</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:ComponentId[1]</con:xpath>
              <con:element>ComponentId</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>111</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:Message[1]</con:xpath>
              <con:element>Message</con:element>
              <con:type>XmlString</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>Not authorized for Debtor Account</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns2='http://edb.com/ws/WSCommon_v22';
declare namespace ns1='http://www.w3.org/2001/XMLSchema-instance';
declare namespace ns3='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns4='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns4:CreditorCreateResponse[1]/ns3:ResponseState[1]/ns2:LogSequence[1]/@ns1:nil</con:xpath>
              <con:element>@xsi:nil</con:element>
              <con:type/>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>true</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:originalMessage><![CDATA[<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <ns4:CreditorCreateResponse xmlns:ns9="urn:pins.payment.evry.com:domain:nationalinformation-nor:v2_0" xmlns:ns8="urn:pins.payment.evry.com:ws:paymentutil:v2_0" xmlns:ns7="urn:pins.payment.evry.com:domain:complex-types:v2_0" xmlns:ns6="urn:pins.payment.evry.com:domain:paymentutil:v2_0" xmlns:ns5="urn:pins.payment.evry.com:domain:complex-types:v2_1" xmlns:ns4="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:ns3="urn:pins.payment.evry.com:domain:common:v2_0" xmlns:ns2="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns="http://edb.com/ws/WSCommon_v22">
         <ns3:ResponseState>
            <ErrorCode>6485</ErrorCode>
            <Severity>2</Severity>
            <ComponentId>111</ComponentId>
            <Message>Not authorized for Debtor Account</Message>
            <LogSequence xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </ns3:ResponseState>
      </ns4:CreditorCreateResponse>
   </soap:Body>
</soap:Envelope>]]></con:originalMessage>
          </con:configuration>
        </con:assertion>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="423f20ae-31e3-4900-b419-de366319ec63">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [ErrorCode]" id="1778142e-7bba-4adc-ac4a-d066ebfd25c5">
          <con:configuration>
            <path>${#Response#//*:ErrorCode}</path>
            <content>6485</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="75d322cb-cd90-4406-8d1c-3fc58e4fc816">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorCreateRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorCreate_v2_1_DuplicateSupplierNum" id="9dbaea83-d5f8-4d9f-a075-345149f72c2f">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorCreate</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorCreate_v2_1_DuplicateSupplierNum" incomingWss="" id="523c9182-0dea-4cda-b183-750b1a4fee03">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:urn1="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns:urn2="urn:pins.payment.evry.com:domain:complex-types:v2_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorCreateRequest>
         <urn:creditorInformation>
            <urn1:alias>${=org.apache.commons.lang.RandomStringUtils.random(35, true, true)}</urn1:alias>
            <urn1:type>SEPA</urn1:type>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:instructionPriority>NORM</urn1:instructionPriority>
            <urn1:debtorAccount>
               <urn2:identification>${#TestSuite#debitAccount}</urn2:identification>
               <!--Optional:-->
            </urn1:debtorAccount>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:amount>
               <!--You have a CHOICE of the next 2 items at this level-->
               <urn2:instructedAmount currency="${#TestSuite#amountCurrency1}">
                  <urn2:amount>1</urn2:amount>
               </urn2:instructedAmount>
            </urn1:amount>
            <urn1:creditorAccount>
               <urn2:identification>${#TestSuite#sepaCreditAccount}</urn2:identification>
               <!--Optional:-->
            </urn1:creditorAccount>
            <!--Optional:-->
            <urn1:creditor>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn2:name>Emilia</urn2:name>
               <urn2:postalAddress>
                  <urn2:country>${#TestSuite#sepaCredAgentCountry}</urn2:country>
               </urn2:postalAddress>
            </urn1:creditor>
            <urn1:creditorAgent>
               <urn2:bic>${#TestSuite#sepaCredAgentBic}</urn2:bic>
               <urn2:postalAddress>
                  <urn2:country>${#TestSuite#sepaCredAgentCountry}</urn2:country>
                  <urn2:addressLine>Creditor_addrLine</urn2:addressLine>
               </urn2:postalAddress>
            </urn1:creditorAgent>
            <urn1:chargeBearer>SHAR</urn1:chargeBearer>
            <urn1:supplierNumber>${CreditorCreate_v2_1#Response#//*:supplierNumber}</urn1:supplierNumber>
            <urn1:internalNote>internalNote</urn1:internalNote>
            <urn1:remittanceInformationUnstructured>remittanceUnsrtuctured</urn1:remittanceInformationUnstructured>
            <urn1:creditorScorReference>12323</urn1:creditorScorReference>
            <urn1:emailAddress>creditor@tietoevry.com</urn1:emailAddress>
            <!--Optional:-->
         </urn:creditorInformation>
      </urn:CreditorCreateRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="MessageContentAssertion" name="Message Content Assertion" id="efbea737-ac52-4002-be3e-b5758d6debee">
          <con:configuration xsi:type="con:MessageContentAssertion">
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:ErrorCode[1]</con:xpath>
              <con:element>ErrorCode</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>6000</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:Severity[1]</con:xpath>
              <con:element>Severity</con:element>
              <con:type>XmlInt</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>2</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>true</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:Message[1]</con:xpath>
              <con:element>Message</con:element>
              <con:type>XmlString</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>Validation error</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:errorItem[1]/@value</con:xpath>
              <con:element>@value</con:element>
              <con:type>XmlString</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>A creditor with this supplier number already exists</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>declare namespace ns1='http://edb.com/ws/WSCommon_v22';
declare namespace ns2='urn:pins.payment.evry.com:domain:common:v2_0';
declare namespace ns3='urn:pins.payment.evry.com:ws:paymentcreditor:v2_1';
//ns3:CreditorCreateResponse[1]/ns2:ResponseState[1]/ns1:errorItem[1]/@key</con:xpath>
              <con:element>@key</con:element>
              <con:type>XmlString</con:type>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>6431</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:originalMessage><![CDATA[<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <ns4:CreditorCreateResponse xmlns:ns9="urn:pins.payment.evry.com:domain:nationalinformation-nor:v2_0" xmlns:ns8="urn:pins.payment.evry.com:ws:paymentutil:v2_0" xmlns:ns7="urn:pins.payment.evry.com:domain:complex-types:v2_0" xmlns:ns6="urn:pins.payment.evry.com:domain:paymentutil:v2_0" xmlns:ns5="urn:pins.payment.evry.com:domain:complex-types:v2_1" xmlns:ns4="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:ns3="urn:pins.payment.evry.com:domain:common:v2_0" xmlns:ns2="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns="http://edb.com/ws/WSCommon_v22">
         <ns3:ResponseState>
            <ErrorCode>6000</ErrorCode>
            <Severity>2</Severity>
            <ComponentId>111</ComponentId>
            <Message>Validation error</Message>
            <LogSequence xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <errorItem key="6431" value=" A creditor with this supplier number already exists"/>
         </ns3:ResponseState>
      </ns4:CreditorCreateResponse>
   </soap:Body>
</soap:Envelope>]]></con:originalMessage>
          </con:configuration>
        </con:assertion>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="423f20ae-31e3-4900-b419-de366319ec63">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [ErrorCode]" id="1778142e-7bba-4adc-ac4a-d066ebfd25c5">
          <con:configuration>
            <path>${#Response#//*:ErrorCode}</path>
            <content>6000</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="75d322cb-cd90-4406-8d1c-3fc58e4fc816">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorCreateRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorSearch_v2_1" id="e42e7690-2f37-4cdb-8809-39185698ad7b">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorSearch</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorSearch_v2_1" incomingWss="" id="4b7392e2-738f-4108-bbad-d230999dd39a">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:urn1="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns:urn2="urn:pins.payment.evry.com:domain:common:v2_0">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorSearchRequest>
         <urn:searchCriteria>
            <!--Optional:-->
            <urn1:alias>${CreditorCreate_v2_1#Response#//*:alias}</urn1:alias><urn1:type>SEPA</urn1:type>
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <urn1:elementControl>
               <urn2:StartIndex>0</urn2:StartIndex>
               <urn2:MaximumNumberOfElements>10</urn2:MaximumNumberOfElements>
            </urn1:elementControl>
         </urn:searchCriteria>
      </urn:CreditorSearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="9ef344cb-ff46-46cb-a60f-0ba34e40db1b">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [NumberOfElements]" id="eeb39711-9b3c-47b0-a4b9-da35ed53716f">
          <con:configuration>
            <path>${#Response#//*:NumberOfElements}>0</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="693c1c64-a810-4092-85c2-2fbe323c58ef">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorSearchRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorSearch_v2_1_openSearch" id="f84ffc00-c70c-47a5-98a4-50d534fa6a68">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorSearch</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorSearch_v2_1_openSearch" incomingWss="" id="4b7392e2-738f-4108-bbad-d230999dd39a">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:urn1="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns:urn2="urn:pins.payment.evry.com:domain:common:v2_0">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorSearchRequest>
         <urn:searchCriteria>
            <!--Optional:-->
            <urn1:type>SEPA</urn1:type>
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <urn1:elementControl>
               <urn2:StartIndex>0</urn2:StartIndex>
               <urn2:MaximumNumberOfElements>20</urn2:MaximumNumberOfElements>
            </urn1:elementControl>
         </urn:searchCriteria>
      </urn:CreditorSearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="9ef344cb-ff46-46cb-a60f-0ba34e40db1b">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [NumberOfElements]" id="eeb39711-9b3c-47b0-a4b9-da35ed53716f">
          <con:configuration>
            <path>${#Response#//*:NumberOfElements}>0</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="693c1c64-a810-4092-85c2-2fbe323c58ef">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorSearchRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorRead_v2_1" id="aa9eb9ab-d3c3-4861-846d-a65be619a308">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorRead</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorRead_v2_1" incomingWss="" id="8798c74d-4171-43e9-884d-fb003073f694">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorReadRequest>
         <urn:predefinedCreditorId>${CreditorCreate_v2_1#Response#//*:predefinedCreditorId}</urn:predefinedCreditorId>
      </urn:CreditorReadRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="379ab2e0-73fd-4b13-89c7-1e358de96459">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [ErrorCode]" id="7df7019d-7fee-48d8-a2eb-b999810fac91">
          <con:configuration>
            <path>${#Response#//*:ErrorCode}</path>
            <content>0</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="a33006d4-3846-48c1-8539-038f5ab4b9b4">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorReadRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorUpdate_v2_1" id="55fd6d8c-58cd-41f3-84f0-2ea43163eed7">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorUpdate</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorUpdate_v2_1" incomingWss="" id="e4c0949f-3c0a-468c-a9f6-66dca5cd6da8">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:urn1="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns:urn2="urn:pins.payment.evry.com:domain:complex-types:v2_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorUpdateRequest>
         <urn:creditorInformation>
            <urn1:alias>${=org.apache.commons.lang.RandomStringUtils.random(35, true, true)}</urn1:alias>
            <urn1:type>INTERNATIONAL</urn1:type>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:debtorAccount>
               <urn2:identification>${#TestSuite#debitAccount}</urn2:identification>
               <!--Optional:-->
               <urn2:currency>${#TestSuite#debitAcntccy}</urn2:currency>
            </urn1:debtorAccount>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:amount>
               <!--You have a CHOICE of the next 2 items at this level-->
               <urn2:instructedAmount currency="${#TestSuite#amountCurrency1}">
                  <urn2:amount>1</urn2:amount>
               </urn2:instructedAmount>
            </urn1:amount>
            <urn1:creditorAccount>
               <urn2:identification>${#TestSuite#intCreditAccount}</urn2:identification>
               <!--Optional:-->
            </urn1:creditorAccount>
            <!--Optional:-->
            <urn1:creditor>
               <!--Optional:-->
               <urn2:name>Cred</urn2:name>
               <urn2:postalAddress>
                  <urn2:country>${#TestSuite#intCredAgentCountry}</urn2:country>
               </urn2:postalAddress>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
            </urn1:creditor>
            <!--Optional:-->
            <urn1:creditorAgent>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn2:bic>${#TestSuite#intCredAgentBic}</urn2:bic>
               <urn2:postalAddress>
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <urn2:country>${#TestSuite#intCredAgentCountry}</urn2:country>
                  <!--0 to 7 repetitions:-->
               </urn2:postalAddress>
            </urn1:creditorAgent><urn1:supplierNumber>${=org.apache.commons.lang.RandomStringUtils.random(35, true, true)}</urn1:supplierNumber>
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
         </urn:creditorInformation>
         <urn:predefinedCreditorId>${CreditorCreate_v2_1#Response#//*:predefinedCreditorId}</urn:predefinedCreditorId>
      </urn:CreditorUpdateRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="3a626674-c3e2-4735-9a35-d37ffa76784f">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [ErrorCode]" id="f17d9fab-2a87-40a0-b3d9-866cc9a9d7db">
          <con:configuration>
            <path>${#Response#//*:ErrorCode}</path>
            <content>0</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="c5da81c6-419e-4e6b-8803-84b86e57c197">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorUpdateRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorSearch_v2_1_afterUpdate" id="eadd4623-0496-48d6-83c4-103822a086f3">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorSearch</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorSearch_v2_1_afterUpdate" incomingWss="" id="4b7392e2-738f-4108-bbad-d230999dd39a">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:urn1="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns:urn2="urn:pins.payment.evry.com:domain:common:v2_0">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorSearchRequest>
         <urn:searchCriteria>
            <!--Optional:-->
            <urn1:alias>${CreditorUpdate_v2_1#Response#//*:alias}</urn1:alias><urn1:type>${CreditorUpdate_v2_1#Response#//*:type}</urn1:type>
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <urn1:elementControl>
               <urn2:StartIndex>0</urn2:StartIndex>
               <urn2:MaximumNumberOfElements>10</urn2:MaximumNumberOfElements>
            </urn1:elementControl>
         </urn:searchCriteria>
      </urn:CreditorSearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="ef95defa-fbbd-443a-893c-69f2db3d6dcf">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [NumberOfElements]" id="c90e610b-20fd-4cc4-a71f-73becafcc40f">
          <con:configuration>
            <path>${#Response#//*:NumberOfElements}>0</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="ce0edb42-4a5d-4160-8c99-d69b09d97234">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorSearchRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorRead_v2_1_afterUpdate" id="8a4ced98-4092-4876-a550-9660a20d5fdf">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorRead</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorRead_v2_1_afterUpdate" incomingWss="" id="8798c74d-4171-43e9-884d-fb003073f694">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorReadRequest>
         <urn:predefinedCreditorId>${CreditorUpdate_v2_1#Response#//*:predefinedCreditorId}</urn:predefinedCreditorId>
      </urn:CreditorReadRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="379ab2e0-73fd-4b13-89c7-1e358de96459">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [ErrorCode]" id="7df7019d-7fee-48d8-a2eb-b999810fac91">
          <con:configuration>
            <path>${#Response#//*:ErrorCode}</path>
            <content>0</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="a33006d4-3846-48c1-8539-038f5ab4b9b4">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorReadRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorUpdate_v2_1_notFound" id="6d5ad8db-652c-42fc-a6d2-228bb76b0465">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorUpdate</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorUpdate_v2_1_notFound" incomingWss="" id="e4c0949f-3c0a-468c-a9f6-66dca5cd6da8">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:urn1="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns:urn2="urn:pins.payment.evry.com:domain:complex-types:v2_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorUpdateRequest>
         <urn:creditorInformation>
            <urn1:alias>${=org.apache.commons.lang.RandomStringUtils.random(35, true, true)}</urn1:alias>
            <urn1:type>INTERNATIONAL</urn1:type>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:debtorAccount>
               <urn2:identification>${#TestSuite#debitAccount}</urn2:identification>
               <!--Optional:-->
               <urn2:currency>${#TestSuite#debitAcntccy}</urn2:currency>
            </urn1:debtorAccount>
            <!--Optional:-->
            <!--Optional:-->
            <urn1:amount>
               <!--You have a CHOICE of the next 2 items at this level-->
               <urn2:instructedAmount currency="${#TestSuite#amountCurrency1}">
                  <urn2:amount>1</urn2:amount>
               </urn2:instructedAmount>
            </urn1:amount>
            <urn1:creditorAccount>
               <urn2:identification>${#TestSuite#intCreditAccount}</urn2:identification>
               <!--Optional:-->
            </urn1:creditorAccount>
            <!--Optional:-->
            <urn1:creditor>
               <!--Optional:-->
               
               <urn2:postalAddress>
                  <urn2:country>${#TestSuite#intCredAgentCountry}</urn2:country>
               </urn2:postalAddress>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
            </urn1:creditor>
            <!--Optional:-->
            <urn1:creditorAgent>
               <!--Optional:-->
               <!--Optional:-->
               <!--Optional:-->
               <urn2:bic>${#TestSuite#intCredAgentBic}</urn2:bic>
               <urn2:postalAddress>
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <!--Optional:-->
                  <urn2:country>${#TestSuite#intCredAgentCountry}</urn2:country>
                  <!--0 to 7 repetitions:-->
               </urn2:postalAddress>
            </urn1:creditorAgent><urn1:supplierNumber>${=org.apache.commons.lang.RandomStringUtils.random(35, true, true)}</urn1:supplierNumber>
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
         </urn:creditorInformation>
         <urn:predefinedCreditorId>9999</urn:predefinedCreditorId>
      </urn:CreditorUpdateRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="3a626674-c3e2-4735-9a35-d37ffa76784f">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [ErrorCode]" id="f17d9fab-2a87-40a0-b3d9-866cc9a9d7db">
          <con:configuration>
            <path>${#Response#//*:ErrorCode}</path>
            <content>6435</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="c5da81c6-419e-4e6b-8803-84b86e57c197">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorUpdateRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorDelete_v2_1" id="5f1425b3-b94f-45e4-88be-70c7257d9d2e">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorDelete</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorDelete_v2_1" incomingWss="" id="315126ce-a2a4-448b-aae6-d9b21507cfad">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1">
   <soapenv:Header>
     <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorDeleteRequest>
         <urn:predefinedCreditorId>${CreditorCreate_v2_1#Response#//*:predefinedCreditorId}</urn:predefinedCreditorId>
      </urn:CreditorDeleteRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="fc4eaa31-fd16-40b9-9212-2e90ebbbda6e">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [ErrorCode]" id="c7715144-5b14-4f6d-95f9-63165db57017">
          <con:configuration>
            <path>${#Response#//*:ErrorCode}</path>
            <content>0</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="17a5535d-0108-4ba8-bce1-839ea4cf7fff">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorDeleteRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorSearch_v2_1_afterDelete" id="40eab3dd-7443-4dea-9b73-36abc8e01c1f">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorSearch</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorSearch_v2_1_afterDelete" incomingWss="" id="4b7392e2-738f-4108-bbad-d230999dd39a">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1" xmlns:urn1="urn:pins.payment.evry.com:domain:predefinedcreditor:v2_1" xmlns:urn2="urn:pins.payment.evry.com:domain:common:v2_0">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorSearchRequest>
         <urn:searchCriteria>
            <!--Optional:-->
            <urn1:alias>${CreditorUpdate_v2_1#Response#//*:alias}</urn1:alias><urn1:type>SEPA</urn1:type>
            <!--Optional:-->
            <!--Optional:-->
            <!--Optional:-->
            <urn1:elementControl>
               <urn2:StartIndex>0</urn2:StartIndex>
               <urn2:MaximumNumberOfElements>10</urn2:MaximumNumberOfElements>
            </urn1:elementControl>
         </urn:searchCriteria>
      </urn:CreditorSearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="d0e13bab-d1e2-4b52-a22f-8e3d88da8778">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [NumberOfElements]" id="a9e3a46c-3ccc-4022-8aa7-7a3bc9cf85c0">
          <con:configuration>
            <path>${#Response#//*:NumberOfElements}=0</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="e1b31a07-b5d6-41f2-b545-678aaadfe956">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorSearchRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="request" name="CreditorRead_v2_1_afterDelete" id="d2c892c9-5feb-4ed8-9166-0dc27bb3f524">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>PINSPaymentPredefinedCreditor_V2_1PortTypeSoap11</con:interface>
      <con:operation>CreditorRead</con:operation>
      <con:request wssPasswordType="" useWsReliableMessaging="false" useWsAddressing="false" timeout="" sslKeystore="" outgoingWss="" name="CreditorRead_v2_1_afterDelete" incomingWss="" id="8798c74d-4171-43e9-884d-fb003073f694">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://${#Project#G_D10}/pin/services/PINSPaymentPredefinedCreditor_V2_1</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsc="http://edb.com/ws/WSCommon_v22" xmlns:urn="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1">
   <soapenv:Header>
      <wsc:AutHeader>
         <wsc:SourceApplication>${#TestSuite#SourceApplication}</wsc:SourceApplication>
         <wsc:DestinationApplication>PIN</wsc:DestinationApplication>
         <wsc:Function>PIN Create</wsc:Function>
         <wsc:Version>V2.0</wsc:Version>
         <wsc:ClientContext>
            <wsc:userid>${#TestSuite#userid}</wsc:userid>
            <wsc:credentials>${#TestSuite#credentials}</wsc:credentials>
            <wsc:channel>NBA</wsc:channel>
            <wsc:orgid>${#TestSuite#orgid}</wsc:orgid>
            <wsc:orgunit>${#TestSuite#orgid}</wsc:orgunit>
            <wsc:customerid>${#TestSuite#customerid}</wsc:customerid>
            <wsc:locale>en</wsc:locale>
            <wsc:ip>1.1.1.1</wsc:ip>
            <wsc:item value="${#TestSuite#value1}" key="${#TestSuite#item1}"/>
            <wsc:item value="${#TestSuite#value2}" key="${#TestSuite#item2}"/>
            <wsc:item value="${#TestSuite#value3}" key="${#TestSuite#item3}"/>
            <wsc:item value="${#TestSuite#value4}" key="${#TestSuite#item4}"/>
         </wsc:ClientContext>
      </wsc:AutHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:CreditorReadRequest>
         <urn:predefinedCreditorId>${CreditorCreate_v2_1#Response#//*:predefinedCreditorId}</urn:predefinedCreditorId>
      </urn:CreditorReadRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Schema Compliance" name="Schema Compliance" id="379ab2e0-73fd-4b13-89c7-1e358de96459">
          <con:configuration/>
        </con:assertion>
        <con:assertion type="XPath Match" name="Match content of [ErrorCode]" id="7df7019d-7fee-48d8-a2eb-b999810fac91">
          <con:configuration>
            <path>${#Response#//*:ErrorCode}</path>
            <content>6435</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="GroovyScriptAssertion" name="writeToFile" id="a33006d4-3846-48c1-8539-038f5ab4b9b4">
          <con:configuration>
            <scriptText>import com.eviware.soapui.support.XmlHolder
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

def path=context.expand( '${projectDir}')
String curStepName = (String)context.getCurrentStep().getLabel()

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
def response = groovyUtils.getXmlHolder(curStepName + "#Response")
def errorCode=response.getNodeValue("//*:ErrorCode");
def testCase = context.getCurrentStep().getTestCase().getLabel()
def endPoint = messageExchange.getEndpoint()

path=path+"\\results"
File dir = new File(path);
if (!dir.exists())
{
                log.info 'Creating Directory'
                dir.mkdir();
}

Date date = new Date();
SimpleDateFormat df = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a zz");    
df.setTimeZone(TimeZone.getTimeZone("Europe/Oslo"));

def datetime = df.format(date)

SimpleDateFormat fn = new SimpleDateFormat("dd-M-yyyy hh_mm_ss a zz");    
def fileName = fn.format(date)

//log.info path 
def fout = new File(path+"\\"+testCase+" - "+curStepName+"_"+fileName+"_"+errorCode+".txt",)


fout.write("Time Submitted		:	"+datetime+"\r\n")
fout.append("End Point Used		:	"+endPoint+"\r\n")
fout.append("Time Taken		:	"+messageExchange.timeTaken+"ms\r\n")
fout.append("Executed in test set	:	"+testCase+" - "+curStepName+"_"+fileName)
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   REQUEST\r\n\r\n","UTF-8")
fout.append(messageExchange.getRequestHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getRequestContent() ).replace("\n","\r\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")
fout.append("                                                                                                   RESPONSE\r\n\r\n","UTF-8")
fout.append(messageExchange.getResponseHeaders())
fout.append("\n\n")
fout.append(new String( messageExchange.getResponseContent() ).replace("\n","\n"),"UTF-8")
fout.append("\r\n\r\n","UTF-8")
fout.append("=========================================================================================================================\r\n","UTF-8")</scriptText>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig version="200508" mustUnderstand="NONE" action="urn:pins.payment.evry.com:ws:paymentcreditor:v2_1/PINSPaymentPredefinedCreditor_V2_1PortType/CreditorReadRequest"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>cb6dacda-eeaa-489b-96ee-7f0cc30a2755</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>ea776578-dda0-4974-907f-0c10299eb696</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>266f5b1d-7f49-44f2-9a21-493a4a52583f</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>28f12249-a5b5-4abb-91b7-73aa39278345</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>64db8cc4-8e64-48bc-aa52-69a428032225</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>c5dc5bc1-a9ad-4945-b179-62b778f88622</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>ce2d554d-4fd5-44fa-b181-eeca062a5601</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>02dff7e3-0edd-4851-a3bc-9528ac5bc74a</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>ac2bef6f-b2db-43e2-a7a8-002bdc43b7d6</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>4fad1fba-354d-41dd-bc7e-8c93eb1e1382</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>3cb5ae88-0b09-4e5d-805e-a533d8082f51</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>1e8b0176-8ee0-415e-a1cd-ce6c921e2f02</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>1eaf3c83-9b37-4478-8991-16f4ba53228c</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>0d938ba4-a70e-46d2-9760-9b67f05ec017</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>66feb8b1-4121-4d03-a320-9160e9ec7bb2</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>e78693f9-5442-4515-ade6-197bf8ffdb80</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>e43c3d9d-4cdf-4b1a-9974-35f02f657325</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>53126f40-3bf7-4dba-8c3a-2ed2ecc517c1</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>6feff05f-c7ef-4684-b55b-bb82ee405866</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>9ede4989-5228-421c-9167-12c57c281a01</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>f84ffc00-c70c-47a5-98a4-50d534fa6a68</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>6d5ad8db-652c-42fc-a6d2-228bb76b0465</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>eadd4623-0496-48d6-83c4-103822a086f3</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>40eab3dd-7443-4dea-9b73-36abc8e01c1f</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
