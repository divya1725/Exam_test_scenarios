<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="78a1eaf2-7c67-43cc-a69e-5ddbe2ee48ef" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Pain001_Camt055_All Level RFDD" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:description>TC will perform PAIN002 Cancel action at Message, PaymentInfo and Transaction level and validate Camt055 and Camt029 response for RFDD Payments</con:description>
  <con:settings>
    <con:setting id="78a1eaf2-7c67-43cc-a69e-5ddbe2ee48effileName">Pain001_Camt055_All-Level-RFDD</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="jdbc" name="DB Account" id="5bbb4481-53a0-4231-b730-41a53951a77f">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>Database</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_d4)))</con:connectionString>
      <con:password/>
      <con:connectionProperties/>
      <con:query>select distinct(CUSTOMERID),ACCOUNTNUMBER  from V_authorisation 
where CUSTBANKID='${Properties#bankId}'  
and length(customerID)='11' and
BLOCKED ='N' and
CLOSED='N'
fetch first 2 rows only</con:query>
      <con:storedProcedure>false</con:storedProcedure>
      <con:assertion type="MessageContentAssertion" id="8e97c887-32b1-4c89-8f5a-4e8a7d8c4bc2" name="Message Content Assertion">
        <con:configuration xsi:type="con:MessageContentAssertion">
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/@fetchSize</con:xpath>
            <con:element>@fetchSize</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>10</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:originalMessage><![CDATA[<Results>
   <ResultSet fetchSize="10">
      <Row rowNumber="1">
         <CUSTOMERID>01010077571</CUSTOMERID>
         <ACCOUNTNUMBER>42125748338</ACCOUNTNUMBER>
      </Row>
   </ResultSet>
</Results>]]></con:originalMessage>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="SetProperties" id="e955978f-53c8-4f46-921b-62cb6c0d79b7">
    <con:settings/>
    <con:config>
      <script>import java.text.SimpleDateFormat

def customerID = context.expand( '${DB Account#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/CUSTOMERID[1]}' )
def debtorAccountNumber = context.expand( '${DB Account#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCOUNTNUMBER[1]}' )

def creditorAccountNumber = context.expand( '${DB Account#ResponseAsXml#//Results[1]/ResultSet[1]/Row[2]/ACCOUNTNUMBER[1]}' )

testRunner.testCase.getTestStepByName("Properties").setPropertyValue("customerid",customerID)
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("accountNumber",debtorAccountNumber)
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("creditorAccountNumber",creditorAccountNumber)

Date date = new Date();
SimpleDateFormat fn = new SimpleDateFormat("ddMyyhhmmss");
def datetime = fn.format(date)
log.info datetime

def EndtoEndID = "P002_"+datetime;
def MPT = "MPT_"+datetime;
log.info EndtoEndID
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("msgID",EndtoEndID );
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("msgID1",MPT );


testRunner.testCase.getTestStepByName("Properties").setPropertyValue("actualStatusCamt029","");
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("TxnactualStatusCamt029","");
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("2TxnactualStatusCamt029","");
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("3TxnactualStatusCamt029","");
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("actualStatusReasonCamt055","");</script>
    </con:config>
  </con:testStep>
  <con:testStep type="properties" name="Properties" id="ad3b83db-db10-48bf-8b2b-4aeb8d02a2bf">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>customerid</con:name>
          <con:value>10127521900</con:value>
        </con:property>
        <con:property>
          <con:name>bankId</con:name>
          <con:value>4201</con:value>
        </con:property>
        <con:property>
          <con:name>accountNumber</con:name>
          <con:value>40680101541</con:value>
        </con:property>
        <con:property>
          <con:name>creditorAccountNumber</con:name>
          <con:value>40680103870</con:value>
        </con:property>
        <con:property>
          <con:name>dueDate</con:name>
          <con:value>${= java.time.LocalDateTime.now().format(java.time.format.DateTimeFormatter.ofPattern('yyyy-MM-dd'))}</con:value>
        </con:property>
        <con:property>
          <con:name>msgID</con:name>
          <con:value>P002_081020112413</con:value>
        </con:property>
        <con:property>
          <con:name>msgID1</con:name>
          <con:value>MPT_081020112413</con:value>
        </con:property>
        <con:property>
          <con:name>MessageToSendFormat</con:name>
          <con:value><![CDATA[<?xml version="1.0" encoding="UTF-8"?><Wrapper xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="urn:pin.payment.edb.com:authpain001wrapper:v1_0" ><auth><![CDATA[<?xml version="1.0" encoding="UTF-8"?><AgreementAuthorizationRequest><authRequest><agreementData><agreementId>600685</agreementId><bankId>BANKID</bankId><userId>CUSTOMERID</userId><userFirstName>Anita</userFirstName><userLastName>Korsgaard</userLastName><userIdType>EXTU</userIdType><productID>11</productID><organizationId>921095899</organizationId><preapproved>true</preapproved><rejectionLevel>TRANSACTION</rejectionLevel><origin>NDR</origin><allowPartialCancellation>false</allowPartialCancellation><allowCancellationPriorToPayment>false</allowCancellationPriorToPayment></agreementData><agreementAccount><accountNumber>ACCOUNTID</accountNumber><swiftAdress>SPTRNO22XXX</swiftAdress><currencyCode>NOK</currencyCode><accountType>CurrencyCoreFD</accountType><access>CREDIT_AND_DEBIT</access><bookingLevel>D</bookingLevel><approvalLimit>0</approvalLimit><registerLimit>0</registerLimit><numberOfVerifiers>0</numberOfVerifiers><numberOfApprovers>1</numberOfApprovers></agreementAccount><metaInformation><receivedTimestamp>DATET14:24:06</receivedTimestamp></metaInformation></authRequest></AgreementAuthorizationRequest> ]]]]>><![CDATA[</auth><content><![CDATA[ <?xml version="1.0" encoding="UTF-8"?><Document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="urn:iso:std:iso:20022:tech:xsd:pain.001.001.04"><CstmrCdtTrfInitn><GrpHdr><MsgId>TIMESTAMP</MsgId><CreDtTm>DATET14:24:12.053+02:00</CreDtTm><Authstn><Cd>ILEV</Cd></Authstn><Authstn><Prtry>PAYMENT_TELEPAY</Prtry></Authstn><NbOfTxs>2</NbOfTxs><CtrlSum>2.40</CtrlSum><InitgPty><Nm>Mentor Medier AS</Nm><Id><OrgId><AnyBIC>SHEDNO22XXX</AnyBIC><Othr><Id>122032456</Id><SchmeNm><Cd>BANK</Cd></SchmeNm></Othr><Othr><Id>537812</Id><SchmeNm><Cd>USAG</Cd></SchmeNm></Othr></OrgId></Id></InitgPty></GrpHdr><PmtInf><PmtInfId>TIMESTAMP.P1</PmtInfId><PmtMtd>TRF</PmtMtd><NbOfTxs>2</NbOfTxs><CtrlSum>2.40</CtrlSum><PmtTpInf><InstrPrty>NORM</InstrPrty><CtgyPurp><Cd>SUPP</Cd></CtgyPurp></PmtTpInf><ReqdExctnDt>DATE</ReqdExctnDt><Dbtr><Nm>Dagsavisen AS</Nm><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><AdrLine>Postboks 1183 Sentrum</AdrLine><AdrLine>0107 OSLO</AdrLine></PstlAdr><Id><OrgId><Othr><Id>980454347</Id><SchmeNm><Cd>CUST</Cd></SchmeNm></Othr></OrgId></Id></Dbtr><DbtrAcct><Id><Othr><Id>ACCOUNTID</Id><SchmeNm><Cd>BBAN</Cd></SchmeNm></Othr></Id></DbtrAcct><DbtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI></FinInstnId></DbtrAgt><ChrgBr>SHAR</ChrgBr><CdtTrfTxInf><PmtId><InstrId>TIMESTAMP.T1</InstrId><EndToEndId>TIMESTAMP.E1</EndToEndId></PmtId><PmtTpInf><LclInstrm><Prtry>TLB</Prtry></LclInstrm></PmtTpInf><Amt><InstdAmt Ccy="NOK">1.30</InstdAmt></Amt><CdtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><Ctry>NO</Ctry></PstlAdr></FinInstnId></CdtrAgt><Cdtr><Nm>ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ</Nm><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><Ctry>NO</Ctry><AdrLine>45, HASHEMESH STREET</AdrLine><AdrLine>CAESAREAISRAEL</AdrLine></PstlAdr><CtryOfRes>NO</CtryOfRes></Cdtr><CdtrAcct><Id><Othr><Id>CREDITORACCOUNTNUMBER</Id></Othr></Id></CdtrAcct><RmtInf><Strd><RfrdDocAmt><DuePyblAmt Ccy="NOK">1.30</DuePyblAmt></RfrdDocAmt><AddtlRmtInf>263009</AddtlRmtInf></Strd></RmtInf></CdtTrfTxInf><CdtTrfTxInf><PmtId><InstrId>TIMESTAMP.T2</InstrId><EndToEndId>TIMESTAMP.E2</EndToEndId></PmtId><PmtTpInf><LclInstrm><Prtry>TLB</Prtry></LclInstrm></PmtTpInf><Amt><InstdAmt Ccy="NOK">1.10</InstdAmt></Amt><CdtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><Ctry>NO</Ctry></PstlAdr></FinInstnId></CdtrAgt><Cdtr><Nm>ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ</Nm><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><Ctry>NO</Ctry><AdrLine>45, HASHEMESH STREET</AdrLine><AdrLine>CAESAREAISRAEL</AdrLine></PstlAdr><CtryOfRes>NO</CtryOfRes></Cdtr><CdtrAcct><Id><Othr><Id>CREDITORACCOUNTNUMBER</Id></Othr></Id></CdtrAcct><RmtInf><Strd><RfrdDocAmt><DuePyblAmt Ccy="NOK">1.10</DuePyblAmt></RfrdDocAmt><AddtlRmtInf>263009</AddtlRmtInf></Strd></RmtInf></CdtTrfTxInf></PmtInf></CstmrCdtTrfInitn></Document> ]]]]>><![CDATA[</content></Wrapper>]]></con:value>
        </con:property>
        <con:property>
          <con:name>MessageToSendFormat1</con:name>
          <con:value><![CDATA[<?xml version="1.0" encoding="UTF-8"?><Wrapper xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="urn:pin.payment.edb.com:authpain001wrapper:v1_0" ><auth><![CDATA[<?xml version="1.0" encoding="UTF-8"?><AgreementAuthorizationRequest><authRequest><agreementData><agreementId>600685</agreementId><bankId>BANKID</bankId><userId>CUSTOMERID</userId><userFirstName>Anita</userFirstName><userLastName>Korsgaard</userLastName><userIdType>EXTU</userIdType><productID>11</productID><organizationId>921095899</organizationId><preapproved>true</preapproved><rejectionLevel>TRANSACTION</rejectionLevel><origin>NDR</origin><allowPartialCancellation>false</allowPartialCancellation><allowCancellationPriorToPayment>false</allowCancellationPriorToPayment></agreementData><agreementAccount><accountNumber>ACCOUNTID</accountNumber><swiftAdress>SPTRNO22XXX</swiftAdress><currencyCode>NOK</currencyCode><accountType>CurrencyCoreFD</accountType><access>CREDIT_AND_DEBIT</access><bookingLevel>D</bookingLevel><approvalLimit>0</approvalLimit><registerLimit>0</registerLimit><numberOfVerifiers>0</numberOfVerifiers><numberOfApprovers>1</numberOfApprovers></agreementAccount><metaInformation><receivedTimestamp>DATET14:24:06</receivedTimestamp></metaInformation></authRequest></AgreementAuthorizationRequest> ]]]]>><![CDATA[</auth><content><![CDATA[ <?xml version="1.0" encoding="UTF-8"?><Document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="urn:iso:std:iso:20022:tech:xsd:pain.001.001.04"><CstmrCdtTrfInitn><GrpHdr><MsgId>TIMESTAMP1</MsgId><CreDtTm>DATET14:24:12.053+02:00</CreDtTm><Authstn><Cd>ILEV</Cd></Authstn><Authstn><Prtry>PAYMENT_TELEPAY</Prtry></Authstn><NbOfTxs>2</NbOfTxs><CtrlSum>2.40</CtrlSum><InitgPty><Nm>Mentor Medier AS</Nm><Id><OrgId><AnyBIC>SHEDNO22XXX</AnyBIC><Othr><Id>122032456</Id><SchmeNm><Cd>BANK</Cd></SchmeNm></Othr><Othr><Id>537812</Id><SchmeNm><Cd>USAG</Cd></SchmeNm></Othr></OrgId></Id></InitgPty></GrpHdr><PmtInf><PmtInfId>TIMESTAMP1.P1</PmtInfId><PmtMtd>TRF</PmtMtd><NbOfTxs>2</NbOfTxs><CtrlSum>2.40</CtrlSum><PmtTpInf><InstrPrty>NORM</InstrPrty><CtgyPurp><Cd>SUPP</Cd></CtgyPurp></PmtTpInf><ReqdExctnDt>DATE</ReqdExctnDt><Dbtr><Nm>Dagsavisen AS</Nm><PstlAdr><AdrTp>ADDR</AdrTp><AdrLine>Postboks 1183 Sentrum</AdrLine><AdrLine>0107 OSLO</AdrLine></PstlAdr><Id><OrgId><Othr><Id>980454347</Id><SchmeNm><Cd>CUST</Cd></SchmeNm></Othr></OrgId></Id></Dbtr><DbtrAcct><Id><Othr><Id>ACCOUNTID</Id><SchmeNm><Cd>BBAN</Cd></SchmeNm></Othr></Id></DbtrAcct><DbtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI></FinInstnId></DbtrAgt><ChrgBr>SHAR</ChrgBr><CdtTrfTxInf><PmtId><InstrId>TIMESTAMP1.T1</InstrId><EndToEndId>TIMESTAMP1.E1</EndToEndId></PmtId><PmtTpInf><LclInstrm><Prtry>TLB</Prtry></LclInstrm></PmtTpInf><Amt><InstdAmt Ccy="NOK">1.30</InstdAmt></Amt><CdtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI><PstlAdr><AdrTp>ADDR</AdrTp><Ctry>NO</Ctry></PstlAdr></FinInstnId></CdtrAgt><Cdtr><Nm>ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ</Nm><PstlAdr><AdrTp>ADDR</AdrTp><Ctry>NO</Ctry><AdrLine>45, HASHEMESH STREET</AdrLine><AdrLine>CAESAREAISRAEL</AdrLine></PstlAdr><CtryOfRes>NO</CtryOfRes></Cdtr><CdtrAcct><Id><Othr><Id>CREDITORACCOUNTNUMBER</Id></Othr></Id></CdtrAcct><RmtInf><Strd><RfrdDocAmt><DuePyblAmt Ccy="NOK">1.30</DuePyblAmt></RfrdDocAmt><AddtlRmtInf>263009</AddtlRmtInf></Strd></RmtInf></CdtTrfTxInf><CdtTrfTxInf><PmtId><InstrId>TIMESTAMP1.T2</InstrId><EndToEndId>TIMESTAMP1.E2</EndToEndId></PmtId><PmtTpInf><LclInstrm><Prtry>TLB</Prtry></LclInstrm></PmtTpInf><Amt><InstdAmt Ccy="NOK">1.10</InstdAmt></Amt><CdtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI><PstlAdr><AdrTp>ADDR</AdrTp><Ctry>NO</Ctry></PstlAdr></FinInstnId></CdtrAgt><Cdtr><Nm>ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ</Nm><PstlAdr><AdrTp>ADDR</AdrTp><Ctry>NO</Ctry><AdrLine>45, HASHEMESH STREET</AdrLine><AdrLine>CAESAREAISRAEL</AdrLine></PstlAdr><CtryOfRes>NO</CtryOfRes></Cdtr><CdtrAcct><Id><Othr><Id>CREDITORACCOUNTNUMBER</Id></Othr></Id></CdtrAcct><RmtInf><Strd><RfrdDocAmt><DuePyblAmt Ccy="NOK">1.10</DuePyblAmt></RfrdDocAmt><AddtlRmtInf>263009</AddtlRmtInf></Strd></RmtInf></CdtTrfTxInf></PmtInf></CstmrCdtTrfInitn></Document> ]]]]>><![CDATA[</content></Wrapper>]]></con:value>
        </con:property>
        <con:property>
          <con:name>messagetoSend</con:name>
          <con:value><![CDATA[<?xml version="1.0" encoding="UTF-8"?><Wrapper xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="urn:pin.payment.edb.com:authpain001wrapper:v1_0" ><auth><![CDATA[<?xml version="1.0" encoding="UTF-8"?><AgreementAuthorizationRequest><authRequest><agreementData><agreementId>600685</agreementId><bankId>4201</bankId><userId>10127521900</userId><userFirstName>Anita</userFirstName><userLastName>Korsgaard</userLastName><userIdType>EXTU</userIdType><productID>11</productID><organizationId>921095899</organizationId><preapproved>true</preapproved><rejectionLevel>TRANSACTION</rejectionLevel><origin>NDR</origin><allowPartialCancellation>false</allowPartialCancellation><allowCancellationPriorToPayment>false</allowCancellationPriorToPayment></agreementData><agreementAccount><accountNumber>40680101541</accountNumber><swiftAdress>SPTRNO22XXX</swiftAdress><currencyCode>NOK</currencyCode><accountType>CurrencyCoreFD</accountType><access>CREDIT_AND_DEBIT</access><bookingLevel>D</bookingLevel><approvalLimit>0</approvalLimit><registerLimit>0</registerLimit><numberOfVerifiers>0</numberOfVerifiers><numberOfApprovers>1</numberOfApprovers></agreementAccount><metaInformation><receivedTimestamp>2020-10-08T14:24:06</receivedTimestamp></metaInformation></authRequest></AgreementAuthorizationRequest> ]]]]>><![CDATA[</auth><content><![CDATA[ <?xml version="1.0" encoding="UTF-8"?><Document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="urn:iso:std:iso:20022:tech:xsd:pain.001.001.04"><CstmrCdtTrfInitn><GrpHdr><MsgId>P002_081020112413</MsgId><CreDtTm>2020-10-08T14:24:12.053+02:00</CreDtTm><Authstn><Cd>ILEV</Cd></Authstn><Authstn><Prtry>PAYMENT_TELEPAY</Prtry></Authstn><NbOfTxs>2</NbOfTxs><CtrlSum>2.40</CtrlSum><InitgPty><Nm>Mentor Medier AS</Nm><Id><OrgId><AnyBIC>SHEDNO22XXX</AnyBIC><Othr><Id>122032456</Id><SchmeNm><Cd>BANK</Cd></SchmeNm></Othr><Othr><Id>537812</Id><SchmeNm><Cd>USAG</Cd></SchmeNm></Othr></OrgId></Id></InitgPty></GrpHdr><PmtInf><PmtInfId>P002_081020112413.P1</PmtInfId><PmtMtd>TRF</PmtMtd><NbOfTxs>2</NbOfTxs><CtrlSum>2.40</CtrlSum><PmtTpInf><InstrPrty>NORM</InstrPrty><CtgyPurp><Cd>SUPP</Cd></CtgyPurp></PmtTpInf><ReqdExctnDt>2020-10-08</ReqdExctnDt><Dbtr><Nm>Dagsavisen AS</Nm><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><AdrLine>Postboks 1183 Sentrum</AdrLine><AdrLine>0107 OSLO</AdrLine></PstlAdr><Id><OrgId><Othr><Id>980454347</Id><SchmeNm><Cd>CUST</Cd></SchmeNm></Othr></OrgId></Id></Dbtr><DbtrAcct><Id><Othr><Id>40680101541</Id><SchmeNm><Cd>BBAN</Cd></SchmeNm></Othr></Id></DbtrAcct><DbtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI></FinInstnId></DbtrAgt><ChrgBr>SHAR</ChrgBr><CdtTrfTxInf><PmtId><InstrId>P002_081020112413.T1</InstrId><EndToEndId>P002_081020112413.E1</EndToEndId></PmtId><PmtTpInf><LclInstrm><Prtry>TLB</Prtry></LclInstrm></PmtTpInf><Amt><InstdAmt Ccy="NOK">1.30</InstdAmt></Amt><CdtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><Ctry>NO</Ctry></PstlAdr></FinInstnId></CdtrAgt><Cdtr><Nm>ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ</Nm><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><Ctry>NO</Ctry><AdrLine>45, HASHEMESH STREET</AdrLine><AdrLine>CAESAREAISRAEL</AdrLine></PstlAdr><CtryOfRes>NO</CtryOfRes></Cdtr><CdtrAcct><Id><Othr><Id>40680103870</Id></Othr></Id></CdtrAcct><RmtInf><Strd><RfrdDocAmt><DuePyblAmt Ccy="NOK">1.30</DuePyblAmt></RfrdDocAmt><AddtlRmtInf>263009</AddtlRmtInf></Strd></RmtInf></CdtTrfTxInf><CdtTrfTxInf><PmtId><InstrId>P002_081020112413.T2</InstrId><EndToEndId>P002_081020112413.E2</EndToEndId></PmtId><PmtTpInf><LclInstrm><Prtry>TLB</Prtry></LclInstrm></PmtTpInf><Amt><InstdAmt Ccy="NOK">1.10</InstdAmt></Amt><CdtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><Ctry>NO</Ctry></PstlAdr></FinInstnId></CdtrAgt><Cdtr><Nm>ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ</Nm><PstlAdr><AdrTp>ADDR</AdrTp><PstCd>6781</PstCd><Ctry>NO</Ctry><AdrLine>45, HASHEMESH STREET</AdrLine><AdrLine>CAESAREAISRAEL</AdrLine></PstlAdr><CtryOfRes>NO</CtryOfRes></Cdtr><CdtrAcct><Id><Othr><Id>40680103870</Id></Othr></Id></CdtrAcct><RmtInf><Strd><RfrdDocAmt><DuePyblAmt Ccy="NOK">1.10</DuePyblAmt></RfrdDocAmt><AddtlRmtInf>263009</AddtlRmtInf></Strd></RmtInf></CdtTrfTxInf></PmtInf></CstmrCdtTrfInitn></Document> ]]]]>><![CDATA[</content></Wrapper>]]></con:value>
        </con:property>
        <con:property>
          <con:name>messagetoSend1</con:name>
          <con:value><![CDATA[<?xml version="1.0" encoding="UTF-8"?><Wrapper xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="urn:pin.payment.edb.com:authpain001wrapper:v1_0" ><auth><![CDATA[<?xml version="1.0" encoding="UTF-8"?><AgreementAuthorizationRequest><authRequest><agreementData><agreementId>600685</agreementId><bankId>4201</bankId><userId>10127521900</userId><userFirstName>Anita</userFirstName><userLastName>Korsgaard</userLastName><userIdType>EXTU</userIdType><productID>11</productID><organizationId>921095899</organizationId><preapproved>true</preapproved><rejectionLevel>TRANSACTION</rejectionLevel><origin>NDR</origin><allowPartialCancellation>false</allowPartialCancellation><allowCancellationPriorToPayment>false</allowCancellationPriorToPayment></agreementData><agreementAccount><accountNumber>40680101541</accountNumber><swiftAdress>SPTRNO22XXX</swiftAdress><currencyCode>NOK</currencyCode><accountType>CurrencyCoreFD</accountType><access>CREDIT_AND_DEBIT</access><bookingLevel>D</bookingLevel><approvalLimit>0</approvalLimit><registerLimit>0</registerLimit><numberOfVerifiers>0</numberOfVerifiers><numberOfApprovers>1</numberOfApprovers></agreementAccount><metaInformation><receivedTimestamp>2020-10-08T14:24:06</receivedTimestamp></metaInformation></authRequest></AgreementAuthorizationRequest> ]]]]>><![CDATA[</auth><content><![CDATA[ <?xml version="1.0" encoding="UTF-8"?><Document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="urn:iso:std:iso:20022:tech:xsd:pain.001.001.04"><CstmrCdtTrfInitn><GrpHdr><MsgId>MPT_081020112413</MsgId><CreDtTm>2020-10-08T14:24:12.053+02:00</CreDtTm><Authstn><Cd>ILEV</Cd></Authstn><Authstn><Prtry>PAYMENT_TELEPAY</Prtry></Authstn><NbOfTxs>2</NbOfTxs><CtrlSum>2.40</CtrlSum><InitgPty><Nm>Mentor Medier AS</Nm><Id><OrgId><AnyBIC>SHEDNO22XXX</AnyBIC><Othr><Id>122032456</Id><SchmeNm><Cd>BANK</Cd></SchmeNm></Othr><Othr><Id>537812</Id><SchmeNm><Cd>USAG</Cd></SchmeNm></Othr></OrgId></Id></InitgPty></GrpHdr><PmtInf><PmtInfId>MPT_081020112413.P1</PmtInfId><PmtMtd>TRF</PmtMtd><NbOfTxs>2</NbOfTxs><CtrlSum>2.40</CtrlSum><PmtTpInf><InstrPrty>NORM</InstrPrty><CtgyPurp><Cd>SUPP</Cd></CtgyPurp></PmtTpInf><ReqdExctnDt>2020-10-08</ReqdExctnDt><Dbtr><Nm>Dagsavisen AS</Nm><PstlAdr><AdrTp>ADDR</AdrTp><AdrLine>Postboks 1183 Sentrum</AdrLine><AdrLine>0107 OSLO</AdrLine></PstlAdr><Id><OrgId><Othr><Id>980454347</Id><SchmeNm><Cd>CUST</Cd></SchmeNm></Othr></OrgId></Id></Dbtr><DbtrAcct><Id><Othr><Id>40680101541</Id><SchmeNm><Cd>BBAN</Cd></SchmeNm></Othr></Id></DbtrAcct><DbtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI></FinInstnId></DbtrAgt><ChrgBr>SHAR</ChrgBr><CdtTrfTxInf><PmtId><InstrId>MPT_081020112413.T1</InstrId><EndToEndId>MPT_081020112413.E1</EndToEndId></PmtId><PmtTpInf><LclInstrm><Prtry>TLB</Prtry></LclInstrm></PmtTpInf><Amt><InstdAmt Ccy="NOK">1.30</InstdAmt></Amt><CdtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI><PstlAdr><AdrTp>ADDR</AdrTp><Ctry>NO</Ctry></PstlAdr></FinInstnId></CdtrAgt><Cdtr><Nm>ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ</Nm><PstlAdr><AdrTp>ADDR</AdrTp><Ctry>NO</Ctry><AdrLine>45, HASHEMESH STREET</AdrLine><AdrLine>CAESAREAISRAEL</AdrLine></PstlAdr><CtryOfRes>NO</CtryOfRes></Cdtr><CdtrAcct><Id><Othr><Id>40680103870</Id></Othr></Id></CdtrAcct><RmtInf><Strd><RfrdDocAmt><DuePyblAmt Ccy="NOK">1.30</DuePyblAmt></RfrdDocAmt><AddtlRmtInf>263009</AddtlRmtInf></Strd></RmtInf></CdtTrfTxInf><CdtTrfTxInf><PmtId><InstrId>MPT_081020112413.T2</InstrId><EndToEndId>MPT_081020112413.E2</EndToEndId></PmtId><PmtTpInf><LclInstrm><Prtry>TLB</Prtry></LclInstrm></PmtTpInf><Amt><InstdAmt Ccy="NOK">1.10</InstdAmt></Amt><CdtrAgt><FinInstnId><BICFI>SHEDNO22XXX</BICFI><PstlAdr><AdrTp>ADDR</AdrTp><Ctry>NO</Ctry></PstlAdr></FinInstnId></CdtrAgt><Cdtr><Nm>ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ ROGER HERCZ</Nm><PstlAdr><AdrTp>ADDR</AdrTp><Ctry>NO</Ctry><AdrLine>45, HASHEMESH STREET</AdrLine><AdrLine>CAESAREAISRAEL</AdrLine></PstlAdr><CtryOfRes>NO</CtryOfRes></Cdtr><CdtrAcct><Id><Othr><Id>40680103870</Id></Othr></Id></CdtrAcct><RmtInf><Strd><RfrdDocAmt><DuePyblAmt Ccy="NOK">1.10</DuePyblAmt></RfrdDocAmt><AddtlRmtInf>263009</AddtlRmtInf></Strd></RmtInf></CdtTrfTxInf></PmtInf></CstmrCdtTrfInitn></Document> ]]]]>><![CDATA[</content></Wrapper>]]></con:value>
        </con:property>
        <con:property>
          <con:name>assignmentID</con:name>
          <con:value>C081020112434</con:value>
        </con:property>
        <con:property>
          <con:name>messageToSendCamt055General</con:name>
          <con:value><![CDATA[<?xml version="1.0" encoding="UTF-8"?><Wrapper xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="urn:pin.payment.edb.com:authpain001wrapper:v1_0"><auth><![CDATA[<?xml version="1.0" encoding="UTF-8"?><AgreementAuthorizationRequest><authRequest><agreementData><agreementId>600685</agreementId><bankId>BANKID</bankId><userId>CUSTOMERID</userId><userFirstName>Ext.Telepay</userFirstName><userLastName>EvryFileArchive</userLastName><userIdType>EXTU</userIdType><productID>0</productID><organizationId>921095899</organizationId><preapproved>true</preapproved><rejectionLevel>TRANSACTION</rejectionLevel><origin>PAYMUL</origin><allowPartialCancellation>false</allowPartialCancellation><allowCancellationPriorToPayment>false</allowCancellationPriorToPayment></agreementData><agreementAccount><accountNumber>ACCOUNTID</accountNumber><swiftAdress>SPTRNO22XXX</swiftAdress><currencyCode>NOK</currencyCode><accountType>CoreAccount</accountType><access>CREDIT_AND_DEBIT</access><bookingLevel>T</bookingLevel><approvalLimit>10000000</approvalLimit><registerLimit>10000000</registerLimit><numberOfVerifiers>0</numberOfVerifiers><numberOfApprovers>0</numberOfApprovers></agreementAccount><metaInformation><receivedTimestamp>DATET00:05:37</receivedTimestamp></metaInformation></authRequest></AgreementAuthorizationRequest>]]]]>><![CDATA[</auth><content><![CDATA[<?xml version="1.0" encoding="UTF-8"?><Document xmlns="urn:iso:std:iso:20022:tech:xsd:camt.055.001.01"><CstmrPmtCxlReq><Assgnmt><Id>ASSIGNMENTID</Id><Assgnr><Pty><Nm>sanath685</Nm><PstlAdr><StrtNm>TimesSquare</StrtNm><BldgNb>7</BldgNb><PstCd>NY</PstCd><TwnNm>NewYork</TwnNm><Ctry>US</Ctry></PstlAdr><Id><PrvtId><Othr><Id>san600685</Id></Othr></PrvtId></Id></Pty></Assgnr><Assgne><Agt><FinInstnId><BIC>BBBBUS33</BIC></FinInstnId></Agt></Assgne><CreDtTm>DATET16:05:30</CreDtTm></Assgnmt><Undrlyg><OrgnlPmtInfAndCxl><OrgnlPmtInfId>OPMTID</OrgnlPmtInfId><OrgnlGrpInf><OrgnlMsgId>OMSGID</OrgnlMsgId><OrgnlMsgNmId>camt555</OrgnlMsgNmId></OrgnlGrpInf><NbOfTxs>1</NbOfTxs><PmtInfCxl>true</PmtInfCxl></OrgnlPmtInfAndCxl></Undrlyg><Undrlyg><OrgnlPmtInfAndCxl><OrgnlPmtInfId>MPTD</OrgnlPmtInfId><OrgnlGrpInf><OrgnlMsgId>MPTID</OrgnlMsgId><OrgnlMsgNmId>camt555</OrgnlMsgNmId></OrgnlGrpInf><NbOfTxs>1</NbOfTxs><PmtInfCxl>false</PmtInfCxl><TxInf><OrgnlInstrId>TXNID</OrgnlInstrId></TxInf></OrgnlPmtInfAndCxl></Undrlyg></CstmrPmtCxlReq></Document>]]]]>><![CDATA[</content></Wrapper>]]></con:value>
        </con:property>
        <con:property>
          <con:name>messagetoSendCamt055</con:name>
          <con:value><![CDATA[<?xml version="1.0" encoding="UTF-8"?><Wrapper xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="urn:pin.payment.edb.com:authpain001wrapper:v1_0"><auth><![CDATA[<?xml version="1.0" encoding="UTF-8"?><AgreementAuthorizationRequest><authRequest><agreementData><agreementId>600685</agreementId><bankId>4201</bankId><userId>10127521900</userId><userFirstName>Ext.Telepay</userFirstName><userLastName>EvryFileArchive</userLastName><userIdType>EXTU</userIdType><productID>0</productID><organizationId>921095899</organizationId><preapproved>true</preapproved><rejectionLevel>TRANSACTION</rejectionLevel><origin>PAYMUL</origin><allowPartialCancellation>false</allowPartialCancellation><allowCancellationPriorToPayment>false</allowCancellationPriorToPayment></agreementData><agreementAccount><accountNumber>40680101541</accountNumber><swiftAdress>SPTRNO22XXX</swiftAdress><currencyCode>NOK</currencyCode><accountType>CoreAccount</accountType><access>CREDIT_AND_DEBIT</access><bookingLevel>T</bookingLevel><approvalLimit>10000000</approvalLimit><registerLimit>10000000</registerLimit><numberOfVerifiers>0</numberOfVerifiers><numberOfApprovers>0</numberOfApprovers></agreementAccount><metaInformation><receivedTimestamp>2020-10-08T00:05:37</receivedTimestamp></metaInformation></authRequest></AgreementAuthorizationRequest>]]]]>><![CDATA[</auth><content><![CDATA[<?xml version="1.0" encoding="UTF-8"?><Document xmlns="urn:iso:std:iso:20022:tech:xsd:camt.055.001.01"><CstmrPmtCxlReq><Assgnmt><Id>C081020112434</Id><Assgnr><Pty><Nm>sanath685</Nm><PstlAdr><StrtNm>TimesSquare</StrtNm><BldgNb>7</BldgNb><PstCd>NY</PstCd><TwnNm>NewYork</TwnNm><Ctry>US</Ctry></PstlAdr><Id><PrvtId><Othr><Id>san600685</Id></Othr></PrvtId></Id></Pty></Assgnr><Assgne><Agt><FinInstnId><BIC>BBBBUS33</BIC></FinInstnId></Agt></Assgne><CreDtTm>2020-10-08T16:05:30</CreDtTm></Assgnmt><Undrlyg><OrgnlPmtInfAndCxl><OrgnlPmtInfId>P002_081020112413.P1</OrgnlPmtInfId><OrgnlGrpInf><OrgnlMsgId>P002_081020112413</OrgnlMsgId><OrgnlMsgNmId>camt555</OrgnlMsgNmId></OrgnlGrpInf><NbOfTxs>1</NbOfTxs><PmtInfCxl>true</PmtInfCxl></OrgnlPmtInfAndCxl></Undrlyg><Undrlyg><OrgnlPmtInfAndCxl><OrgnlPmtInfId>MPT_081020112413.P1</OrgnlPmtInfId><OrgnlGrpInf><OrgnlMsgId>MPT_081020112413</OrgnlMsgId><OrgnlMsgNmId>camt555</OrgnlMsgNmId></OrgnlGrpInf><NbOfTxs>1</NbOfTxs><PmtInfCxl>false</PmtInfCxl><TxInf><OrgnlInstrId>MPT_081020112413.T1</OrgnlInstrId></TxInf></OrgnlPmtInfAndCxl></Undrlyg></CstmrPmtCxlReq></Document>]]]]>><![CDATA[</content></Wrapper>]]></con:value>
        </con:property>
        <con:property>
          <con:name>expectedStatusReasonCamt055</con:name>
          <con:value>ACCP</con:value>
        </con:property>
        <con:property>
          <con:name>actualStatusReasonCamt055</con:name>
          <con:value>ACCP</con:value>
        </con:property>
        <con:property>
          <con:name>expectedStatusCamt029</con:name>
          <con:value>CNCL</con:value>
        </con:property>
        <con:property>
          <con:name>actualStatusCamt029</con:name>
          <con:value>CNCL</con:value>
        </con:property>
        <con:property>
          <con:name>TxnExpectedStatusCamt029</con:name>
          <con:value>ACCR</con:value>
        </con:property>
        <con:property>
          <con:name>TxnactualStatusCamt029</con:name>
          <con:value>ACCR</con:value>
        </con:property>
        <con:property>
          <con:name>receiveMessageCamt055</con:name>
          <con:value><![CDATA[<Document xmlns="urn:iso:std:iso:20022:tech:xsd:pain.002.001.04">
    <CstmrPmtStsRpt>
        <GrpHdr>
            <MsgId>600685.6848867867776293188.1597</MsgId>
            <CreDtTm>2020-10-08T19:54:36.747+02:00</CreDtTm>
            <InitgPty>
                <Nm>sanath685</Nm>
                <PstlAdr>
                    <StrtNm>TimesSquare</StrtNm>
                    <BldgNb>7</BldgNb>
                    <PstCd>NY</PstCd>
                    <TwnNm>NewYork</TwnNm>
                    <Ctry>US</Ctry>
                </PstlAdr>
                <Id>
                    <OrgId>
                        <AnyBIC>SPTRNO22XXX</AnyBIC>
                    </OrgId>
                    <PrvtId>
                        <Othr>
                            <Id>san600685</Id>
                        </Othr>
                    </PrvtId>
                </Id>
            </InitgPty>
        </GrpHdr>
        <OrgnlGrpInfAndSts>
            <OrgnlMsgId>C081020112434</OrgnlMsgId>
            <OrgnlMsgNmId>camt.055.001.01</OrgnlMsgNmId>
            <GrpSts>ACCP</GrpSts>
        </OrgnlGrpInfAndSts>
    </CstmrPmtStsRpt>
</Document>]]></con:value>
        </con:property>
        <con:property>
          <con:name>receiveMessageCamt029</con:name>
          <con:value><![CDATA[<Document xmlns="urn:iso:std:iso:20022:tech:xsd:camt.029.001.03">
  <RsltnOfInvstgtn><!-- [CAMT055][C081020112434] -->
    <Assgnmt>
      <Id>600685.7904233241495651768.1597</Id>
      <Assgnr>
        <Agt>
          <FinInstnId>
            <BIC>BBBBUS33</BIC>
          </FinInstnId>
        </Agt>
      </Assgnr>
      <Assgne>
        <Pty>
          <Nm>sanath685</Nm>
          <PstlAdr>
            <StrtNm>TimesSquare</StrtNm>
            <BldgNb>7</BldgNb>
            <PstCd>NY</PstCd>
            <TwnNm>NewYork</TwnNm>
            <Ctry>US</Ctry>
          </PstlAdr>
          <Id>
            <PrvtId>
              <Othr>
                <Id>san600685</Id>
              </Othr>
            </PrvtId>
          </Id>
        </Pty>
      </Assgne>
      <CreDtTm>2020-10-08T19:54:36.735+02:00</CreDtTm>
    </Assgnmt>
    <Sts>
      <Conf>CNCL</Conf>
    </Sts>
    <CxlDtls>
      <OrgnlPmtInfAndSts>
        <OrgnlPmtInfId>P002_081020112413.P1</OrgnlPmtInfId>
        <OrgnlGrpInf>
          <OrgnlMsgId>P002_081020112413</OrgnlMsgId>
          <OrgnlMsgNmId>pain.001.001.04</OrgnlMsgNmId>
          <OrgnlCreDtTm>2020-10-08T19:54:36.780+02:00</OrgnlCreDtTm>
        </OrgnlGrpInf>
        <OrgnlNbOfTxs>2</OrgnlNbOfTxs>
        <OrgnlCtrlSum>2.4</OrgnlCtrlSum>
        <TxInfAndSts>
          <OrgnlInstrId>P002_081020112413.T1</OrgnlInstrId>
          <OrgnlEndToEndId>P002_081020112413.E1</OrgnlEndToEndId>
          <TxCxlSts>ACCR</TxCxlSts>
        </TxInfAndSts>
        <TxInfAndSts>
          <OrgnlInstrId>P002_081020112413.T2</OrgnlInstrId>
          <OrgnlEndToEndId>P002_081020112413.E2</OrgnlEndToEndId>
          <TxCxlSts>ACCR</TxCxlSts>
        </TxInfAndSts>
      </OrgnlPmtInfAndSts>
    </CxlDtls>
    <CxlDtls>
      <OrgnlPmtInfAndSts>
        <OrgnlPmtInfId>MPT_081020112413.P1</OrgnlPmtInfId>
        <OrgnlGrpInf>
          <OrgnlMsgId>MPT_081020112413</OrgnlMsgId>
          <OrgnlMsgNmId>pain.001.001.04</OrgnlMsgNmId>
          <OrgnlCreDtTm>2020-10-08T19:54:36.780+02:00</OrgnlCreDtTm>
        </OrgnlGrpInf>
        <OrgnlNbOfTxs>2</OrgnlNbOfTxs>
        <OrgnlCtrlSum>2.4</OrgnlCtrlSum>
        <TxInfAndSts>
          <OrgnlInstrId>MPT_081020112413.T1</OrgnlInstrId>
          <TxCxlSts>ACCR</TxCxlSts>
        </TxInfAndSts>
      </OrgnlPmtInfAndSts>
    </CxlDtls>
  </RsltnOfInvstgtn>
</Document>]]></con:value>
        </con:property>
        <con:property>
          <con:name>pmtID</con:name>
          <con:value>P002_081020112413.P1</con:value>
        </con:property>
        <con:property>
          <con:name>txnId</con:name>
          <con:value>MPT_081020112413.T1</con:value>
        </con:property>
        <con:property>
          <con:name>pmtID1</con:name>
          <con:value>MPT_081020112413.P1</con:value>
        </con:property>
        <con:property>
          <con:name>2TxnExpectedStatusCamt029</con:name>
          <con:value>ACCR</con:value>
        </con:property>
        <con:property>
          <con:name>3TxnExpectedStatusCamt029</con:name>
          <con:value>ACCR</con:value>
        </con:property>
        <con:property>
          <con:name>2TxnactualStatusCamt029</con:name>
          <con:value>ACCR</con:value>
        </con:property>
        <con:property>
          <con:name>3TxnactualStatusCamt029</con:name>
          <con:value>ACCR</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="PreparePAIN001File" id="9a068af6-d842-4b72-96e7-a302ab3e1be1">
    <con:settings/>
    <con:config>
      <script>import com.eviware.soapui.support.GroovyUtils.*
import java.io.File 
import java.io.Reader

//MsgID
def MsgID = testRunner.testCase.getTestStepByName("Properties").getPropertyValue('msgID');
def MsgID1 = testRunner.testCase.getTestStepByName("Properties").getPropertyValue('msgID1');
log.info MsgID;
log.info MsgID1;
//Initial Message to send
def messageToSend = context.expand( '${Properties#MessageToSendFormat}' )
def messageToSend1 = context.expand( '${Properties#MessageToSendFormat1}' )
log.info(messageToSend)

//Parmeters needed in message
def Account = context.expand( '${Properties#accountNumber}' )
def customerid = context.expand( '${Properties#customerid}' )
def dueDate = context.expand( '${Properties#dueDate}' )
def BANKID = context.expand( '${Properties#bankId}' )
def creditorAccountNumber = context.expand( '${Properties#creditorAccountNumber}' )

def pmtID = MsgID+'.P1'
def txnId = MsgID1+'.T1'
def pmtID1 = MsgID1+'.P1'

//Replace parmaeters in message by respective values
messageToSend = messageToSend.replaceAll("TIMESTAMP",MsgID) ;
messageToSend = messageToSend.replaceAll("CUSTOMERID",customerid) ;
messageToSend = messageToSend.replaceAll("ACCOUNTID",Account) ;
messageToSend = messageToSend.replaceAll("DATE",dueDate) ;
messageToSend = messageToSend.replaceAll("BANKID",BANKID) ;
messageToSend = messageToSend.replaceAll("CREDITORACCOUNTNUMBER",creditorAccountNumber) ;


log.info messageToSend


messageToSend1 = messageToSend1.replaceAll("TIMESTAMP1",MsgID1) ;
messageToSend1 = messageToSend1.replaceAll("CUSTOMERID",customerid) ;
messageToSend1 = messageToSend1.replaceAll("ACCOUNTID",Account) ;
messageToSend1 = messageToSend1.replaceAll("DATE",dueDate) ;
messageToSend1 = messageToSend1.replaceAll("BANKID",BANKID) ;
messageToSend1 = messageToSend1.replaceAll("CREDITORACCOUNTNUMBER",creditorAccountNumber) ;
//Set 'messagetoSend_currentTC  property value with updated message
def update = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("messagetoSend",messageToSend);
def update1 = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("messagetoSend1",messageToSend1);
def opmtId = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("pmtID",pmtID);
def TxnId = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("txnId",txnId);
def opmtId1 = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("pmtID1",pmtID1);</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="PushAndReceiveFilePayment" id="d1c8b0a5-bafe-479e-ba06-d954e7bc593e">
    <con:settings/>
    <con:config>
      <script>// File payment content property
import MQMessageUtils;

def filecontent = context.expand( '${Properties#messagetoSend#declare namespace ns1=\'urn:pin.payment.edb.com:authpain001wrapper:v1_0\'; //ns1:Wrapper[1]}' )
log.info(filecontent)

//def filecontent = context.expand( '${TestCase#messagetoSend}' )

// Set MQ properties
def mQHostName = context.expand( '${#Project#mqHostname}' )
def int mQPort = context.expand( '${#Project#mqPort}' ) as Integer
def mQQueuemanager = context.expand( '${#Project#mqManager}' )
def mQChannelAuth = context.expand( '${#Project#mqChannelAuth}' )
def mQMessageQueueSend = context.expand( '${#Project#sendQueuePAIN001}' )
def mQMessageQueueRecieve = context.expand( '${#Project#receiveQueuePAIN001}' )
def msgId = context.expand( '${Properties#msgId}' )


// Create utility class object, Create MQ connection
MQMessageUtils mqMessageUtils = new MQMessageUtils(mQQueuemanager,mQHostName,mQPort,mQChannelAuth,log);
// Send Message to MQ
log.info ("Message Sent :" + mqMessageUtils.sendMessage(mQMessageQueueSend,filecontent));
//// Receive message from MQ
//String receiveMessage = mqMessageUtils.receiveMessage(mQMessageQueueRecieve);
////Check results only if received message
//log.info msgId
//if (!(("No messsage").equals(receiveMessage))){
//	def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
//	def response = groovyUtils.getXmlHolder(receiveMessage)
//	log.info  response.getNodeValue("//*:OrgnlMsgId");
//	ArrayList&lt;String> list= response.getNodeValues("//*:AddtlInf");
//	log.info list;
//// TO DO : Add more things here, Based on subsequest test steps, Take MessageIdentification sent and received message and give input to seaches.
//}
//// No message
//else log.info "No message received"</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="PushAndReceiveSecondFilePayment" id="8f786e90-253d-4c20-bd82-9c850fdf8ce8">
    <con:settings/>
    <con:config>
      <script>// File payment content property
import MQMessageUtils;

def filecontent = context.expand( '${Properties#messagetoSend1#declare namespace ns1=\'urn:pin.payment.edb.com:authpain001wrapper:v1_0\'; //ns1:Wrapper[1]}' )
log.info(filecontent)

//def filecontent = context.expand( '${TestCase#messagetoSend}' )

// Set MQ properties
def mQHostName = context.expand( '${#Project#mqHostname}' )
def int mQPort = context.expand( '${#Project#mqPort}' ) as Integer
def mQQueuemanager = context.expand( '${#Project#mqManager}' )
def mQChannelAuth = context.expand( '${#Project#mqChannelAuth}' )
def mQMessageQueueSend = context.expand( '${#Project#sendQueuePAIN001}' )
def mQMessageQueueRecieve = context.expand( '${#Project#receiveQueuePAIN001}' )
def msgId = context.expand( '${Properties#msgId1}' )


// Create utility class object, Create MQ connection
MQMessageUtils mqMessageUtils = new MQMessageUtils(mQQueuemanager,mQHostName,mQPort,mQChannelAuth,log);
// Send Message to MQ
log.info ("Message Sent :" + mqMessageUtils.sendMessage(mQMessageQueueSend,filecontent));
//// Receive message from MQ
//String receiveMessage = mqMessageUtils.receiveMessage(mQMessageQueueRecieve);
////Check results only if received message
//log.info msgId
//if (!(("No messsage").equals(receiveMessage))){
//	def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
//	def response = groovyUtils.getXmlHolder(receiveMessage)
//	log.info  response.getNodeValue("//*:OrgnlMsgId");
//	ArrayList&lt;String> list= response.getNodeValues("//*:AddtlInf");
//	log.info list;
//// TO DO : Add more things here, Based on subsequest test steps, Take MessageIdentification sent and received message and give input to seaches.
//}
//// No message
//else log.info "No message received"</script>
    </con:config>
  </con:testStep>
  <con:testStep type="delay" name="Delay" id="60a84e61-5520-4134-9fd8-ce56ae07affb">
    <con:settings/>
    <con:config>
      <delay>10000</delay>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="TRANSACTIONSFile1" id="29efb622-adf8-4958-9a91-d8dbb744c604">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>Database</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_d4)))</con:connectionString>
      <con:password/>
      <con:connectionProperties/>
      <con:query>SELECT 
  TRANSACTIONSID ,
  ENDTOENDID ,
  PAYMENTTYPE,
  PAYMENTSTATUS,
  ISPC ,
FK_PROCESSINGLINEID 
FROM 
  TRANSACTIONS 
WHERE 
  ENDTOENDID LIKE '%${Properties#msgID}%'</con:query>
      <con:storedProcedure>false</con:storedProcedure>
      <con:assertion type="MessageContentAssertion" id="8e97c887-32b1-4c89-8f5a-4e8a7d8c4bc2" name="Message Content Assertion">
        <con:configuration xsi:type="con:MessageContentAssertion">
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/@fetchSize</con:xpath>
            <con:element>@fetchSize</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>10</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/TRANSACTIONSID[1]</con:xpath>
            <con:element>TRANSACTIONSID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>173226</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/ENDTOENDID[1]</con:xpath>
            <con:element>ENDTOENDID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>P002_15720050145.E1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/PAYMENTTYPE[1]</con:xpath>
            <con:element>PAYMENTTYPE</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>DOMS</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/PAYMENTSTATUS[1]</con:xpath>
            <con:element>PAYMENTSTATUS</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>RFDD</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/ISPC[1]</con:xpath>
            <con:element>ISPC</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>PAYCTDOMOUPSME</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/FK_PROCESSINGLINEID[1]</con:xpath>
            <con:element>FK_PROCESSINGLINEID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>50</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>2</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/PAYMENTSTATUS[1]</con:xpath>
            <con:element>PAYMENTSTATUS</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>RFDD</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:originalMessage><![CDATA[<Results>
   <ResultSet fetchSize="10">
      <Row rowNumber="1">
         <TRANSACTIONSID>173226</TRANSACTIONSID>
         <ENDTOENDID>P002_15720050145.E1</ENDTOENDID>
         <PAYMENTTYPE>DOMS</PAYMENTTYPE>
         <PAYMENTSTATUS>RFDD</PAYMENTSTATUS>
         <ISPC>PAYCTDOMOUPSME</ISPC>
         <FK_PROCESSINGLINEID>50</FK_PROCESSINGLINEID>
      </Row>
      <Row rowNumber="2">
         <TRANSACTIONSID>173227</TRANSACTIONSID>
         <ENDTOENDID>P002_15720050145.E2</ENDTOENDID>
         <PAYMENTTYPE>DOMS</PAYMENTTYPE>
         <PAYMENTSTATUS>RFDD</PAYMENTSTATUS>
         <ISPC>PAYCTDOMOUPSME</ISPC>
         <FK_PROCESSINGLINEID>50</FK_PROCESSINGLINEID>
      </Row>
   </ResultSet>
</Results>]]></con:originalMessage>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="TRANSACTIONSFile2" id="ee9805f6-f816-4249-b0c0-89baf0498c42">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>Database</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_d4)))</con:connectionString>
      <con:password/>
      <con:connectionProperties/>
      <con:query>SELECT 
  TRANSACTIONSID ,
  ENDTOENDID ,
  PAYMENTTYPE,
  PAYMENTSTATUS,
  ISPC ,
FK_PROCESSINGLINEID 
FROM 
  TRANSACTIONS 
WHERE 
  ENDTOENDID LIKE '%${Properties#msgID1}%'</con:query>
      <con:storedProcedure>false</con:storedProcedure>
      <con:assertion type="MessageContentAssertion" id="8e97c887-32b1-4c89-8f5a-4e8a7d8c4bc2" name="Message Content Assertion">
        <con:configuration xsi:type="con:MessageContentAssertion">
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/@fetchSize</con:xpath>
            <con:element>@fetchSize</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>10</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/TRANSACTIONSID[1]</con:xpath>
            <con:element>TRANSACTIONSID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>173240</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/ENDTOENDID[1]</con:xpath>
            <con:element>ENDTOENDID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>MPT_15720063230.E1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/PAYMENTTYPE[1]</con:xpath>
            <con:element>PAYMENTTYPE</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>DOMS</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/PAYMENTSTATUS[1]</con:xpath>
            <con:element>PAYMENTSTATUS</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>RFDD</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/ISPC[1]</con:xpath>
            <con:element>ISPC</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>PAYCTDOMOUPSME</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/FK_PROCESSINGLINEID[1]</con:xpath>
            <con:element>FK_PROCESSINGLINEID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>50</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:originalMessage><![CDATA[<Results>
   <ResultSet fetchSize="10">
      <Row rowNumber="1">
         <TRANSACTIONSID>173240</TRANSACTIONSID>
         <ENDTOENDID>MPT_15720063230.E1</ENDTOENDID>
         <PAYMENTTYPE>DOMS</PAYMENTTYPE>
         <PAYMENTSTATUS>RFDD</PAYMENTSTATUS>
         <ISPC>PAYCTDOMOUPSME</ISPC>
         <FK_PROCESSINGLINEID>50</FK_PROCESSINGLINEID>
      </Row>
   </ResultSet>
</Results>]]></con:originalMessage>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="PrepareCamt055File" id="7caf1fa8-1f5e-4428-8562-700bc3571cfd">
    <con:settings/>
    <con:config>
      <script>import com.eviware.soapui.support.GroovyUtils.*
import java.io.File 
import java.io.Reader
import java.text.SimpleDateFormat

Date date = new Date();
SimpleDateFormat fn = new SimpleDateFormat("ddMyyhhmmss");
def datetime = fn.format(date)
log.info datetime

def assignmentID = "C"+datetime;
log.info assignmentID
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("assignmentID",assignmentID );

//MsgID
ASSIGNMENTID = testRunner.testCase.getTestStepByName("Properties").getPropertyValue('assignmentID');
log.info ASSIGNMENTID;

//Initial Message to send
def messageToSend = context.expand( '${Properties#messageToSendCamt055General}' )
log.info(messageToSend)

//Parmeters needed in message
def Account = context.expand( '${Properties#accountNumber}' )
def customerid = context.expand( '${Properties#customerid}' )
def dueDate = context.expand( '${Properties#dueDate}' )
def BANKID = context.expand( '${Properties#bankId}' )
def MsgID = context.expand( '${Properties#msgID}' )
def pmtID = context.expand( '${Properties#pmtID}' )
def txnId = context.expand( '${Properties#txnId}' )
def MsgID1 = context.expand( '${Properties#msgID1}' )
def pmtID1 = context.expand( '${Properties#pmtID1}' )
log.info "MsgID1 : " + MsgID1
log.info "pmtID1 : " + pmtID1

//Replace parmaeters in message by respective values
messageToSend = messageToSend.replaceAll("ASSIGNMENTID",ASSIGNMENTID) ;
messageToSend = messageToSend.replaceAll("OMSGID",MsgID) ;
messageToSend = messageToSend.replaceAll("MPTID",MsgID1) ;
messageToSend = messageToSend.replaceAll("CUSTOMERID",customerid) ;
messageToSend = messageToSend.replaceAll("ACCOUNTID",Account) ;
messageToSend = messageToSend.replaceAll("DATE",dueDate) ;
messageToSend = messageToSend.replaceAll("BANKID",BANKID) ;
messageToSend = messageToSend.replaceAll("OPMTID",pmtID) ;
messageToSend = messageToSend.replaceAll("MPTD",pmtID1) ;
messageToSend = messageToSend.replaceAll("TXNID",txnId) ;
log.info messageToSend

//Set 'messagetoSend_currentTC  property value with updated message
def update = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("messagetoSendCamt055",messageToSend);</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="PushAndReceive_Camt055" id="ba989d2d-a8b2-4795-8581-e19087f46212">
    <con:settings/>
    <con:config>
      <script>// File payment content property
import MQMessageUtils;


def filecontent = context.expand( '${Properties#messagetoSendCamt055#declare namespace ns1=\'urn:pin.payment.edb.com:authpain001wrapper:v1_0\'; //ns1:Wrapper[1]}' )
log.info(filecontent)



// Set MQ properties
def mQHostName = context.expand( '${#Project#mqHostname}' )
def int mQPort = context.expand( '${#Project#mqPort}' ) as Integer
def mQQueuemanager = context.expand( '${#Project#mqManager}' )
def mQChannelAuth = context.expand( '${#Project#mqChannelAuth}' )
def mQMessageQueueSend = context.expand( '${#Project#sendQueueCamt055}' )
def mQMessageQueueRecieve = context.expand( '${#Project#receiveQueueCamt055}' )
def mQMessageQueueReceiveCamt029 = context.expand( '${#Project#receiveQueueCamt029}' )

def assignmentID = context.expand( '${Properties#assignmentID}' )
def msgId = context.expand( '${Properties#msgID}' )



// Create utility class object, Create MQ connection
MQMessageUtils mqMessageUtils = new MQMessageUtils(mQQueuemanager,mQHostName,mQPort,mQChannelAuth,log);
// Send Message to MQ
log.info ("Message Sent :" + mqMessageUtils.sendMessage(mQMessageQueueSend,filecontent));
//// Receive message from MQ
////String receiveMessageCamt055 = mqMessageUtils.browseMessage(mQMessageQueueRecieve,assignmentID);
//String receiveMessage = mqMessageUtils.browseMessage(mQMessageQueueRecieve,assignmentID);
//String receiveMessage1 = mqMessageUtils.browseMessage(mQMessageQueueReceiveCamt029,msgId);
////Check results only if received message
//
//log.info "receiveMessageCamt055 : " + receiveMessage
//log.info "receiveMessageCamt029 : " + receiveMessage1
//
//def receiveCamt055 = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("receiveMessageCamt055",receiveMessage);
//def receiveCamt029 = testRunner.testCase.getTestStepByName("Properties").setPropertyValue("receiveMessageCamt029",receiveMessage1);
//
//log.info "assignmentID: " + assignmentID
//log.info "msgId: " + msgId
//
//if (!(("No messsage").equals(receiveMessage))){
//	def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
//	def response = groovyUtils.getXmlHolder(receiveMessage)
//	log.info  response.getNodeValue("//*:OrgnlMsgId");
//	ArrayList&lt;String> statusCamt055= response.getNodeValues("//*:GrpSts");
//	log.info statusCamt055;
//testRunner.testCase.getTestStepByName("Properties").setPropertyValue("actualStatusReasonCamt055",statusCamt055[0]);
//}
//if (!(("No messsage").equals(receiveMessage1))){
//	def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
//	def responseCamt029 = groovyUtils.getXmlHolder(receiveMessage1)
//	log.info  "OrgnlMsgId : " +  responseCamt029.getNodeValue("//*:OrgnlMsgId");
//	ArrayList&lt;String> statusCamt029= responseCamt029.getNodeValues("//*:Conf");
//	ArrayList&lt;String> TxnstatusCamt029= responseCamt029.getNodeValues("//*:TxCxlSts");		
//	log.info statusCamt029;
//	log.info TxnstatusCamt029;
//testRunner.testCase.getTestStepByName("Properties").setPropertyValue("actualStatusCamt029",statusCamt029[0]);
//testRunner.testCase.getTestStepByName("Properties").setPropertyValue("TxnactualStatusCamt029",TxnstatusCamt029[0]);
//testRunner.testCase.getTestStepByName("Properties").setPropertyValue("2TxnactualStatusCamt029",TxnstatusCamt029[1]);
//testRunner.testCase.getTestStepByName("Properties").setPropertyValue("3TxnactualStatusCamt029",TxnstatusCamt029[2]);
//// TO DO : Add more things here, Based on subsequest test steps, Take MessageIdentification sent and received message and give input to seaches.
//}
//
//// No message
//else log.info "No message received"</script>
    </con:config>
  </con:testStep>
  <con:testStep type="delay" name="Delay1" id="86d52d9b-be84-4474-8a2e-ffb5eddef9a6">
    <con:settings/>
    <con:config>
      <delay>3000</delay>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="ValidatePAIN002Logs" id="1664405f-1d39-4d59-9d83-bf70dab7d5b5">
    <con:settings/>
    <con:config>
      <script>import groovy.json.JsonSlurper

def strHost = context.expand( '${#Project#EBSHost}' )
def strUsername = context.expand( '${#Project#UserName}' )
def strPassword = context.expand( '${#Project#Password}' )
def  intPort = context.expand( '${#Project#Port}' )
def CPSLogStr
def env = testRunner.testCase.testSuite.project.getActiveEnvironmentName().toLowerCase()
env=env.substring(2)
def strFileDirectory = "/ebs/$env/pin/logs/piPaymentProcessor"

def strLogRef = context.expand( '${Properties#LogRef}' )

if (!(ServerConnect.Connect(strHost ,strUsername, strPassword, Integer.parseInt(intPort)) == "PASS"))
               assert false," Failed to conenct to linux server!!"
else
			log.info "Connected to the server successfully!!"

def assignmentID = context.expand( '${Properties#assignmentID}' )
assignmentID = "&lt;OrgnlMsgId>$assignmentID&lt;/OrgnlMsgId>"

def assignmentIDCamt29 = context.expand( '${Properties#assignmentID}' )
assignmentIDCamt29 = "\\[$assignmentIDCamt29]"
//log.info "assignmentIDCamt29--$assignmentIDCamt29"

String command2="cd $strFileDirectory;grep -B 27 -A 5 '$assignmentID'   mqpayload.log";
def pain002 = ServerConnect.execCommand(command2)

command2="cd $strFileDirectory;grep -B 1 -A 73 '$assignmentIDCamt29'   mqpayload.log";
def camt029 = ServerConnect.execCommand(command2)

testRunner.testCase.getTestStepByName("Properties").setPropertyValue("receiveMessageCamt055",pain002);
testRunner.testCase.getTestStepByName("Properties").setPropertyValue("receiveMessageCamt029",camt029);

if (!(("No messsage").equals(pain002))){
	def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
	def response = groovyUtils.getXmlHolder(pain002)
//	log.info  response.getNodeValue("//*:OrgnlMsgId");
	ArrayList&lt;String> statusCamt055= response.getNodeValues("//*:GrpSts");
	log.info statusCamt055;
	testRunner.testCase.getTestStepByName("Properties").setPropertyValue("actualStatusReasonCamt055",statusCamt055[0]);
}
if (!(("No messsage").equals(camt029))){
	def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context ) 
	def responseCamt029 = groovyUtils.getXmlHolder(camt029)
	log.info  "OrgnlMsgId : " +  responseCamt029.getNodeValue("//*:OrgnlMsgId");
	ArrayList&lt;String> statusCamt029= responseCamt029.getNodeValues("//*:Conf");
	ArrayList&lt;String> TxnstatusCamt029= responseCamt029.getNodeValues("//*:TxCxlSts");		
//	log.info statusCamt029;
//	log.info TxnstatusCamt029;
	testRunner.testCase.getTestStepByName("Properties").setPropertyValue("actualStatusCamt029",statusCamt029[0]);
	testRunner.testCase.getTestStepByName("Properties").setPropertyValue("TxnactualStatusCamt029",TxnstatusCamt029[0]);
	testRunner.testCase.getTestStepByName("Properties").setPropertyValue("2TxnactualStatusCamt029",TxnstatusCamt029[1]);
	testRunner.testCase.getTestStepByName("Properties").setPropertyValue("3TxnactualStatusCamt029",TxnstatusCamt029[2]);
// TO DO : Add more things here, Based on subsequest test steps, Take MessageIdentification sent and received message and give input to seaches.
}</script>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="TRANSACTIONS_CANC" id="70ed09ce-5d8b-4dd9-b8c8-0d5b25dfd503">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dbConnectionName>Database</con:dbConnectionName>
      <con:driver>oracle.jdbc.driver.OracleDriver</con:driver>
      <con:connectionString>jdbc:oracle:thin:pwhdata/pwh@(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=ON)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dlt-exa853-scan.unix.cosng.net)(PORT=1530)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=pwh_g_d4)))</con:connectionString>
      <con:password/>
      <con:connectionProperties/>
      <con:query>SELECT 
  TRANSACTIONSID ,
  ENDTOENDID ,
  PAYMENTTYPE,
  PAYMENTSTATUS,
  ISPC ,
FK_PROCESSINGLINEID 
FROM 
  TRANSACTIONS 
WHERE 
  ENDTOENDID LIKE '%${Properties#msgID}%'</con:query>
      <con:storedProcedure>false</con:storedProcedure>
      <con:assertion type="MessageContentAssertion" id="8e97c887-32b1-4c89-8f5a-4e8a7d8c4bc2" name="Message Content Assertion">
        <con:configuration xsi:type="con:MessageContentAssertion">
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/@fetchSize</con:xpath>
            <con:element>@fetchSize</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>10</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/TRANSACTIONSID[1]</con:xpath>
            <con:element>TRANSACTIONSID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>173405</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/ENDTOENDID[1]</con:xpath>
            <con:element>ENDTOENDID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>P002_16720031243.E1</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/PAYMENTTYPE[1]</con:xpath>
            <con:element>PAYMENTTYPE</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>DOMS</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/PAYMENTSTATUS[1]</con:xpath>
            <con:element>PAYMENTSTATUS</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>CANC</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/ISPC[1]</con:xpath>
            <con:element>ISPC</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>PAYCTDOMOUPSME</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[1]/FK_PROCESSINGLINEID[1]</con:xpath>
            <con:element>FK_PROCESSINGLINEID</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>false</con:enabled>
            <con:expectedValue>50</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/PAYMENTSTATUS[1]</con:xpath>
            <con:element>PAYMENTSTATUS</con:element>
            <con:type xsi:nil="true"/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>CANC</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:elements>
            <con:xpath>//Results[1]/ResultSet[1]/Row[2]/@rowNumber</con:xpath>
            <con:element>@rowNumber</con:element>
            <con:type/>
            <con:operator>=</con:operator>
            <con:enabled>true</con:enabled>
            <con:expectedValue>2</con:expectedValue>
            <con:hasValue>false</con:hasValue>
            <con:numberType>false</con:numberType>
          </con:elements>
          <con:originalMessage><![CDATA[<Results>
   <ResultSet fetchSize="10">
      <Row rowNumber="1">
         <TRANSACTIONSID>173405</TRANSACTIONSID>
         <ENDTOENDID>P002_16720031243.E1</ENDTOENDID>
         <PAYMENTTYPE>DOMS</PAYMENTTYPE>
         <PAYMENTSTATUS>CANC</PAYMENTSTATUS>
         <ISPC>PAYCTDOMOUPSME</ISPC>
         <FK_PROCESSINGLINEID>50</FK_PROCESSINGLINEID>
      </Row>
      <Row rowNumber="2">
         <TRANSACTIONSID>173406</TRANSACTIONSID>
         <ENDTOENDID>P002_16720031243.E2</ENDTOENDID>
         <PAYMENTTYPE>DOMS</PAYMENTTYPE>
         <PAYMENTSTATUS>CANC</PAYMENTSTATUS>
         <ISPC>PAYCTDOMOUPSME</ISPC>
         <FK_PROCESSINGLINEID>50</FK_PROCESSINGLINEID>
      </Row>
   </ResultSet>
</Results>]]></con:originalMessage>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="ValidateFromQueue-Status" id="1299716d-8b76-4179-8793-c5c1d641cfff">
    <con:settings/>
    <con:config>
      <script>def expectedStatusReasonCamt055 = context.expand( '${Properties#expectedStatusReasonCamt055}' )
def actualStatusReasonCamt055 = context.expand( '${Properties#actualStatusReasonCamt055}' )
def expectedStatusCamt029 = context.expand( '${Properties#expectedStatusCamt029}' )
def actualStatusCamt029 = context.expand( '${Properties#actualStatusCamt029}' )
def TxnExpectedStatusCamt029 = context.expand( '${Properties#TxnExpectedStatusCamt029}' )
def TxnactualStatusCamt029 = context.expand( '${Properties#TxnactualStatusCamt029}' )
def TxnExpectedStatusCamt029Payment2 = context.expand( '${Properties#2TxnExpectedStatusCamt029}' )
def TxnactualStatusCamt029Payment2 = context.expand( '${Properties#2TxnactualStatusCamt029}' )
def TxnExpectedStatusCamt029Payment3 = context.expand( '${Properties#3TxnExpectedStatusCamt029}' )
def TxnactualStatusCamt029Payment3 = context.expand( '${Properties#3TxnactualStatusCamt029}' )


if (!actualStatusReasonCamt055.equals(expectedStatusReasonCamt055)) 
{
	assert false, "Camt055 Status is invalid";
	log.info "Camt055 Status is invalid"
}

if (!actualStatusCamt029.equals(expectedStatusCamt029)) 
{
	assert false,"Camt 029 Status is invalid";
	log.info "Camt 029 Status is invalid"
}

if (!TxnactualStatusCamt029.equals(TxnExpectedStatusCamt029)) 
{
	assert false,"Camt 029 Txn Status is invalid";
	log.info "Camt 029 Txn Status is invalid"
}

if (!TxnactualStatusCamt029Payment2.equals(TxnExpectedStatusCamt029Payment2)) 
{
	assert false, "Camt 029 Txn Status is invalid";
	log.info "Camt 029 Txn Status is invalid"
}

if (!TxnactualStatusCamt029Payment3.equals(TxnExpectedStatusCamt029Payment3)) 
{
	assert false,"Camt 029 Txn Status is invalid";
	log.info "Camt 029 Txn Status is invalid"
}</script>
    </con:config>
  </con:testStep>
  <con:properties>
    <con:property>
      <con:name>ConnectionString</con:name>
      <con:value>jdbc:oracle:thin:pendata/pen@//10.246.89.97:1530/pen_g_functional</con:value>
    </con:property>
  </con:properties>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>7ac37089-fb5d-4637-a84a-61afd3ee482d</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>8f786e90-253d-4c20-bd82-9c850fdf8ce8</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>ee9805f6-f816-4249-b0c0-89baf0498c42</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>5bbb4481-53a0-4231-b730-41a53951a77f</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>1664405f-1d39-4d59-9d83-bf70dab7d5b5</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>86d52d9b-be84-4474-8a2e-ffb5eddef9a6</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:environmentSpec>
    <con:entry environmentId="657a20b2-d63b-4bf3-808e-2c92b686c769">
      <con:authProfile>Inherit From Parent</con:authProfile>
    </con:entry>
  </con:environmentSpec>
</con:testCase>
